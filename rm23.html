<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
	<base target="_blank">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap-theme.min.css" integrity="sha384-6pzBo3FDv/PJ8r2KRkGHifhEocL+1X2rVCTTkUfGk7/0pbek5mMa1upzvWbrUbOZ" crossorigin="anonymous">
	<style>
		p {
			margin: 0px;
		}

		.b1 {
			border: dotted 1px;
		}

		td {
			border: dotted 1px;
		}

		.margin1 {
			margin-left: 20px;
		}
details summary::-webkit-details-marker {
  display: none;
}


	</style>
</head>
<body>
   <ol>
       <li>
          <p>Просто фрагмент</p>
           <p>B31Fragm</p>
           <p></p>
           <details>
           <summary><u>B31Fragm</u></summary>
           <listing style="background-color: #DEF;">
================================
D:\programs\android\B31Fragm\app\src\main\res\layout\activity_main.xml
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MainActivity"&gt;

    &lt;TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#DED"
        android:text="B31Fragm"
        android:textSize="22sp" /&gt;

    &lt;fragment
        android:id="@+id/fragment1"
        android:name="MyFragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent"/&gt;

&lt;/LinearLayout&gt;
================================
D:\programs\android\B31Fragm\app\src\main\java\study\com\b31fragm\MainActivity.java
package study.com.b31fragm;

import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }
}
================================
D:\programs\android\B31Fragm\app\src\main\res\layout\fragment_my.xml
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#DFD"
    android:orientation="vertical"&gt;

    &lt;TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#DEF"
        android:text="I'm fragment"
        android:textSize="25sp" /&gt;

&lt;/LinearLayout&gt;
================================
D:\programs\android\B31Fragm\app\src\main\java\MyFragment.java
import android.os.Bundle;
import android.support.annotation.NonNull;
import android.support.annotation.Nullable;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

import study.com.b31fragm.R;

public class MyFragment extends Fragment {

    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_my, container, false);

        return view;
    }
}
================================
           </listing>
       </details>
           <p></p>
           <p></p>
       </li>
       <li>
           <p><a href="https://developer.android.com/guide/components/fragments?hl=RU">fragments</a></p>
           <p></p>
           <p><a href="https://developer.android.com/guide/components/fragments?hl=RU#EventCallbacks"> Создание обратного вызова</a></p>
           <p><a href="https://www.edx.org/course/introduction-to-functional-programming-2">Курс функциональное программирование</a></p>





          <p><span class="glyphicon glyphicon-align-left" aria-hidden="true"></span> Знакомство с потоком</p>

           <details>
               <summary style="color: blueviolet">_B31Fragm_</summary>
               <listing style="background-color: #DEF;">
================================
D:\programs\android\B31Fragm\javalib\src\main\java\study\com\javalib\MyClass.java
package study.com.javalib;

public class MyClass {
    public static void main(String[] args) {
        System.out.println("hello1");
        MyThread myThread = new MyThread();
        myThread.start();
        System.out.println("wow1;");
    }


    public static class MyThread extends Thread{
        @Override
        public void run() {
            super.run();
            try {
                sleep(2000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println("MyThread run;");
        }
    }
}
================================
"C:\Program Files\Android\Android Studio\jre\bin\java.exe" "-javaagent:C:\Program Files\Android\Android Studio\lib\idea_rt.jar=22433:C:\Program Files\Android\Android Studio\bin" -Dfile.encoding=UTF-8 -classpath "C:\Program Files\Android\Android Studio\jre\jre\lib\charsets.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\access-bridge-64.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\cldrdata.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\dnsns.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\jaccess.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\localedata.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\nashorn.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\sunec.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\sunjce_provider.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\sunmscapi.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\sunpkcs11.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\ext\zipfs.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\jce.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\jsse.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\management-agent.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\resources.jar;C:\Program Files\Android\Android Studio\jre\jre\lib\rt.jar;D:\programs\android\B31Fragm\javalib\build\classes\java\main" study.com.javalib.MyClass
hello1
wow1;
MyThread run;

Process finished with exit code 0
============================
myThread.interrupt();

hello1
wow1;
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at study.com.javalib.MyClass$MyThread.run(MyClass.java:18)
MyThread run;
               </listing>
           </details>
           <p></p>
           <p></p>
           <p></p>
       </li>
       <li>
           <p><span class="glyphicon glyphicon-star" aria-hidden="true"></span>Передача данных из потока</p>
           <p></p>



           <details>
               <summary>_MainActivity_</summary>
               <listing style="background-color: #DEF;">
================================
package study.com.b31fragm;

import android.os.Handler;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class MainActivity extends AppCompatActivity {

    private Button button2;
    private Handler handler;


    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        button2 = findViewById(R.id.button2);

        handler = new Handler();
    }

    public void doSomthingLong(){
        try {
            System.out.println("Thread start");
            Thread.sleep(10000);
            handler.post(new Runnable() {
                @Override
                public void run() {
                    <span style="background-color: #FFF">button2.setText("done");</span>
                }
            });
            System.out.println("Thread stop");
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

    }

    public void onClickOk(View view) {
        ThreadWorker threadWorker = new ThreadWorker();
        threadWorker.start();
    }

    public class ThreadWorker extends Thread{
        @Override
        public void run() {
            super.run();
            doSomthingLong();
        }
    }
}
================================
               </listing>
           </details>
           <p><a href="https://blog.nikitaog.me/2014/10/11/android-looper-handler-handlerthread-i/">Android: Looper, Handler, HandlerThread. Part I.</a></p>
           <p>Handler</p>
           <p>Описание:</p>
           <p>Есть переопределенный от Tread класс TreadWorker. Переопределение заключается в изменении метода run, где вызываеся doSomthing. ThreadWorker запускается start. </p>
           <p>Передача данных из ThreadWorker.</p>
           <p>Создаем экземпляр от Handler.</p>
           <p>DoSomthing вызывает метод Handler.post кому передает объект Rannable с переопределенным run. В run содержится команда изменения MainActivity. </p>
           <p>Смысл: Handler c помощью post вставляет  в очередь MessageQueue команду для изменения MainActtivity - button2.setText("done");</p>
           <p>Thread Handler post Runable</p>
       </li>
       <li>
           <p>AsincTask</p>
            <p>D/happy: onPreExecute main 1</p>
            <p>D/happy: doInBackground AsyncTask #1 2801</p>
            <p>D/happy: onPostExecute main 1</p>           <p></p>
           <details>
               <summary style="color: blueviolet">_MainActivity_</summary>
               <listing style="background-color: #DEF;">
================================
D:\programs\android\B31Fragm\app\src\main\java\study\com\b31fragm\MainActivity.java
package study.com.b31fragm;

import android.os.AsyncTask;
import android.os.Handler;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;

public class MainActivity extends AppCompatActivity {

    private Button button2;
    private Handler handler;
    private MyTask myTask;


    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        button2 = findViewById(R.id.button2);

        handler = new Handler();
    }

    public void doSomthingLong(){
        try {
            System.out.println("Thread start");
            Thread.sleep(10000);
            handler.post(new Runnable() {
                @Override
                public void run() {
                    button2.setText("done");
                }
            });
            System.out.println("Thread stop");
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

    }

    public void onClickOk(View view) {
        myTask = new MyTask();
        myTask.execute(3, 4);
    }

    public class MyTask extends AsyncTask<Integer, Void, String> {

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            Log.d("happy", "onPreExecute" + " "
                + Thread.currentThread().getName() + " "
                    + Thread.currentThread().getId());
        }

        @Override
        protected String doInBackground(Integer... params) {
            Log.d("happy", "doInBackground" + " "
                    + Thread.currentThread().getName() + " "
                    + Thread.currentThread().getId());
            Integer a = params[0];
            Integer b = params[1];

            try {
                Thread.sleep(5000);
                Log.d("happy", "onPostExecute" + " "
                        + Thread.currentThread().getName() + " "
                        + Thread.currentThread().getId());
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            Integer c = a + b;
            return "sum = " + c;
        }

        @Override
        protected void onPostExecute(String sum) {
            super.onPostExecute(sum);
            Log.d("happy", "onPostExecute" + " "
                    + Thread.currentThread().getName() + " "
                    + Thread.currentThread().getId());
            button2.setText(sum);
        }
    }
}
================================
               </listing>
           </details>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
       </li>
       <li>
           <p>Fragment/setRetainInstance(true);</p>
           <p>При повороте экрана после этой команды содержимое фрагмента сохраняется. У mainActivity такой команды нет</p>
           <p></p>
           <details>
               <summary style="color: blueviolet">_MyFragment_</summary>
               <listing style="background-color: #DEF;">
================================
D:\programs\android\B31Fragm\app\src\main\java\MyFragment.java
import android.os.AsyncTask;
import android.os.Bundle;
import android.support.annotation.NonNull;
import android.support.annotation.Nullable;
import android.support.v4.app.Fragment;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.TextView;

import study.com.b31fragm.MainActivity;
import study.com.b31fragm.R;

public class MyFragment extends Fragment {

    private Button button3;
    private TextView textViewFragment;
    private MyTask task;


    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setRetainInstance(true);
    }

    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_my, container, false);

        button3 = view.findViewById(R.id.button3);
        textViewFragment = view.findViewById(R.id.textViewFragment);

        button3.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                task = new MyTask();
                task.execute(3, 5);
            }
        });
        return view;
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        button3 = null;
        textViewFragment = null;
    }

    public class MyTask extends AsyncTask<Integer, Void, String> {

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            Log.d("happy", "onPreExecute" + " "
                    + Thread.currentThread().getName() + " "
                    + Thread.currentThread().getId());
        }

        @Override
        protected String doInBackground(Integer... params) {
            Log.d("happy", "doInBackground" + " "
                    + Thread.currentThread().getName() + " "
                    + Thread.currentThread().getId());
            Integer a = params[0];
            Integer b = params[1];

            try {
                Thread.sleep(15000);
                Log.d("happy", "onPostExecute" + " "
                        + Thread.currentThread().getName() + " "
                        + Thread.currentThread().getId());
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            Integer c = a + b;
            return "sum = " + c;
        }

        @Override
        protected void onPostExecute(String sum) {
            super.onPostExecute(sum);
            Log.d("happy", "onPostExecute" + " "
                    + Thread.currentThread().getName() + " "
                    + Thread.currentThread().getId());
            if(textViewFragment != null) {
                textViewFragment.setText(sum);
            }
        }
    }
}
================================
               </listing>
           </details>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
       </li>
       <li>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
       </li>
       <li>
           <p></p>
           <details>
               <summary style="color: blueviolet">__</summary>
               <listing style="background-color: #DEF;">
================================


================================


               </listing>
           </details>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
       </li>
       <li>
           <p></p>
           <p></p>
           <p></p>
           <p>androiddevicemonitor</p>
           <p><a href="https://github.com/piotrpolak/android-http-server#running-standalone-server-cli">server</a></p>
           <p><a href="https://github.com/VoiSmart/pjsip-android">pjsip</a></p>
           <p><a href="https://github.com/BelledonneCommunications/linphone-android">linphone</a></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
           <p></p>
       </li>
   </ol>

</body>
</html>
