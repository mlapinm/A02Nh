## Part VI OSPF
Часть VI OSPF   
__|__
--|--
|
Part VI Review|Часть VI Обзор
## Chapter 19 Understanding OSPF Concepts
Глава 19 Понимание концепций OSPF   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 3.0 IP Connectivity
3.0 IP-подключение   
###### 3.2 Determine how a router makes a forwarding decision by default
3.2 Определите, как маршрутизатор принимает решение о пересылке по умолчанию   
###### 3.2.b Administrative distance
3.2.b Административная дистанция   
###### 3.2.c Routing protocol metric
3.2.c Метрика протокола маршрутизации   
###### 3.4 Configure and verify single area OSPFv2
3.4 Настройка и проверка OSPFv2 для одной области   
###### 3.4.a Neighbor adjacencies
3.4.a Соседние окрестности   
###### 3.4.b Point-to-point
3.4.b Точка-точка   
###### 3.4.c Broadcast (DR/BR selection)
3.4.c Трансляция (выбор DR / BR)   
###### 3.4.d Router ID
3.4.d Идентификатор маршрутизатора   
__|__
--|--
|
This chapter takes a long look at Open Shortest Path First Version 2 (OSPFv2) concepts.|В этой главе подробно рассматриваются концепции Open Shortest Path First Version 2 (OSPFv2).
|
OSPF runs on each router, sending and receiving OSPF messages with neighboring (nearby)|OSPF работает на каждом маршрутизаторе, отправляя и получая сообщения OSPF с соседними (находящимися поблизости)
|
routers.|роутеры.
These messages give OSPF the means to exchange data about the network and to learn and add IP Version 4 (IPv4) routes to the IPv4 routing table on each router.|Эти сообщения предоставляют OSPF средства для обмена данными о сети, а также для изучения и добавления маршрутов IP версии 4 (IPv4) в таблицу маршрутизации IPv4 на каждом маршрутизаторе.
|
Most enterprises over the last 25 years have used either OSPF or the Enhanced Interior Gateway Routing Protocol (EIGRP) for their primary IPv4 routing protocol.|Большинство предприятий за последние 25 лет использовали OSPF или расширенный протокол маршрутизации внутреннего шлюза (EIGRP) в качестве основного протокола маршрутизации IPv4.
For perspective, both OSPF and EIGRP have been part of CCNA throughout most of its 20+ year history.|Для сравнения, OSPF и EIGRP были частью CCNA на протяжении большей части своей более чем 20-летней истории.
|
For the CCNA 200-301 exam blueprint, Cisco has included OSPFv2 as the only IPv4 routing protocol. (Note that Cisco does include EIGRP in the CCNP Enterprise certification.)|В план экзамена CCNA 200-301 Cisco включила OSPFv2 в качестве единственного протокола маршрутизации IPv4. (Обратите внимание, что Cisco действительно включает EIGRP в сертификацию CCNP Enterprise.)
|
This chapter breaks the content into three major sections.|В этой главе содержание разбито на три основных раздела.
The first section sets the context about routing protocols in general, defining interior and exterior routing protocols and basic routing protocol features and terms.|Первый раздел устанавливает общий контекст протоколов маршрутизации, определяя протоколы внутренней и внешней маршрутизации, а также основные функции и термины протокола маршрутизации.
The second major section presents the nuts and bolts of how OSPFv2 works, using OSPF neighbor relationships, database exchange, and then route calculation.|Во втором основном разделе представлены основные принципы работы OSPFv2 с использованием отношений соседства OSPF, обмена базами данных и последующего расчета маршрута.
The third section wraps up the discussion by looking at OSPF areas and LSAs.|В третьем разделе обсуждение завершается рассмотрением областей OSPF и LSA.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
CHAPTER 19 Table 19-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|ГЛАВА 19 Таблица 19-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### Comparing Dynamic Routing Protocol Features
Сравнение функций протокола динамической маршрутизации   
__|__
--|--
|
OSPF Concepts and Operation 4, 5 OSPF Areas and LSAs 6 1.|Концепции и работа OSPF 4, 5 Области OSPF и LSA 61.
Which of the following routing protocols is considered to use link-state logic?|Считается, что какой из следующих протоколов маршрутизации использует логику состояния канала?
|
a. RIPv1 b.|а. RIPv1 б.
RIPv2 c.|RIPv2 c.
EIGRP d.|EIGRP d.
OSPF 2.|OSPF 2.
Which of the following routing protocols use a metric that is, by default, at least partially affected by link bandwidth? (Choose two answers.)|Какой из следующих протоколов маршрутизации использует метрику, на которую по умолчанию хотя бы частично влияет пропускная способность канала? (Выберите два ответа.)
|
a. RIPv1 b.|а. RIPv1 б.
RIPv2 c.|RIPv2 c.
EIGRP d.|EIGRP d.
OSPF 3.|OSPF 3.
Which of the following interior routing protocols support VLSM? (Choose three answers.)|Какие из следующих протоколов внутренней маршрутизации поддерживают VLSM? (Выберите три ответа.)
|
a. RIPv1 b.|а. RIPv1 б.
RIPv2 c.|RIPv2 c.
EIGRP d.|EIGRP d.
OSPF 4.|OSPF 4.
Two routers using OSPFv2 have become neighbors and exchanged all LSAs. As a result, Router R1 now lists some OSPF-learned routes in its routing table.|Два маршрутизатора, использующие OSPFv2, стали соседями и обменялись всеми LSA. В результате маршрутизатор R1 теперь перечисляет некоторые маршруты, изученные OSPF, в своей таблице маршрутизации.
Which of the following best describes how R1 uses those recently learned LSAs to choose which IP routes to add to its IP routing table?|Что из следующего лучше всего описывает, как R1 использует эти недавно изученные LSA, чтобы выбрать, какие IP-маршруты добавить в свою таблицу IP-маршрутизации?
|
a. Each LSA lists a route to be copied to the routing table.|а. В каждом LSA указан маршрут, который нужно скопировать в таблицу маршрутизации.
|
b. Some LSAs list a route that can be copied to the routing table.|б. Некоторые LSA указывают маршрут, который можно скопировать в таблицу маршрутизации.
|
c. Run some SPF math against the LSAs to calculate the routes.|c. Выполните некоторую математику SPF для LSA, чтобы вычислить маршруты.
|
d. R1 does not use the LSAs at all when choosing what routes to add.|d. R1 вообще не использует LSA при выборе маршрутов для добавления.
|
5. Which of the following OSPF neighbor states is expected when the exchange of topology information is complete between two OSPF neighbors?|5. Какое из следующих состояний соседей OSPF ожидается после завершения обмена информацией о топологии между двумя соседями OSPF?
|
a. 2-way b.|а. 2-ходовой b.
Full c.|Полный c.
Up/up d.|Вверх / вверх d.
Final 6.|Финал 6.
A company has a small/medium-sized network with 15 routers and 40 subnets and uses OSPFv2.|Компания имеет небольшую / среднюю сеть с 15 маршрутизаторами и 40 подсетями и использует OSPFv2.
Which of the following is considered an advantage of using a single-area design as opposed to a multiarea design?|Что из следующего считается преимуществом использования дизайна с одной зоной по сравнению с дизайном с несколькими площадями?
|
a. It reduces the processing overhead on most routers.|а. Это снижает накладные расходы на обработку на большинстве маршрутизаторов.
|
b. Status changes to one link may not require SPF to run on all other routers.|б. Для изменения статуса одного канала может не потребоваться выполнение SPF на всех других маршрутизаторах.
|
c. It allows for simpler planning and operations.|c. Это позволяет упростить планирование и операции.
|
d. It allows for route summarization, reducing the size of IP routing tables.|d. Это позволяет суммировать маршруты, уменьшая размер таблиц IP-маршрутизации.
|
Foundation Topics Comparing Dynamic Routing Protocol Features Routers add IP routes to their routing tables using three methods: connected routes, static routes, and routes learned by using dynamic routing protocols.|Основные темы Сравнение функций протокола динамической маршрутизации Маршрутизаторы добавляют IP-маршруты в свои таблицы маршрутизации, используя три метода: подключенные маршруты, статические маршруты и маршруты, полученные с помощью протоколов динамической маршрутизации.
Before we get too far into the discussion, however, it is important to define a few related terms and clear up any misconceptions about the terms routing protocol, routed protocol, and routable protocol.|Однако прежде чем мы зайдем слишком далеко в обсуждение, важно определить несколько связанных терминов и прояснить любые заблуждения относительно терминов протокол маршрутизации, протокол маршрутизации и протокол маршрутизации.
The concepts behind these terms are not that difficult, but because the terms are so similar, and because many documents pay poor attention to when each of these terms is used, they can be a bit confusing.|Концепции, лежащие в основе этих терминов, не так уж и сложны, но из-за того, что термины очень похожи, и поскольку во многих документах мало внимания уделяется использованию каждого из этих терминов, они могут немного сбивать с толку.
These terms are generally defined as follows:|Эти термины обычно определяются следующим образом:
###### Routing protocol: A set of messages, rules, and algorithms used by routers for the overall
Протокол маршрутизации: набор сообщений, правил и алгоритмов, используемых маршрутизаторами для общего   
__|__
--|--
|
purpose of learning routes.|назначение обучающих маршрутов.
This process includes the exchange and analysis of routing information.|Этот процесс включает в себя обмен и анализ маршрутной информации.
Each router chooses the best route to each subnet (path selection) and finally places those best routes in its IP routing table.|Каждый маршрутизатор выбирает лучший маршрут к каждой подсети (выбор пути) и, наконец, помещает эти лучшие маршруты в свою таблицу IP-маршрутизации.
Examples include RIP, EIGRP, OSPF, and BGP.|Примеры включают RIP, EIGRP, OSPF и BGP.
###### Routed protocol and routable protocol: Both terms refer to a protocol that defines a
Маршрутизируемый протокол и маршрутизируемый протокол: оба термина относятся к протоколу, который определяет   
__|__
--|--
|
packet structure and logical addressing, allowing routers to forward or route the packets.|структура пакетов и логическая адресация, позволяющие маршрутизаторам пересылать или маршрутизировать пакеты.
|
Routers forward packets defined by routed and routable protocols.|Маршрутизаторы пересылают пакеты, определенные маршрутизируемыми и маршрутизируемыми протоколами.
Examples include IP Version 4 (IPv4) and IP Version 6 (IPv6).|Примеры включают IP версии 4 (IPv4) и IP версии 6 (IPv6).
|
NOTE The term path selection sometimes refers to part of the job of a routing protocol, in which the routing protocol chooses the best route.|ПРИМЕЧАНИЕ. Термин «выбор пути» иногда относится к части работы протокола маршрутизации, в которой протокол маршрутизации выбирает лучший маршрут.
|
Even though routing protocols (such as OSPF) are different from routed protocols (such as IP), they do work together very closely.|Несмотря на то, что протоколы маршрутизации (например, OSPF) отличаются от протоколов маршрутизации (например, IP), они очень тесно работают вместе.
The routing process forwards IP packets, but if a router does not have any routes in its IP routing table that match a packet’s destination address, the router discards the packet.|Процесс маршрутизации пересылает IP-пакеты, но если маршрутизатор не имеет маршрутов в своей таблице IP-маршрутизации, которые соответствуют адресу назначения пакета, маршрутизатор отбрасывает пакет.
Routers need routing protocols so that the routers can learn all the possible routes and add them to the routing table so that the routing process can forward (route) routable protocols such as IP.|Маршрутизаторам нужны протоколы маршрутизации, чтобы маршрутизаторы могли изучать все возможные маршруты и добавлять их в таблицу маршрутизации, чтобы процесс маршрутизации мог пересылать (маршрутизировать) маршрутизируемые протоколы, такие как IP.
#### Routing Protocol Functions
Функции протокола маршрутизации   
__|__
--|--
|
Cisco IOS software supports several IP routing protocols, performing the same general functions:|Программное обеспечение Cisco IOS поддерживает несколько протоколов IP-маршрутизации, выполняя одни и те же общие функции:
|
1. Learn routing information about IP subnets from neighboring routers.|1. Изучите информацию о маршрутизации IP-подсетей от соседних маршрутизаторов.
|
2. Advertise routing information about IP subnets to neighboring routers.|2. Объявите информацию о маршрутизации IP-подсетей соседним маршрутизаторам.
|
3. If more than one possible route exists to reach one subnet, pick the best route based on a metric.|3. Если существует более одного возможного маршрута для достижения одной подсети, выберите лучший маршрут на основе метрики.
|
4. If the network topology changes—for example, a link fails—react by advertising that some routes have failed and pick a new currently best route. (This process is called convergence.)|4. Если топология сети изменяется - например, происходит сбой канала - отреагируйте, объявив, что некоторые маршруты не работают, и выберите новый лучший на данный момент маршрут. (Этот процесс называется сходимостью.)
|
NOTE A neighboring router connects to the same link as another router, such as the same WAN link or the same Ethernet LAN.|ПРИМЕЧАНИЕ Соседний маршрутизатор подключается к тому же каналу, что и другой маршрутизатор, например к тому же каналу WAN или к той же локальной сети Ethernet.
|
Figure 19-1 shows an example of three of the four functions in the list.|На рисунке 19-1 показан пример трех из четырех функций в списке.
Router R1, in the lower left of the figure, must make a decision about the best route to reach the subnet connected off router R2, on the bottom right of the figure.|Маршрутизатор R1 в нижнем левом углу рисунка должен принять решение о наилучшем маршруте для достижения подсети, подключенной к маршрутизатору R2, расположенному в правом нижнем углу рисунка.
Following the steps in the figure:|Следуя инструкциям на рисунке:
|
Step 1.|Шаг 1.
R2 advertises a route to the lower right subnet—172.16.3.0/24—to both router R1 and R3.|R2 объявляет маршрут к нижней правой подсети - 172.16.3.0 / 24 - как маршрутизаторам R1, так и R3.
|
Step 2.|Шаг 2.
After R3 learns about the route to 172.16.3.0/24 from R2, R3 advertises that route to R1.|После того, как R3 узнает о маршруте к 172.16.3.0/24 от R2, R3 объявляет этот маршрут R1.
|
Step 3.|Шаг 3.
R1 must make a decision about the two routes it learned about for reaching subnet 172.16.3.0/24—one with metric 1 from R2 and one with metric 2 from R3. R1 chooses the lower metric route through R2 (function 3).|R1 должен принять решение о двух известных ему маршрутах для достижения подсети 172.16.3.0/24 - один с метрикой 1 от R2, а другой с метрикой 2 от R3. R1 выбирает маршрут с более низкой метрикой через R2 (функция 3).
|
The other routing protocol function, convergence, occurs when the topology changes—that is, when either a router or link fails or comes back up again.|Другая функция протокола маршрутизации, конвергенция, происходит при изменении топологии, то есть когда либо маршрутизатор, либо канал выходит из строя или снова восстанавливается.
When something changes, the best routes available in the network can change.|Когда что-то меняется, лучшие маршруты, доступные в сети, могут измениться.
Convergence simply refers to the process by which all the routers collectively realize something has changed, advertise the information about the changes to all the other routers, and all the routers then choose the currently best routes for each subnet.|Конвергенция просто относится к процессу, при котором все маршрутизаторы коллективно осознают, что что-то изменилось, объявляют информацию об изменениях всем другим маршрутизаторам, а затем все маршрутизаторы выбирают наилучшие в настоящее время маршруты для каждой подсети.
The ability to converge quickly, without causing loops, is one of the most important considerations when choosing which IP routing protocol to use.|Возможность быстрой конвергенции без образования петель - одно из наиболее важных соображений при выборе протокола IP-маршрутизации.
|
In Figure 19-1, convergence might occur if the link between R1 and R2 failed.|На рис. 19-1 сходимость может произойти, если канал между R1 и R2 вышел из строя.
In that case, R1 should stop using its old route for subnet 172.16.3.0/24 (directly through R2) and begin sending packets to R3.|В этом случае R1 должен прекратить использовать свой старый маршрут для подсети 172.16.3.0/24 (напрямую через R2) и начать отправку пакетов R3.
|
G0/0/0 G0/1 G0/1/0 G0/0/0 G0/1/0 G0/0 G0/0/0 172.16.6.252 G0/1/0 172.16.2.252 G0/0 I have a route to 172.16.3.0/24, metric 2.|G0 / 0/0 G0 / 1 G0 / 1/0 G0 / 0/0 G0 / 1/0 G0 / 0 G0 / 0/0 172.16.6.252 G0 / 1/0 172.16.2.252 G0 / 0 У меня есть путь к 172.16.3.0/24, метрика 2.
|
I have a route to 172.16.3.0/24, metric 1.|У меня есть маршрут до 172.16.3.0/24, метрика 1.
|
I have a route to 172.16.3.0/24, metric 1.|У меня есть маршрут до 172.16.3.0/24, метрика 1.
|
R1 IP Routing Table Subnet Out Int.|Выход подсети таблицы IP-маршрутизации R1 Int.
Next-Hop Metric 172.16.3.0 G0/0/0 172.16.2.252 1 I’ll use the route out G0/0/0, because it has the lower metric.|Метрика следующего перехода 172.16.3.0 G0 / 0/0 172.16.2.252 1 Я буду использовать исходящий маршрут G0 / 0/0, потому что он имеет более низкую метрику.
|
Figure 19-1 Three of the Four Basic Functions of Routing Protocols|Рисунок 19-1 Три из четырех основных функций протоколов маршрутизации
#### Interior and Exterior Routing Protocols
Протоколы внутренней и внешней маршрутизации   
__|__
--|--
|
IP routing protocols fall into one of two major categories: interior gateway protocols (IGP)|Протоколы IP-маршрутизации делятся на две основные категории: протоколы внутреннего шлюза (IGP).
|
or exterior gateway protocols (EGP). The definitions of each are as follows:|или протоколы внешнего шлюза (EGP). Определения каждого из них следующие:
###### IGP: A routing protocol that was designed and intended for use inside a single autonomous
IGP: протокол маршрутизации, который был разработан и предназначен для использования внутри одного автономного   
__|__
--|--
|
system (AS)|система (AS)
###### EGP: A routing protocol that was designed and intended for use between different autonomous
EGP: протокол маршрутизации, который был разработан и предназначен для использования между различными автономными   
__|__
--|--
|
systems NOTE The terms IGP and EGP include the word gateway because routers used to be called gateways.|системы ПРИМЕЧАНИЕ Термины IGP и EGP включают слово шлюз, потому что маршрутизаторы раньше назывались шлюзами.
|
These definitions use another new term: autonomous system (AS). An AS is a network under the administrative control of a single organization.|В этих определениях используется еще один новый термин: автономная система (AS). AS - это сеть под административным контролем одной организации.
For example, a network created and paid for by a single company is probably a single AS, and a network created by a single school system is probably a single AS. Other examples include large divisions of a state or national government, where different government agencies might be able to build their own networks.|Например, сеть, созданная и оплачиваемая одной компанией, вероятно, представляет собой одну AS, а сеть, созданная одной школьной системой, вероятно, является одной AS. Другие примеры включают крупные подразделения правительства штата или страны, где различные правительственные учреждения могут создавать свои собственные сети.
Each ISP is also typically a single different AS.|Каждый интернет-провайдер также обычно представляет собой отдельную автономную систему.
|
Some routing protocols work best inside a single AS by design, so these routing protocols are called IGPs. Conversely, routing protocols designed to exchange routes between routers Answers to the “Do I Know This Already?” quiz:|Некоторые протоколы маршрутизации изначально лучше всего работают внутри одной AS, поэтому эти протоколы маршрутизации называются IGP. И наоборот, протоколы маршрутизации, предназначенные для обмена маршрутами между маршрутизаторами, отвечают на вопрос «Знаю ли я это уже?» викторина:
|
1 D 2 C, D 3 B, C, D 4 C 5 B 6 C in different autonomous systems are called EGPs. Today, Border Gateway Protocol (BGP) is the only EGP used.|1 D 2 C, D 3 B, C, D 4 C 5 B 6 C в различных автономных системах называются EGP. Сегодня протокол пограничного шлюза (BGP) - единственный используемый EGP.
|
Each AS can be assigned a number called (unsurprisingly) an AS number (ASN). Like public IP addresses, the Internet Assigned Numbers Authority (IANA, www.iana.org) controls the worldwide rights to assigning ASNs. It delegates that authority to other organizations around the world, typically to the same organizations that assign public IP addresses.|Каждой AS может быть присвоен номер, называемый (что неудивительно) номером AS (ASN). Как и общедоступные IP-адреса, Internet Assigned Numbers Authority (IANA, www.iana.org) контролирует всемирные права на назначение ASN. Он делегирует эти полномочия другим организациям по всему миру, обычно тем же организациям, которые назначают общедоступные IP-адреса.
|
For example, in North America, the American Registry for Internet Numbers (ARIN, www.arin.net) assigns public IP address ranges and ASNs.|Например, в Северной Америке Американский реестр интернет-номеров (ARIN, www.arin.net) назначает диапазоны общедоступных IP-адресов и ASN.
|
Figure 19-2 shows a small view of the worldwide Internet.|На рис. 19-2 показан небольшой вид всемирного Интернета.
The figure shows two enterprises and three ISPs using IGPs (OSPF and EIGRP) inside their own networks and with BGP being used between the ASNs.|На рисунке показаны два предприятия и три интернет-провайдера, использующие IGP (OSPF и EIGRP) внутри своих сетей и с использованием BGP между ASN.
|
Figure 19-2 Comparing Locations for Using IGPs and EGPs|Рисунок 19-2 Сравнение местоположений для использования IGP и EGP
#### Comparing IGPs
Сравнение IGP   
__|__
--|--
|
Organizations have several options when choosing an IGP for their enterprise network, but most companies today use either OSPF or EIGRP. This book discusses OSPFv2, with the CCNP Enterprise certification adding EIGRP. Before getting into detail on these two protocols, the next section first discusses some of the main goals of every IGP, comparing OSPF, EIGRP, plus a few other IPv4 routing protocols.|У организаций есть несколько вариантов выбора IGP для своей корпоративной сети, но большинство компаний сегодня используют OSPF или EIGRP. В этой книге обсуждается OSPFv2 с сертификацией CCNP Enterprise с добавлением EIGRP. Прежде чем подробно рассматривать эти два протокола, в следующем разделе сначала обсуждаются некоторые из основных целей каждого IGP, сравниваются OSPF, EIGRP и несколько других протоколов маршрутизации IPv4.
##### IGP Routing Protocol Algorithms
Алгоритмы протокола маршрутизации IGP   
__|__
--|--
|
A routing protocol’s underlying algorithm determines how the routing protocol does its job.|Базовый алгоритм протокола маршрутизации определяет, как протокол маршрутизации выполняет свою работу.
The term routing protocol algorithm simply refers to the logic and processes used by different routing protocols to solve the problem of learning all routes, choosing the best route to each subnet, and converging in reaction to changes in the internetwork.|Термин «алгоритм протокола маршрутизации» просто относится к логике и процессам, используемым различными протоколами маршрутизации для решения проблемы изучения всех маршрутов, выбора наилучшего маршрута к каждой подсети и конвергенции в ответ на изменения в объединенной сети.
Three main branches of routing protocol algorithms exist for IGP routing protocols:|Для протоколов маршрутизации IGP существуют три основных ветви алгоритмов протокола маршрутизации:
###### Distance vector (sometimes called Bellman-Ford after its creators)
Вектор расстояний (иногда называемый Bellman-Ford в честь его создателей)   
###### Advanced distance vector (sometimes called “balanced hybrid”)
Расширенный вектор расстояния (иногда называемый «сбалансированный гибрид»)   
###### Link-state
Состояние связи   
__|__
--|--
|
Historically speaking, distance vector protocols were invented first, mainly in the early 1980s.|Исторически протоколы векторов расстояния были изобретены первыми, в основном в начале 1980-х годов.
Routing Information Protocol (RIP) was the first popularly used IP distance vector protocol, with the Cisco-proprietary Interior Gateway Routing Protocol (IGRP) being introduced a little later.|Протокол маршрутизации информации (RIP) был первым широко используемым протоколом вектора расстояния IP, а чуть позже был представлен собственный протокол маршрутизации внутреннего шлюза (IGRP) Cisco.
|
By the early 1990s, distance vector protocols’ somewhat slow convergence and potential for routing loops drove the development of new alternative routing protocols that used new algorithms.|К началу 1990-х несколько медленная конвергенция протоколов вектора расстояния и возможность создания петель маршрутизации привели к разработке новых альтернативных протоколов маршрутизации, в которых использовались новые алгоритмы.
Link-state protocols—in particular, Open Shortest Path First (OSPF) and Integrated Intermediate System to Intermediate System (IS-IS)—solved the main issues.|Протоколы состояния канала - в частности, Open Shortest Path First (OSPF) и Integrated Intermediate System to Intermediate System (IS-IS) - решили основные проблемы.
They also came with a price: they required extra CPU and memory on routers, with more planning required from the network engineers.|У них также была своя цена: для них требовался дополнительный ЦП и память на маршрутизаторах, а сетевым инженерам требовалось более тщательное планирование.
|
NOTE All references to OSPF in this chapter refer to OSPFv2 unless otherwise stated.|ПРИМЕЧАНИЕ. Все ссылки на OSPF в этой главе относятся к OSPFv2, если не указано иное.
|
Around the same time as the introduction of OSPF, Cisco created a proprietary routing protocol called Enhanced Interior Gateway Routing Protocol (EIGRP), which used some features of the earlier IGRP protocol.|Примерно в то же время, что и OSPF, Cisco создала собственный протокол маршрутизации под названием Enhanced Internal Gateway Routing Protocol (EIGRP), в котором использовались некоторые функции более раннего протокола IGRP.
EIGRP solved the same problems as did link-state routing protocols, but EIGRP required less planning when implementing the network.|EIGRP решал те же проблемы, что и протоколы маршрутизации на основе состояния канала, но EIGRP требовал меньшего планирования при реализации сети.
As time went on, EIGRP was classified as a unique type of routing protocol.|Со временем EIGRP был классифицирован как уникальный тип протокола маршрутизации.
However, it used more distance vector features than link-state, so it is more commonly classified as an advanced distance vector protocol.|Однако он использовал больше функций вектора расстояния, чем состояние канала, поэтому его чаще классифицируют как расширенный протокол вектора расстояния.
##### Metrics
Метрики   
__|__
--|--
|
Routing protocols choose the best route to reach a subnet by choosing the route with the lowest metric.|Протоколы маршрутизации выбирают лучший маршрут для достижения подсети, выбирая маршрут с наименьшей метрикой.
For example, RIP uses a counter of the number of routers (hops) between a router and the destination subnet, as shown in the example of Figure 19-1.|Например, RIP использует счетчик количества маршрутизаторов (переходов) между маршрутизатором и подсетью назначения, как показано в примере на рис. 19-1.
OSPF totals the cost associated with each interface in the end-to-end route, with the cost based on link bandwidth.|OSPF суммирует стоимость, связанную с каждым интерфейсом в сквозном маршруте, со стоимостью, основанной на пропускной способности канала.
Table 19-2 lists the most common IP routing protocols and some details about the metric in each case.|В Табл. 19-2 перечислены наиболее распространенные протоколы IP-маршрутизации и некоторые подробности о метрике для каждого случая.
|
Table 19-2 IP IGP Metrics Table end.|Таблица 19-2 Конец таблицы показателей IP IGP.
|
A brief comparison of the metric used by the older RIP versus the metric used by OSPF shows some insight into why OSPF and EIGRP surpassed RIP. Figure 19-3 shows an example in which Router B has two possible routes to subnet 10.1.1.0 on the left side of the network:|Краткое сравнение метрики, используемой более старым RIP, с метрикой, используемой OSPF, показывает некоторое понимание того, почему OSPF и EIGRP превзошли RIP. На рисунке 19-3 показан пример, в котором маршрутизатор B имеет два возможных маршрута к подсети 10.1.1.0 в левой части сети:
|
a shorter route over a very slow serial link at 1544 Kbps, or a longer route over two Gigabit Ethernet WAN links.|более короткий маршрут по очень медленному последовательному каналу со скоростью 1544 Кбит / с или более длинный маршрут по двум каналам глобальной сети Gigabit Ethernet.
|
Figure 19-3 RIP and OSPF Metrics Compared The left side of the figure shows the results of RIP in this network.|Рисунок 19-3 Сравнение показателей RIP и OSPF В левой части рисунка показаны результаты RIP в этой сети.
Using hop count, Router B learns of a one-hop route directly to Router A through B’s S0/0/1 interface.|Используя счетчик переходов, маршрутизатор B изучает маршрут с одним переходом непосредственно к маршрутизатору A через интерфейс S0 / 0/1 B.
B also learns of a two-hop route through Router C, through B’s G0/0 interface.|B также узнает о двухсегментном маршруте через маршрутизатор C через интерфейс G0 / 0 B.
Router B chooses the lower hop count route, which happens to go over the slow-speed serial link.|Маршрутизатор B выбирает маршрут с меньшим количеством переходов, который проходит по низкоскоростному последовательному каналу.
|
The right side of the figure shows the better choice made by OSPF based on its better metric.|В правой части рисунка показан лучший выбор, сделанный OSPF на основе его лучшей метрики.
|
To cause OSPF to make the right choice, the engineer could use default settings based on the correct interface bandwidth to match the actual link speeds, thereby allowing OSPF to choose the faster route. (The bandwidth interface subcommand does not change the actual physical speed of the interface.|Чтобы OSPF сделал правильный выбор, инженер может использовать настройки по умолчанию, основанные на правильной полосе пропускания интерфейса, чтобы соответствовать фактическим скоростям канала, тем самым позволяя OSPF выбирать более быстрый маршрут. (Подкоманда bandwidth interface не изменяет фактическую физическую скорость интерфейса.
It just tells IOS what speed to assume the interface is using.)|Он просто сообщает IOS, какую скорость предположительно использует интерфейс.)
##### Other IGP Comparisons
Другие сравнения IGP   
__|__
--|--
|
Routing protocols can be compared based on many features, some of which matter to the current CCNA exam, whereas some do not.|Протоколы маршрутизации можно сравнивать по многим функциям, некоторые из которых имеют значение для текущего экзамена CCNA, а некоторые нет.
Table 19-3 introduces a few more points and lists the comparison points mentioned in this book for easier study, with a few supporting comments following the table.|Таблица 19-3 вводит еще несколько моментов и перечисляет точки сравнения, упомянутые в этой книге, для облегчения изучения, с несколькими вспомогательными комментариями после таблицы.
|
Table 19-3 Interior IP Routing Protocols Compared Table end.|Таблица 19-3 Сравнение протоколов внутренней IP-маршрутизации Конец таблицы.
|
1 Although Cisco created EIGRP and has kept it as a proprietary protocol for many years, Cisco chose to publish EIGRP as an informational RFC in 2013.|1 Хотя Cisco создала протокол EIGRP и в течение многих лет сохраняла его как собственный протокол, в 2013 году Cisco решила опубликовать EIGRP в качестве информационного RFC.
This allows other vendors to implement EIGRP, while Cisco retains the rights to the protocol.|Это позволяет другим поставщикам внедрять EIGRP, в то время как Cisco сохраняет права на протокол.
|
Regarding the top row of the table, routing protocols can be considered to be a classless routing protocol or a classful routing protocol.|Что касается верхней строки таблицы, протоколы маршрутизации можно рассматривать как протокол бесклассовой маршрутизации или протокол классовой маршрутизации.
Classless routing protocols support variablelength subnet masks (VLSM) as well as manual route summarization by sending routing protocol messages that include the subnet masks in the message.|Протоколы бесклассовой маршрутизации поддерживают маски подсети переменной длины (VLSM), а также ручное суммирование маршрута путем отправки сообщений протокола маршрутизации, которые включают в себя маски подсети.
The older RIPv1 and IGRP routing protocols—both classful routing protocols—do not.|Старые протоколы маршрутизации RIPv1 и IGRP - оба протокола классовой маршрутизации - этого не делают.
|
Also, note that the older routing protocols (RIPv1, IGRP) sent routing protocol messages as IP broadcast addresses, while the newer routing protocols in the table all use IP multicast destination addresses.|Также обратите внимание, что старые протоколы маршрутизации (RIPv1, IGRP) отправляли сообщения протокола маршрутизации как широковещательные IP-адреса, тогда как все новые протоколы маршрутизации в таблице используют адреса назначения многоадресной IP-рассылки.
The use of multicasts makes the protocol more efficient and causes less overhead and fewer issues with the devices in the subnet that are not running the routing protocol.|Использование многоадресной рассылки делает протокол более эффективным и вызывает меньше накладных расходов и меньше проблем с устройствами в подсети, на которых не работает протокол маршрутизации.
#### Administrative Distance
Административное расстояние   
__|__
--|--
|
Many companies and organizations use a single routing protocol.|Многие компании и организации используют единый протокол маршрутизации.
However, in some cases, a company needs to use multiple routing protocols.|Однако в некоторых случаях компании необходимо использовать несколько протоколов маршрутизации.
For example, if two companies connect their networks so that they can exchange information, they need to exchange some routing information.|Например, если две компании соединяют свои сети, чтобы обмениваться информацией, им необходимо обмениваться некоторой маршрутной информацией.
If one company uses OSPF and the other uses EIGRP on at least one router, both OSPF and EIGRP must be used.|Если одна компания использует OSPF, а другая - EIGRP хотя бы на одном маршрутизаторе, необходимо использовать как OSPF, так и EIGRP.
Then that router can take routes learned by OSPF and advertise them into EIGRP, and vice versa, through a process called route redistribution.|Затем этот маршрутизатор может принимать маршруты, изученные OSPF, и объявлять их в EIGRP, и наоборот, посредством процесса, называемого перераспределением маршрутов.
|
Depending on the network topology, the two routing protocols might learn routes to the same subnets.|В зависимости от топологии сети два протокола маршрутизации могут изучать маршруты к одним и тем же подсетям.
When a single routing protocol learns multiple routes to the same subnet, the metric tells it which route is best.|Когда один протокол маршрутизации изучает несколько маршрутов к одной и той же подсети, метрика сообщает ему, какой маршрут лучше.
However, when two different routing protocols learn routes to the same subnet, because each routing protocol’s metric is based on different information, IOS cannot compare the metrics.|Однако, когда два разных протокола маршрутизации изучают маршруты к одной и той же подсети, поскольку метрика каждого протокола маршрутизации основана на разной информации, IOS не может сравнивать метрики.
For example, OSPF might learn a route to subnet 10.1.1.0 with metric 101, and EIGRP might learn a route to 10.1.1.0 with metric 2,195,416, but the EIGRP-learned route might be the better route—or it might not.|Например, OSPF может изучить маршрут к подсети 10.1.1.0 с метрикой 101, а EIGRP может узнать маршрут к 10.1.1.0 с метрикой 2 195 416, но маршрут, полученный с помощью EIGRP, может быть лучшим маршрутом - а может и нет.
There is simply no basis for comparison between the two metrics.|Для сравнения двух показателей просто нет основы.
|
When IOS must choose between routes learned using different routing protocols, IOS uses a concept called administrative distance.|Когда IOS необходимо выбирать между маршрутами, полученными с использованием разных протоколов маршрутизации, IOS использует концепцию, называемую административным расстоянием.
Administrative distance is a number that denotes how believable an entire routing protocol is on a single router.|Административное расстояние - это число, которое показывает, насколько правдоподобен весь протокол маршрутизации на одном маршрутизаторе.
The lower the number, the better, or more believable, the routing protocol.|Чем меньше число, тем лучше или более правдоподобно протокол маршрутизации.
For example, RIP has a default administrative distance of 120, OSPF uses a default of 110, and EIGRP defaults to 90.|Например, RIP имеет административное расстояние по умолчанию 120, OSPF использует значение по умолчанию 110, а EIGRP - 90.
When using OSPF and EIGRP, the router will believe the EIGRP route instead of the OSPF route (at least by default).|При использовании OSPF и EIGRP маршрутизатор будет считать маршрут EIGRP вместо маршрута OSPF (по крайней мере, по умолчанию).
The administrative distance values are configured on a single router and are not exchanged with other routers.|Значения административного расстояния настраиваются на одном маршрутизаторе и не обмениваются с другими маршрутизаторами.
Table 19-4 lists the various sources of routing information, along with the default administrative distances.|В Табл. 19-4 перечислены различные источники информации о маршрутизации, а также административные расстояния по умолчанию.
|
Table 19-4 Default Administrative Distances Table end.|Таблица 19-4 Окончание таблицы административных расстояний по умолчанию.
|
NOTE The show ip route command lists each route’s administrative distance as the first of the two numbers inside the brackets.|ПРИМЕЧАНИЕ. Команда show ip route перечисляет административное расстояние каждого маршрута в виде первого из двух чисел в скобках.
The second number in brackets is the metric.|Второе число в скобках - это метрика.
|
The table shows the default administrative distance values, but IOS can be configured to change the administrative distance of a particular routing protocol, a particular route, or even a static route.|В таблице показаны значения административного расстояния по умолчанию, но IOS можно настроить для изменения административного расстояния конкретного протокола маршрутизации, конкретного маршрута или даже статического маршрута.
For example, the command ip route 10.1.3.0 255.255.255.0|Например, команда ip route 10.1.3.0 255.255.255.0
###### 10.1.130.253 defines a static route with a default administrative distance of 1, but the command
10.1.130.253 определяет статический маршрут с административным расстоянием по умолчанию 1, но команда   
__|__
--|--
|
ip route 10.1.3.0 255.255.255.0 10.1.130.253 210 defines the same static route with an administrative distance of 210.|ip route 10.1.3.0 255.255.255.0 10.1.130.253 210 определяет тот же статический маршрут с административным расстоянием 210.
So, you can actually create a static route that is only used when the routing protocol does not find a route, just by giving the static route a higher administrative distance.|Таким образом, вы можете фактически создать статический маршрут, который используется только тогда, когда протокол маршрутизации не находит маршрут, просто назначив статическому маршруту более высокое административное расстояние.
### OSPF Concepts and Operation
Концепции и работа OSPF   
__|__
--|--
|
Routing protocols basically exchange information so routers can learn routes.|Протоколы маршрутизации в основном обмениваются информацией, чтобы маршрутизаторы могли изучать маршруты.
The routers learn information about subnets, routes to those subnets, and metric information about how good each route is compared to others.|Маршрутизаторы получают информацию о подсетях, маршрутах к этим подсетям и метрическую информацию о том, насколько каждый маршрут хорош по сравнению с другими.
The routing protocol can then choose the currently best route to each subnet, building the IP routing table.|Затем протокол маршрутизации может выбрать лучший на данный момент маршрут к каждой подсети, создав таблицу IP-маршрутизации.
|
Link-state protocols like OSPF take a little different approach to the particulars of what information they exchange and what the routers do with that information once learned.|Протоколы состояния канала, такие как OSPF, используют несколько иной подход к деталям того, какой информацией они обмениваются, и что маршрутизаторы делают с этой информацией после получения.
|
This next (second) major section narrows the focus to only link-state protocols, specifically OSPFv2.|Этот следующий (второй) основной раздел сужает фокус только до протоколов состояния канала, в частности OSPFv2.
|
This section begins with an overview of what OSPF does by exchanging data about the network in data structures called link-state advertisements (LSA). Then the discussion backs up a bit to provide more details about each of three fundamental parts of how OSPF operates:|Этот раздел начинается с обзора того, что делает OSPF, обмениваясь данными о сети в структурах данных, которые называются объявлениями о состоянии канала (LSA). Затем обсуждение немного возвращается, чтобы предоставить более подробную информацию о каждой из трех основных частей того, как работает OSPF:
|
how OSPF routers use neighbor relationships, how routers exchange LSAs with neighbors, and then how routers calculate the best routes once they learn all the LSAs.|как маршрутизаторы OSPF используют отношения соседей, как маршрутизаторы обмениваются LSA с соседями, а затем как маршрутизаторы вычисляют лучшие маршруты после изучения всех LSA.
#### OSPF Overview
Обзор OSPF   
__|__
--|--
|
Link-state protocols build IP routes with a couple of major steps.|Протоколы состояния канала создают IP-маршруты с помощью пары основных шагов.
First, the routers together build a lot of information about the network: routers, links, IP addresses, status information, and so on.|Во-первых, маршрутизаторы вместе создают большой объем информации о сети: маршрутизаторы, ссылки, IP-адреса, информацию о состоянии и так далее.
Then the routers flood the information, so all routers know the same information.|Затем маршрутизаторы рассылают информацию, поэтому все маршрутизаторы знают одну и ту же информацию.
At that point, each router can calculate routes to all subnets, but from each router’s own perspective.|В этот момент каждый маршрутизатор может рассчитывать маршруты ко всем подсетям, но с точки зрения каждого маршрутизатора.
##### Topology Information and LSAs
Информация о топологии и LSA   
__|__
--|--
|
Routers using link-state routing protocols need to collectively advertise practically every detail about the internetwork to all the other routers.|Маршрутизаторы, использующие протоколы маршрутизации на основе состояния канала, должны сообщать всем остальным маршрутизаторам практически все сведения об объединенной сети.
At the end of the process of flooding the information to all routers, every router in the internetwork has the exact same information about the internetwork.|В конце процесса лавинной рассылки информации на все маршрутизаторы каждый маршрутизатор в объединенной сети имеет точно такую ​​же информацию об объединенной сети.
Flooding a lot of detailed information to every router sounds like a lot of work, and relative to distance vector routing protocols, it is.|Наводнение большого количества подробной информации на каждый маршрутизатор звучит как большая работа, и в отношении протоколов маршрутизации на основе вектора расстояния это так.
|
Open Shortest Path First (OSPF), the most popular link-state IP routing protocol, organizes topology information using LSAs and the link-state database (LSDB). Figure 19-4 represents the ideas.|Open Shortest Path First (OSPF), самый популярный протокол IP-маршрутизации на основе состояния канала, организует информацию о топологии с использованием LSA и базы данных состояний каналов (LSDB). На рис. 19-4 представлены идеи.
Each LSA is a data structure with some specific information about the network topology; the LSDB is simply the collection of all the LSAs known to a router.|Каждый LSA - это структура данных с некоторой конкретной информацией о топологии сети; LSDB - это просто набор всех LSA, известных маршрутизатору.
|
Figure 19-4 LSA and LSDB Relationship Figure 19-5 Flooding LSAs Using a Link-State Routing Protocol Figure 19-5 shows the rather basic flooding process, with R8 sending the original LSA for itself, and the other routers flooding the LSA by forwarding it until every router has a copy.|Рисунок 19-4 Взаимосвязь LSA и LSDB Рисунок 19-5 Флудинг LSA с использованием протокола маршрутизации состояния канала На рисунке 19-5 показан довольно простой процесс лавинной рассылки, когда R8 отправляет исходный LSA для себя, а другие маршрутизаторы лавинно заполняют LSA путем пересылки. это до тех пор, пока у каждого маршрутизатора не будет копия.
|
The flooding process causes every router to learn the contents of the LSA while preventing the LSA from being flooded around in circles.|Процесс лавинной рассылки заставляет каждый маршрутизатор изучать содержимое LSA, предотвращая рассылку LSA по кругу.
Basically, before sending an LSA to yet another neighbor, routers communicate, asking “Do you already have this LSA?,” and then sending the LSA to the next neighbor only if the neighbor has not yet learned about the LSA.|По сути, перед отправкой LSA еще одному соседу маршрутизаторы обмениваются данными, спрашивая «У вас уже есть этот LSA?», А затем отправляют LSA следующему соседу, только если сосед еще не узнал о LSA.
|
Once flooded, routers do occasionally reflood each LSA. Routers reflood an LSA when some information changes (for example, when a link goes up or comes down).|После лавинной рассылки маршрутизаторы иногда повторно загружают каждый LSA. Маршрутизаторы повторно загружают LSA при изменении некоторой информации (например, при повышении или отключении канала).
They also reflood each LSA based on each LSA’s separate aging timer (default 30 minutes).|Они также повторно загружают каждый LSA на основе отдельного таймера устаревания каждого LSA (по умолчанию 30 минут).
##### Applying Dijkstra SPF Math to Find the Best Routes
Применение Dijkstra SPF Math для поиска лучших маршрутов   
__|__
--|--
|
The link-state flooding process results in every router having an identical copy of the LSDB in memory, but the flooding process alone does not cause a router to learn what routes to add to the IP routing table.|Процесс лавинной рассылки состояния канала приводит к тому, что каждый маршрутизатор имеет идентичную копию LSDB в памяти, но сам по себе процесс лавинной рассылки не заставляет маршрутизатор узнавать, какие маршруты добавить в таблицу IP-маршрутизации.
Although incredibly detailed and useful, the information in the LSDB does not explicitly state each router’s best route to reach a destination.|Хотя информация в LSDB невероятно подробна и полезна, она не указывает явно лучший маршрут каждого маршрутизатора для достижения пункта назначения.
|
To build routes, link-state routers have to do some math.|Для построения маршрутов маршрутизаторам со статусом канала необходимо выполнить некоторую математику.
Thankfully, you and I do not have to know the math!|К счастью, нам с тобой не обязательно знать математику!
However, all link-state protocols use a type of math algorithm, called the Dijkstra Shortest Path First (SPF) algorithm, to process the LSDB. That algorithm analyzes (with math) the LSDB and builds the routes that the local router should add to the IP routing table—routes that list a subnet number and mask, an outgoing interface, and a next-hop router IP address.|Однако все протоколы состояния канала для обработки LSDB используют математический алгоритм, называемый алгоритмом поиска кратчайшего пути Дейкстры (SPF). Этот алгоритм анализирует (с помощью математики) LSDB и строит маршруты, которые локальный маршрутизатор должен добавить в таблицу IP-маршрутизации - маршруты, в которых указаны номер и маска подсети, исходящий интерфейс и IP-адрес маршрутизатора следующего перехода.
|
Now that you have the big ideas down, the next several topics walk through the three main phases of how OSPF routers accomplish the work of exchanging LSAs and calculating routes.|Теперь, когда у вас есть основные идеи, в следующих нескольких темах рассматриваются три основных этапа того, как маршрутизаторы OSPF выполняют работу по обмену LSA и вычислению маршрутов.
Those three phases are Becoming neighbors: A relationship between two routers that connect to the same data link, created so that the neighboring routers have a means to exchange their LSDBs.|Эти три этапа - это становление соседями: отношения между двумя маршрутизаторами, которые подключаются к одному каналу передачи данных, созданные таким образом, чтобы у соседних маршрутизаторов были средства для обмена своими LSDB.
|
Exchanging databases: The process of sending LSAs to neighbors so that all routers learn the same LSAs.|Обмен базами данных: процесс отправки LSA соседям, чтобы все маршрутизаторы изучали одни и те же LSA.
|
Adding the best routes: The process of each router independently running SPF, on their local copy of the LSDB, calculating the best routes, and adding those to the IPv4 routing table.|Добавление лучших маршрутов: процесс каждого маршрутизатора, независимо запускающего SPF на своей локальной копии LSDB, вычисление лучших маршрутов и добавление их в таблицу маршрутизации IPv4.
#### Becoming OSPF Neighbors
Стать соседями по OSPF   
__|__
--|--
|
Of everything you learn about OSPF in this chapter, OSPF neighbor concepts have the most to do with how you will configure and troubleshoot OSPF in Cisco routers.|Из всего, что вы узнаете об OSPF в этой главе, концепции соседей OSPF больше всего связаны с тем, как вы будете настраивать OSPF и устранять неполадки в маршрутизаторах Cisco.
You configure OSPF to cause routers to run OSPF and become neighbors with other routers.|Вы настраиваете OSPF, чтобы маршрутизаторы запускали OSPF и становились соседями с другими маршрутизаторами.
Once that happens, OSPF does the rest of the work to exchange LSAs and calculate routers in the background, with no additional configuration required.|Как только это произойдет, OSPF выполнит остальную работу по обмену LSA и вычислению маршрутизаторов в фоновом режиме без дополнительной настройки.
This section discusses the fundamental concepts of OSPF neighbors.|В этом разделе обсуждаются фундаментальные концепции соседей OSPF.
##### The Basics of OSPF Neighbors
Основы OSPF Neighbours   
__|__
--|--
|
OSPF neighbors are routers that both use OSPF and both sit on the same data link.|Соседи OSPF - это маршрутизаторы, которые используют OSPF и оба подключены к одному каналу передачи данных.
Two routers can become OSPF neighbors if connected to the same VLAN, or same serial link, or same Ethernet WAN link.|Два маршрутизатора могут стать соседями OSPF, если они подключены к одной и той же VLAN, одному последовательному каналу или одному каналу Ethernet WAN.
|
Two routers need to do more than simply exist on the same link to become OSPF neighbors;|Два маршрутизатора должны делать больше, чем просто существовать на одном канале, чтобы стать соседями OSPF;
|
they must send OSPF messages and agree to become OSPF neighbors.|они должны отправлять сообщения OSPF и соглашаться стать соседями OSPF.
To do so, the routers send OSPF Hello messages, introducing themselves to the potential neighbor.|Для этого маршрутизаторы отправляют сообщения приветствия OSPF, представляя себя потенциальному соседу.
Assuming the two potential neighbors have compatible OSPF parameters, the two form an OSPF neighbor relationship, and would be displayed in the output of the show ip ospf neighbor command.|Предполагая, что два потенциальных соседа имеют совместимые параметры OSPF, они образуют отношения соседей OSPF и будут отображаться в выходных данных команды show ip ospf neighbour.
|
The OSPF neighbor relationship also lets OSPF know when a neighbor might not be a good option for routing packets right now.|Связь между соседями OSPF также позволяет OSPF знать, когда соседство может быть не лучшим вариантом для маршрутизации пакетов прямо сейчас.
Imagine R1 and R2 form a neighbor relationship, learn LSAs, and calculate routes that send packets through the other router.|Представьте, что R1 и R2 образуют отношения соседства, изучают LSA и вычисляют маршруты, которые отправляют пакеты через другой маршрутизатор.
Months later, R1 notices that the neighbor relationship with R2 fails.|Спустя несколько месяцев R1 замечает, что отношения соседа с R2 не работают.
That failed neighbor connection to R2 makes R1 react: R1 refloods LSAs impacted by the failed link, and R1 runs SPF to recalculate its own routes.|Это неудачное соседнее соединение с R2 заставляет R1 реагировать: R1 повторно загружает LSA, на которые повлиял отказавший канал, и R1 запускает SPF для пересчета своих собственных маршрутов.
|
Finally, the OSPF neighbor model allows new routers to be dynamically discovered.|Наконец, модель соседей OSPF позволяет динамически обнаруживать новые маршрутизаторы.
That means new routers can be added to a network without requiring every router to be reconfigured.|Это означает, что в сеть можно добавлять новые маршрутизаторы, не требуя перенастройки каждого маршрутизатора.
|
Instead, OSPF routers listen for OSPF Hello messages from new routers and react to those messages, attempting to become neighbors and exchange LSDBs.|Вместо этого маршрутизаторы OSPF прослушивают сообщения приветствия OSPF от новых маршрутизаторов и реагируют на эти сообщения, пытаясь стать соседями и обмениваться LSDB.
##### Meeting Neighbors and Learning Their Router ID
Встреча с соседями и определение их идентификатора маршрутизатора   
__|__
--|--
|
The OSPF Hello process, by which new neighbor relationships are formed, works somewhat like when you move to a new house and meet your various neighbors.|Процесс приветствия OSPF, с помощью которого формируются новые отношения соседей, работает примерно так же, как когда вы переезжаете в новый дом и встречаетесь со своими соседями.
When you see each other outside, you might walk over, say hello, and learn each other’s name.|Когда вы видите друг друга на улице, вы можете подойти, поздороваться и узнать имена друг друга.
After talking a bit, you form a first impression, particularly as to whether you think you’ll enjoy chatting with this neighbor occasionally, or whether you can just wave and not take the time to talk the next time you see him outside.|Поговорив немного, у вас складывается первое впечатление, особенно в отношении того, нравится ли вам время от времени болтать с этим соседом, или вы можете просто помахать рукой и не тратить время на разговоры, когда в следующий раз увидите его на улице.
|
Similarly, with OSPF, the process starts with messages called OSPF Hello messages.|Точно так же в OSPF процесс начинается с сообщений, называемых сообщениями приветствия OSPF.
The Hellos in turn list each router’s router ID (RID), which serves as each router’s unique name or identifier for OSPF. Finally, OSPF does several checks of the information in the Hello messages to ensure that the two routers should become neighbors.|Hellos, в свою очередь, перечисляет идентификатор маршрутизатора (RID) каждого маршрутизатора, который служит уникальным именем или идентификатором каждого маршрутизатора для OSPF. Наконец, OSPF выполняет несколько проверок информации в сообщениях Hello, чтобы убедиться, что два маршрутизатора должны стать соседями.
|
OSPF RIDs are 32-bit numbers.|OSPF RID - это 32-битные числа.
As a result, most command output lists these as dotted-decimal numbers (DDN). By default, IOS chooses one of the router’s interface IPv4 addresses to use as its OSPF RID. However, the OSPF RID can be directly configured, as covered in the section “Configuring the OSPF Router ID” in Chapter 20, “Implementing OSPF.”|В результате в большинстве выходных данных команд они отображаются как десятичные числа с точками (DDN). По умолчанию IOS выбирает один из IPv4-адресов интерфейса маршрутизатора для использования в качестве своего идентификатора OSPF RID. Однако RID OSPF можно настроить напрямую, как описано в разделе «Настройка идентификатора маршрутизатора OSPF» главы 20 «Реализация OSPF».
|
As soon as a router has chosen its OSPF RID and some interfaces come up, the router is ready to meet its OSPF neighbors.|Как только маршрутизатор выбрал свой OSPF RID и появилось несколько интерфейсов, маршрутизатор готов к работе со своими соседями OSPF.
OSPF routers can become neighbors if they are connected to the same subnet.|Маршрутизаторы OSPF могут стать соседями, если они подключены к одной подсети.
To discover other OSPF-speaking routers, a router sends multicast OSPF Hello packets to each interface and hopes to receive OSPF Hello packets from other routers connected to those interfaces.|Чтобы обнаружить другие маршрутизаторы, использующие протокол OSPF, маршрутизатор отправляет многоадресные пакеты приветствия OSPF каждому интерфейсу и надеется получить пакеты приветствия OSPF от других маршрутизаторов, подключенных к этим интерфейсам.
Figure 19-6 outlines the basic concept.|На рис. 19-6 представлена ​​основная концепция.
|
Figure 19-6 OSPF Hello Packets Routers R1 and R2 both send Hello messages onto the link.|Рис. 19-6. Пакеты приветствия OSPF. Маршрутизаторы R1 и R2 отправляют сообщения Hello по каналу.
They continue to send Hellos at a regular interval based on their Hello timer settings.|Они продолжают посылать приветствия через равные промежутки времени в зависимости от настроек таймера приветствия.
The Hello messages themselves have the following features:|Сами сообщения Hello имеют следующие особенности:
###### The Hello message follows the IP packet header, with IP protocol type 89.
Сообщение Hello следует за заголовком IP-пакета с типом протокола IP 89.   
###### Hello packets are sent to multicast IP address 224.0.0.5, a multicast IP address intended
Пакеты Hello отправляются на многоадресный IP-адрес 224.0.0.5, предназначенный для многоадресного IP-адреса.   
__|__
--|--
|
for all OSPF-speaking routers.|для всех маршрутизаторов с поддержкой OSPF.
###### OSPF routers listen for packets sent to IP multicast address 224.0.0.5, in part hoping to
Маршрутизаторы OSPF прослушивают пакеты, отправленные на многоадресный IP-адрес 224.0.0.5, частично в надежде   
__|__
--|--
|
receive Hello packets and learn about new neighbors.|получать пакеты Hello и узнавать о новых соседях.
|
Taking a closer look, Figure 19-7 shows several of the neighbor states used by the early formation of an OSPF neighbor relationship.|Если присмотреться внимательнее, на рис. 19-7 показаны несколько соседних состояний, используемых при раннем формировании отношений соседства OSPF.
The figure shows the Hello messages in the center and the resulting neighbor states on the left and right edges of the figure.|На рисунке показаны сообщения Hello в центре и результирующие состояния соседей на левом и правом краях рисунка.
Each router keeps an OSPF state variable for how it views the neighbor.|Каждый маршрутизатор сохраняет переменную состояния OSPF для того, как он видит соседа.
|
Figure 19-7 Early Neighbor States Following the steps in the figure, the scenario begins with the link down, so the routers have no knowledge of each other as OSPF neighbors.|Рис. 19-7. Ранние соседние состояния. Следуя шагам, показанным на рисунке, сценарий начинается с разрыва связи, поэтому маршрутизаторы не знают друг друга как соседей OSPF.
As a result, they have no state (status) information about each other as neighbors, and they would not list each other in the output of the show ip ospf neighbor command.|В результате у них нет информации о состоянии (статусе) друг друга как соседей, и они не будут перечислять друг друга в выводе команды show ip ospf neighbour.
At Step 2, R1 sends the first Hello, so R2 learns of the existence of R1 as an OSPF router.|На шаге 2 R1 отправляет первое приветствие, поэтому R2 узнает о существовании R1 как маршрутизатора OSPF.
At that point, R2 lists R1 as a neighbor, with an interim beginning state of init.|В этот момент R2 перечисляет R1 как соседа с промежуточным начальным состоянием init.
|
The process continues at Step 3, with R2 sending back a Hello.|Процесс продолжается на шаге 3, когда R2 отправляет ответ Hello.
This message tells R1 that R2 exists, and it allows R1 to move through the init state and quickly to a 2-way state.|Это сообщение сообщает R1, что R2 существует, и позволяет R1 перейти через состояние инициализации и быстро перейти в двухстороннее состояние.
At Step 4, R2 receives the next Hello from R1, and R2 can also move to a 2-way state.|На шаге 4 R2 получает следующее приветствие от R1, и R2 также может перейти в двустороннее состояние.
|
The 2-way state is a particularly important OSPF state.|Двустороннее состояние - это особенно важное состояние OSPF.
At that point, the following major facts are true:|На этом этапе верны следующие основные факты:
###### The router received a Hello from the neighbor, with that router’s own RID listed as being
Маршрутизатор получил привет от соседа, при этом собственный RID этого маршрутизатора указан как   
__|__
--|--
|
seen by the neighbor.|видел сосед.
###### The router has checked all the parameters in the Hello received from the neighbor, with
Маршрутизатор проверил все параметры в сообщении Hello, полученном от соседа, с   
__|__
--|--
|
no problems.|без проблем.
The router is willing to become an OSPF neighbor.|Маршрутизатор желает стать соседом OSPF.
###### If both routers reach a 2-way state with each other, it means that both routers meet all
Если оба маршрутизатора достигают двустороннего состояния друг с другом, это означает, что оба маршрутизатора соответствуют всем   
__|__
--|--
|
OSPF configuration requirements to become neighbors.|Требования к конфигурации OSPF, чтобы стать соседями.
Effectively, at that point, they are neighbors and ready to exchange their LSDB with each other.|Фактически, в этот момент они являются соседями и готовы обмениваться своими LSDB друг с другом.
#### Exchanging the LSDB Between Neighbors
Обмен LSDB между соседями   
__|__
--|--
|
One purpose of forming OSPF neighbor relationships is to allow the two neighbors to exchange their databases.|Одна из целей формирования отношений между соседями OSPF - дать возможность двум соседям обмениваться своими базами данных.
This next topic works through some of the details of OSPF database exchange.|В следующем разделе рассматриваются некоторые детали обмена базами данных OSPF.
##### Fully Exchanging LSAs with Neighbors
Полный обмен LSA с соседями   
__|__
--|--
|
The OSPF neighbor state 2-way means that the router is available to exchange its LSDB with the neighbor.|Двухстороннее состояние соседа OSPF означает, что маршрутизатор может обмениваться своим LSDB с соседом.
In other words, it is ready to begin a 2-way exchange of the LSDB. So, once two routers on a link reach the 2-way state, they can immediately move on to the process of database exchange.|Другими словами, он готов начать двусторонний обмен LSDB. Таким образом, как только два маршрутизатора на канале переходят в двухстороннее состояние, они могут немедленно перейти к процессу обмена базой данных.
|
The database exchange process can be quite involved, with several OSPF messages and several interim neighbor states.|Процесс обмена базой данных может быть весьма сложным, с несколькими сообщениями OSPF и несколькими промежуточными состояниями соседей.
This chapter is more concerned with a few of the messages and the final state when database exchange has completed: the full state.|В этой главе больше внимания уделяется нескольким сообщениям и конечному состоянию, когда обмен базой данных завершен: полное состояние.
|
After two routers decide to exchange databases, they do not simply send the contents of the entire database.|После того, как два маршрутизатора решат обмениваться базами данных, они не просто отправят содержимое всей базы данных.
First, they tell each other a list of LSAs in their respective databases—not all the details of the LSAs, just a list. (Think of these lists as checklists.) Then each router can check which LSAs it already has and then ask the other router for only the LSAs that are not known yet.|Во-первых, они сообщают друг другу список LSA в своих соответствующих базах данных - не все детали LSA, а только список. (Считайте эти списки контрольными.) Затем каждый маршрутизатор может проверить, какие LSA у него уже есть, а затем запросить у другого маршрутизатора только те LSA, которые еще не известны.
|
For instance, R1 might send R2 a checklist that lists 10 LSAs (using an OSPF Database Description, or DD, packet).|Например, R1 может отправить R2 контрольный список, в котором перечислены 10 LSA (с использованием пакета описания базы данных OSPF или DD).
R2 then checks its LSDB and finds six of those 10 LSAs. So, R2 asks R1 (using a Link-State Request packet) to send the four additional LSAs.|Затем R2 проверяет свой LSDB и находит шесть из этих 10 LSA. Итак, R2 запрашивает у R1 (используя пакет запроса состояния канала) четыре дополнительных LSA.
|
Thankfully, most OSPFv2 work does not require detailed knowledge of these specific protocol steps.|К счастью, большая часть работы с OSPFv2 не требует детального знания этих конкретных шагов протокола.
However, a few of the terms are used quite a bit and should be remembered.|Однако некоторые термины используются довольно часто, и их следует помнить.
In particular, the OSPF messages that actually send the LSAs between neighbors are called Link-State Update (LSU) packets.|В частности, сообщения OSPF, которые фактически отправляют LSA между соседями, называются пакетами обновления состояния канала (LSU).
That is, the LSU packet holds data structures called linkstate advertisements (LSA). The LSAs are not packets, but rather data structures that sit inside the LSDB and describe the topology.|То есть пакет LSU содержит структуры данных, называемые рекламными объявлениями состояния канала (LSA). LSA - это не пакеты, а структуры данных, которые находятся внутри LSDB и описывают топологию.
|
Figure 19-8 pulls some of these terms and processes together, with a general example.|На рис. 19-8 собраны вместе некоторые из этих терминов и процессов на общем примере.
The story picks up the example shown in Figure 19-7, with Figure 19-8 showing an example of the database exchange process between Routers R1 and R2. The center shows the protocol messages, and the outer items show the neighbor states at different points in the process.|История берет пример, показанный на рис. 19-7, при этом на рис. 19-8 показан пример процесса обмена базой данных между маршрутизаторами R1 и R2. В центре показаны сообщения протокола, а внешние элементы показывают состояния соседей в разных точках процесса.
|
Focus on two items in particular:|Сосредоточьтесь на двух вещах:
###### The routers exchange the LSAs inside LSU packets.
Маршрутизаторы обмениваются LSA внутри пакетов LSU.   
###### When finished, the routers reach a full state, meaning they have fully exchanged the contents
По завершении маршрутизаторы достигают полного состояния, что означает, что они полностью обменялись содержимым.   
__|__
--|--
|
of their LSDBs.|своих LSDB.
|
Database Description RID 1.1.1.1 RID 2.2.2.2 Database Description LSU, with Several LSAs Exchange Loading Loading Full Full ExStart LSU, with Several LSAs ...|Описание базы данных RID 1.1.1.1 RID 2.2.2.2 LSU описания базы данных с несколькими LSA, загрузка при обмене Загрузка полного LSU ExStart с несколькими LSA ...
|
Figure 19-8 Database Exchange Example, Ending in a Full State|Рисунок 19-8 Пример обмена базой данных, завершение в полном состоянии
##### Maintaining Neighbors and the LSDB
Поддержка соседей и LSDB   
__|__
--|--
|
Once two neighbors reach a full state, they have done all the initial work to exchange OSPF information between them.|Как только два соседа достигают полного состояния, они выполнили всю начальную работу по обмену информацией OSPF между собой.
However, neighbors still have to do some small ongoing tasks to maintain the neighbor relationship.|Тем не менее, соседи по-прежнему должны выполнять некоторые небольшие текущие задачи, чтобы поддерживать отношения между соседями.
|
First, routers monitor each neighbor relationship using Hello messages and two related timers:|Во-первых, маршрутизаторы отслеживают отношения каждого соседа с помощью сообщений Hello и двух связанных таймеров:
|
the Hello Interval and the Dead Interval.|интервал приветствия и интервал мертвых.
Routers send Hellos every Hello Interval to each neighbor.|Маршрутизаторы отправляют приветствия каждому соседу через каждые интервалы приветствия.
Each router expects to receive a Hello from each neighbor based on the Hello Interval, so if a neighbor is silent for the length of the Dead Interval (by default, four times as long as the Hello Interval), the loss of Hellos means that the neighbor has failed.|Каждый маршрутизатор ожидает получения приветствия от каждого соседа на основе интервала приветствия, поэтому, если сосед молчит в течение интервала ожидания (по умолчанию в четыре раза больше, чем интервал приветствия), потеря приветствия означает, что сосед потерпел неудачу.
|
Next, routers must react when the topology changes as well, and neighbors play a key role in that process.|Затем маршрутизаторы должны реагировать, когда топология также изменяется, и соседи играют ключевую роль в этом процессе.
When something changes, one or more routers change one or more LSAs. Then the routers must flood the changed LSAs to each neighbor so that the neighbor can change its LSDB.|Когда что-то меняется, один или несколько маршрутизаторов изменяют один или несколько LSA. Затем маршрутизаторы должны рассылать измененные LSA каждому соседу, чтобы сосед мог изменить свой LSDB.
|
For example, imagine a LAN switch loses power, so a router’s G0/0 interface fails from up/up to down/down.|Например, представьте, что коммутатор локальной сети теряет питание, поэтому интерфейс G0 / 0 маршрутизатора выходит из строя при переходе вверх / вверх в положение вниз / вниз.
That router updates an LSA that shows the router’s G0/0 as being down.|Этот маршрутизатор обновляет LSA, который показывает, что G0 / 0 маршрутизатора отключен.
That router then sends the LSA to its neighbors, and that neighbor in turn sends it to its neighbors, until all routers again have an identical copy of the LSDB. Each router’s LSDB now reflects the fact that the original router’s G0/0 interface failed, so each router will then use SPF to recalculate any routes affected by the failed interface.|Затем этот маршрутизатор отправляет LSA своим соседям, а этот сосед, в свою очередь, отправляет его своим соседям, пока все маршрутизаторы снова не получат идентичную копию LSDB. LSDB каждого маршрутизатора теперь отражает тот факт, что интерфейс G0 / 0 исходного маршрутизатора вышел из строя, поэтому каждый маршрутизатор будет затем использовать SPF для пересчета любых маршрутов, затронутых отказавшим интерфейсом.
|
A third maintenance task done by neighbors is to reflood each LSA occasionally, even when the network is completely stable.|Третья задача обслуживания, выполняемая соседями, - время от времени повторно загружать каждый LSA, даже если сеть полностью стабильна.
By default, each router that creates an LSA also has the responsibility to reflood the LSA every 30 minutes (the default), even if no changes occur.|По умолчанию каждый маршрутизатор, создающий LSA, также несет ответственность за повторное заполнение LSA каждые 30 минут (по умолчанию), даже если никаких изменений не происходит.
|
(Note that each LSA has a separate timer, based on when the LSA was created, so there is no single big event where the network is overloaded with flooding LSAs.)|(Обратите внимание, что у каждого LSA есть отдельный таймер в зависимости от того, когда был создан LSA, поэтому нет ни одного большого события, при котором сеть была бы перегружена лавинными LSA.)
|
The following list summarizes these three maintenance tasks for easier review:|В следующем списке приведены эти три задачи обслуживания для облегчения рассмотрения:
###### Maintain neighbor state by sending Hello messages based on the Hello Interval and listening
Поддерживайте состояние соседа, отправляя сообщения Hello на основе интервала Hello и прослушивая   
__|__
--|--
|
for Hellos before the Dead Interval expires|для Hellos до истечения интервала мертвых
###### Flood any changed LSAs to each neighbor
Флудить всем измененным LSA каждому соседу   
###### Reflood unchanged LSAs as their lifetime expires (default 30 minutes)
Повторно заливать неизмененные LSA по истечении их срока службы (по умолчанию 30 минут)   
##### Using Designated Routers on Ethernet Links
Использование назначенных маршрутизаторов на каналах Ethernet   
__|__
--|--
|
OSPF behaves differently on some types of interfaces based on a per-interface setting called the OSPF network type.|OSPF по-разному ведет себя на некоторых типах интерфейсов в зависимости от настройки каждого интерфейса, называемой типом сети OSPF.
On Ethernet links, OSPF defaults to use a network type of broadcast, which causes OSPF to elect one of the routers on the same subnet to act as the designated router (DR). The DR plays a key role in how the database exchange process works, with different rules than with point-to-point links.|В каналах Ethernet OSPF по умолчанию использует сетевой тип широковещательной рассылки, в результате чего OSPF выбирает один из маршрутизаторов в той же подсети в качестве назначенного маршрутизатора (DR). DR играет ключевую роль в том, как работает процесс обмена базой данных, с другими правилами, чем для соединений точка-точка.
|
To see how, consider the example that begins with Figure 19-9.|Чтобы увидеть, как это сделать, рассмотрим пример, который начинается с рис. 19-9.
The figure shows five OSPFv2 routers on the same Ethernet VLAN. These five OSPF routers elect one router to act as the DR and one router to be a backup DR (BDR). The figure shows A and B as DR and BDR, for no other reason than the Ethernet must have one of each.|На рисунке показаны пять маршрутизаторов OSPFv2 в одной сети Ethernet VLAN. Эти пять маршрутизаторов OSPF выбирают один маршрутизатор в качестве DR и один маршрутизатор в качестве резервного DR (BDR). На рисунке A и B показаны как DR и BDR только по той причине, что в Ethernet должен быть один из них.
|
Figure 19-9 Routers A and B Elected as DR and BDR The database exchange process on an Ethernet link does not happen between every pair of routers on the same VLAN/subnet.|Рисунок 19-9 Маршрутизаторы A и B, выбранные как DR и BDR Процесс обмена базой данных по каналу Ethernet не происходит между каждой парой маршрутизаторов в одной и той же VLAN / подсети.
Instead, it happens between the DR and each of the other routers, with the DR making sure that all the other routers get a copy of each LSA. In other words, the database exchange happens over the flows shown in Figure 19-10.|Вместо этого это происходит между DR и каждым из других маршрутизаторов, причем DR следит за тем, чтобы все остальные маршрутизаторы получили копию каждого LSA. Другими словами, обмен базой данных происходит по потокам, показанным на рисунке 19-10.
|
Figure 19-10 Database Exchange to and from the DR on an Ethernet OSPF uses the BDR concept because the DR is so important to the database exchange process.|Рис. 19-10. Обмен базой данных с DR в Ethernet и обратно OSPF использует концепцию BDR, потому что DR очень важен для процесса обмена базой данных.
|
The BDR watches the status of the DR and takes over for the DR if it fails. (When the DR fails, the BDR takes over, and then a new BDR is elected.)|BDR следит за состоянием DR и принимает на себя DR в случае отказа. (Когда DR выходит из строя, BDR вступает во владение, а затем выбирается новый BDR.)
|
The use of a DR/BDR, along with the use of multicast IP addresses, makes the exchange of OSPF LSDBs more efficient on networks that allow more than two routers on the same link.|Использование DR / BDR, наряду с использованием IP-адресов многоадресной рассылки, делает обмен LSDB OSPF более эффективным в сетях, которые позволяют подключать более двух маршрутизаторов к одному каналу.
|
The DR can send a packet to all OSPF routers in the subnet by using multicast IP address 224.0.0.5.|DR может отправить пакет всем маршрутизаторам OSPF в подсети, используя IP-адрес многоадресной рассылки 224.0.0.5.
IANA reserves this address as the “All SPF Routers” multicast address just for this purpose.|IANA резервирует этот адрес как групповой адрес «Все маршрутизаторы SPF» только для этой цели.
For instance, in Figure 19-10, the DR can send one set of messages to all the OSPF routers rather than sending one message to each router.|Например, на рис. 19-10 DR может отправлять один набор сообщений всем маршрутизаторам OSPF, а не отправлять одно сообщение каждому маршрутизатору.
|
Similarly, any OSPF router needing to send a message to the DR and also to the BDR (so it remains ready to take over for the DR) can send those messages to the “All SPF DRs” multicast address 224.0.0.6.|Точно так же любой маршрутизатор OSPF, которому необходимо отправить сообщение на DR, а также на BDR (чтобы он оставался готовым принять на себя DR), может отправить эти сообщения на групповой адрес 224.0.0.6 «Все SPF DR».
So, instead of having to send one set of messages to the DR and another set to the BDR, an OSPF router can send one set of messages, making the exchange more efficient.|Таким образом, вместо того, чтобы отправлять один набор сообщений на DR, а другой набор на BDR, маршрутизатор OSPF может отправлять один набор сообщений, что делает обмен более эффективным.
|
At this point, you might be getting a little tired of some of the theory, but finally, the theory actually shows something that you may see in show commands on a router.|На данный момент вы, возможно, немного устали от теории, но, наконец, теория на самом деле показывает то, что вы можете увидеть в командах show на маршрутизаторе.
Because the DR and BDR both do full database exchange with all the other OSPF routers in the LAN, they reach a full state with all neighbors.|Поскольку DR и BDR выполняют полный обмен базой данных со всеми другими маршрутизаторами OSPF в локальной сети, они достигают полного состояния со всеми соседями.
However, routers that are neither a DR nor a BDR—|Однако маршрутизаторы, которые не являются ни DR, ни BDR -
|
called DROthers by OSPF—never reach a full state because they do not exchange LSDBs directly with each other.|называемые DROthers OSPF - никогда не достигают полного состояния, потому что они не обмениваются LSDB напрямую друг с другом.
As a result, the show ip ospf neighbor command on these DROther routers lists some neighbors in a 2-way state, remaining in that state under normal operation.|В результате команда show ip ospf neighbour на этих маршрутизаторах DROther перечисляет некоторых соседей в двустороннем состоянии, оставаясь в этом состоянии при нормальной работе.
|
For instance, with OSPF working normally on the Ethernet LAN in Figure 19-10, a show ip ospf neighbor command on router C (which is a DROther router) would show the following:|Например, при нормальной работе OSPF в локальной сети Ethernet на рис. 19-10 команда show ip ospf neighbour на маршрутизаторе C (который является маршрутизатором DROther) покажет следующее:
###### Two neighbors (A and B, the DR and BDR, respectively) with a full state (called fully
Два соседа (A и B, DR и BDR соответственно) с полным состоянием (называются полностью   
__|__
--|--
|
adjacent neighbors)|соседние соседи)
###### Two neighbors (D and E, which are DROthers) with a 2-way state (called neighbors)
Два соседа (D и E, которые являются DROthers) с двусторонним состоянием (называемые соседи)   
__|__
--|--
|
OSPF requires some terms to describe all neighbors versus the subset of all neighbors that reach the full state.|OSPF требует некоторых терминов для описания всех соседей в сравнении с подмножеством всех соседей, которые достигли полного состояния.
First, all OSPF routers on the same link that reach the 2-way state—that is, they send Hello messages and the parameters match—are called neighbors.|Во-первых, все маршрутизаторы OSPF на одном и том же канале, которые достигают двустороннего состояния, т. Е. Отправляют сообщения Hello и параметры совпадают, называются соседями.
The subset of neighbors for which the neighbor relationship continues on and reaches the full state are called adjacent neighbors.|Подмножество соседей, для которых отношения соседства продолжаются и достигают полного состояния, называются соседними соседями.
Additionally, OSPFv2 RFC 2328 emphasizes the connection between the full state and the term adjacent neighbor by using the synonyms of fully adjacent and fully adjacent neighbor.|Кроме того, OSPFv2 RFC 2328 подчеркивает связь между полным состоянием и термином «соседний сосед», используя синонимы «полностью смежный сосед» и «полностью смежный сосед».
Finally, while the terms so far refer to the neighbor, two other terms refer to the relationship: neighbor relationship refers to any OSPF neighbor relationship, while the term adjacency refers to neighbor relationships that reach a full state.|Наконец, хотя термины до сих пор относятся к соседу, два других термина относятся к отношениям: отношения соседства относятся к любым отношениям соседства OSPF, а термин смежность относится к отношениям соседей, которые достигают полного состояния.
Table 19-5 details the terms.|В Таблице 19-5 подробно описаны условия.
|
Table 19-5 Stable OSPF Neighbor States and Their Meanings Table end.|Таблица 19-5 Стабильные соседние состояния OSPF и их значения Конец таблицы.
#### Calculating the Best Routes with SPF
Расчет лучших маршрутов с SPF   
__|__
--|--
|
OSPF LSAs contain useful information, but they do not contain the specific information that a router needs to add to its IPv4 routing table.|LSA OSPF содержат полезную информацию, но не содержат конкретной информации, которую маршрутизатор должен добавить в свою таблицу маршрутизации IPv4.
In other words, a router cannot just copy information from the LSDB into a route in the IPv4 routing table.|Другими словами, маршрутизатор не может просто скопировать информацию из LSDB в маршрут в таблице маршрутизации IPv4.
The LSAs individually are more like pieces of a jigsaw puzzle.|LSA по отдельности больше похожи на кусочки мозаики.
So, to know what routes to add to the routing table, each router must do some SPF math to choose the best routes from that router’s perspective.|Итак, чтобы знать, какие маршруты добавить в таблицу маршрутизации, каждый маршрутизатор должен выполнить некоторую математическую подсчету SPF, чтобы выбрать лучшие маршруты с точки зрения этого маршрутизатора.
The router then adds each route to its routing table: a route with a subnet number and mask, an outgoing interface, and a next-hop router IP address.|Затем маршрутизатор добавляет каждый маршрут в свою таблицу маршрутизации: маршрут с номером подсети и маской, исходящий интерфейс и IP-адрес маршрутизатора следующего перехода.
|
Although engineers do not need to know the details of how SPF does the math, they do need to know how to predict which routes SPF will choose as the best route.|Хотя инженерам не нужно знать подробности того, как SPF выполняет математические вычисления, им нужно знать, как предсказать, какие маршруты SPF выберет как лучший.
The SPF algorithm calculates all the routes for a subnet—that is, all possible routes from the router to the destination subnet.|Алгоритм SPF вычисляет все маршруты для подсети, то есть все возможные маршруты от маршрутизатора до подсети назначения.
If more than one route exists, the router compares the metrics, picking the best (lowest) metric route to add to the routing table.|Если существует более одного маршрута, маршрутизатор сравнивает метрики, выбирая лучший (самый низкий) метрический маршрут для добавления в таблицу маршрутизации.
Although the SPF math can be complex, engineers with a network diagram, router status information, and simple addition can calculate the metric for each route, predicting what SPF will choose.|Хотя математика SPF может быть сложной, инженеры, располагающие схемой сети, информацией о состоянии маршрутизатора и простым дополнением, могут вычислить метрику для каждого маршрута, прогнозируя, какой SPF выберет.
|
Once SPF has identified a route, OSPF calculates the metric for a route as follows:|Как только SPF идентифицировал маршрут, OSPF вычисляет метрику для маршрута следующим образом:
|
The sum of the OSPF interface costs for all outgoing interfaces in the route.|Сумма затрат интерфейса OSPF для всех исходящих интерфейсов в маршруте.
|
Figure 19-11 shows an example with three possible routes from R1 to Subnet X (172.16.3.0/24) at the bottom of the figure.|На рисунке 19-11 показан пример с тремя возможными маршрутами от R1 до подсети X (172.16.3.0/24) в нижней части рисунка.
|
Figure 19-11 SPF Tree to Find R1’s Route to 172.16.3.0/24 NOTE OSPF considers the costs of the outgoing interfaces (only) in each route.|Рисунок 19-11 Дерево SPF для поиска маршрута R1 к 172.16.3.0/24 ПРИМЕЧАНИЕ OSPF учитывает стоимость исходящих интерфейсов (только) на каждом маршруте.
It does not add the cost for incoming interfaces in the route.|Это не добавляет стоимости входящих интерфейсов в маршрут.
|
Table 19-6 lists the three routes shown in Figure 19-11, with their cumulative costs, showing that R1’s best route to 172.16.3.0/24 starts by going through R5.|В таблице 19-6 перечислены три маршрута, показанные на рис. 19-11, с их совокупными затратами, из которых видно, что лучший маршрут R1 до 172.16.3.0/24 начинается через R5.
|
Route Location in Figure 19-11 Cumulative Cost R1–R7–R8 Left 10 + 180 + 10 = 200 R1–R5–R6–R8 Middle 20 + 30 + 40 + 10 = 100 R1–R2–R3–R4–R8 Right 30 + 60 + 20 + 5 + 10 = 125 Table end.|Расположение маршрута на рисунке 19-11 Суммарная стоимость R1 – R7 – R8 слева 10 + 180 + 10 = 200 R1 – R5 – R6 – R8 Средний 20 + 30 + 40 + 10 = 100 R1 – R2 – R3 – R4 – R8 справа 30 + 60 + 20 + 5 + 10 = 125 Конец таблицы.
|
Table end.|Конец таблицы.
|
As a result of the SPF algorithm’s analysis of the LSDB, R1 adds a route to subnet 172.16.3.0/24 to its routing table, with the next-hop router of R5.|В результате анализа LSDB алгоритмом SPF R1 добавляет маршрут к подсети 172.16.3.0/24 в свою таблицу маршрутизации с маршрутизатором следующего перехода R5.
|
In real OSPF networks, an engineer can do the same process by knowing the OSPF cost for each interface.|В реальных сетях OSPF инженер может проделать тот же процесс, зная стоимость OSPF для каждого интерфейса.
Armed with a network diagram, the engineer can examine all routes, add the costs, and predict the metric for each route.|Вооружившись сетевой диаграммой, инженер может изучить все маршруты, добавить затраты и спрогнозировать метрику для каждого маршрута.
### OSPF Areas and LSAs
Области OSPF и LSA   
__|__
--|--
|
OSPF can be used in some networks with very little thought about design issues.|OSPF можно использовать в некоторых сетях, не задумываясь о проблемах проектирования.
You just turn on OSPF in all the routers, put all interfaces into the same area (usually area 0), and it works!|Вы просто включаете OSPF на всех маршрутизаторах, помещаете все интерфейсы в одну и ту же область (обычно область 0), и это работает!
|
Figure 19-12 shows one such network example, with 11 routers and all interfaces in area 0.|На рисунке 19-12 показан один такой пример сети с 11 маршрутизаторами и всеми интерфейсами в области 0.
|
Figure 19-12 Single-Area OSPF Larger OSPFv2 networks suffer with a single-area design.|Рис. 19-12. OSPF с одной областью. Более крупные сети OSPFv2 страдают от конструкции с одной областью.
For instance, now imagine an enterprise network with 900 routers, rather than only 11, and several thousand subnets.|Например, теперь представьте корпоративную сеть с 900 маршрутизаторами, а не только с 11 и несколькими тысячами подсетей.
As it turns out, the CPU time to run the SPF algorithm on all that topology data just takes time.|Как оказалось, процессорное время для запуска алгоритма SPF для всех данных топологии просто требует времени.
|
As a result, OSPFv2 convergence time—the time required to react to changes in the network—|В результате время конвергенции OSPFv2 - время, необходимое для реакции на изменения в сети -
|
can be slow.|может быть медленным.
The routers might run low on RAM as well.|Маршрутизаторам также может не хватить оперативной памяти.
Additional problems with a single area design include the following:|Дополнительные проблемы с дизайном одной области включают следующее:
###### A larger topology database requires more memory on each router.
База данных топологии большего размера требует большего объема памяти на каждом маршрутизаторе.   
###### The SPF algorithm requires processing power that grows exponentially compared to the
Алгоритм SPF требует вычислительной мощности, которая растет экспоненциально по сравнению с   
__|__
--|--
|
size of the topology database.|размер базы данных топологии.
###### A single interface status change anywhere in the internetwork (up to down, or down to
Изменение статуса одного интерфейса в любом месте объединенной сети (вверх или вниз или вниз).   
__|__
--|--
|
up) forces every router to run SPF again!|up) заставляет каждый маршрутизатор снова запускать SPF!
|
The solution is to take the one large LSDB and break it into several smaller LSDBs by using OSPF areas.|Решение состоит в том, чтобы взять одну большую LSDB и разбить ее на несколько меньших LSDB, используя области OSPF.
With areas, each link is placed into one area.|В областях каждая ссылка помещается в одну область.
SPF does its complicated math on the topology inside the area, and that area’s topology only.|SPF выполняет сложные математические операции с топологией внутри области, и только с топологией этой области.
For instance, an internetwork with 1000 routers and 2000 subnets, broken in 100 areas, would average 10 routers and 20 subnets per area.|Например, объединенная сеть с 1000 маршрутизаторами и 2000 подсетями, разбитыми на 100 областей, будет в среднем 10 маршрутизаторов и 20 подсетей на область.
The SPF calculation on a router would have to only process topology about 10 routers and 20 links, rather than 1000 routers and 2000 links.|Расчет SPF на маршрутизаторе должен обрабатывать только топологию около 10 маршрутизаторов и 20 каналов, а не 1000 маршрутизаторов и 2000 каналов.
|
So, how large does a network have to be before OSPF needs to use areas?|Итак, насколько большой должна быть сеть, чтобы OSPF мог использовать области?
Well, there is no set answer because the behavior of the SPF process depends largely on CPU processing speed, the amount of RAM, the size of the LSDB, and so on.|Что ж, однозначного ответа нет, потому что поведение процесса SPF во многом зависит от скорости обработки процессора, объема оперативной памяти, размера LSDB и так далее.
Generally, networks larger than a few dozen routers benefit from areas, and some documents over the years have listed 50 routers as the dividing line at which a network really should use multiple OSPF areas.|Как правило, сети размером более нескольких десятков маршрутизаторов получают выгоду от зон, и в некоторых документах за эти годы 50 маршрутизаторов указаны как разделительная линия, на которой сеть действительно должна использовать несколько зон OSPF.
|
The next few pages look at how OSPF area design works, with more reasons as to why areas help make larger OSPF networks work better.|На следующих нескольких страницах рассматривается, как работает дизайн области OSPF, и приводится больше причин, почему области помогают улучшить работу более крупных сетей OSPF.
#### OSPF Areas
Области OSPF   
__|__
--|--
|
OSPF area design follows a couple of basic rules.|Дизайн зоны OSPF следует нескольким основным правилам.
To apply the rules, start with a clean drawing of the internetwork, with routers, and all interfaces.|Чтобы применить правила, начните с чистого рисунка объединенной сети с маршрутизаторами и всеми интерфейсами.
Then choose the area for each router interface, as follows:|Затем выберите область для каждого интерфейса маршрутизатора, как показано ниже:
###### Put all interfaces connected to the same subnet inside the same area.
Поместите все интерфейсы, подключенные к одной подсети, в одну и ту же область.   
###### An area should be contiguous.
Область должна быть непрерывной.   
###### Some routers may be internal to an area, with all interfaces assigned to that single area.
Некоторые маршрутизаторы могут быть внутренними по отношению к области, со всеми интерфейсами, назначенными этой отдельной области.   
###### Some routers may be Area Border Routers (ABR) because some interfaces connect to the
Некоторые маршрутизаторы могут быть граничными маршрутизаторами (ABR), потому что некоторые интерфейсы подключаются к   
__|__
--|--
|
backbone area, and some connect to nonbackbone areas.|магистральная область, а некоторые подключаются к не магистральным областям.
###### All nonbackbone areas must have a path to reach the backbone area (area 0) by having at
Все неосновные области должны иметь путь для достижения магистральной области (область 0), имея на   
__|__
--|--
|
least one ABR connected to both the backbone area and the nonbackbone area.|как минимум один ABR, подключенный как к магистральной, так и к нефаговой области.
|
Figure 19-13 shows one example.|На рис. 19-13 показан один пример.
An engineer started with a network diagram that showed all 11 routers and their links.|Инженер начал с сетевой схемы, на которой были показаны все 11 маршрутизаторов и их связи.
On the left, the engineer put four WAN links and the LANs connected to branch routers B1 through B4 into area 1.|Слева инженер поместил четыре канала WAN и локальные сети, подключенные к маршрутизаторам ответвлений с B1 по B4, в область 1.
Similarly, he placed the links to branches B11 through B14 and their LANs in area 2.|Точно так же он разместил ссылки на ветки с B11 по B14 и их локальные сети в области 2.
Both areas need a connection to the backbone area, area 0, so he put the LAN interfaces of D1 and D2 into area 0, along with D3, creating the backbone area.|Обе области нуждаются в соединении с областью магистрали, областью 0, поэтому он поместил интерфейсы LAN D1 и D2 в область 0 вместе с D3, создав магистральную область.
|
The figure also shows a few important OSPF area design terms.|На рисунке также показаны некоторые важные термины проектирования области OSPF.
Table 19-7 summarizes the meaning of these terms, plus some other related terms, but pay closest attention to the terms from the figure.|Таблица 19-7 суммирует значение этих терминов, а также некоторых других связанных терминов, но обратите особое внимание на термины из рисунка.
|
Figure 19-13 Three-Area OSPF with D1 and D2 as ABRs Table 19-7 OSPF Design Terminology Table end.|Рисунок 19-13 Трехзонный OSPF с D1 и D2 в качестве ABR Таблица 19-7 Терминология проекта OSPF Конец таблицы.
#### How Areas Reduce SPF Calculation Time
Как области сокращают время расчета SPF   
__|__
--|--
|
Figure 19-13 shows a sample area design and some terminology related to areas, but it does not show the power and benefit of the areas.|На рис. 19-13 показан примерный план области и некоторая терминология, относящаяся к областям, но он не показывает силу и преимущества областей.
To understand how areas reduce the work SPF has to do, you need to understand what changes about the LSDB inside an area, as a result of the area design.|Чтобы понять, как области сокращают работу, которую должен выполнять SPF, вам необходимо понять, какие изменения в LSDB внутри области в результате дизайна области.
|
SPF spends most of its processing time working through all the topology details, namely routers and the links that connect routers.|SPF тратит большую часть времени на обработку всех деталей топологии, а именно маршрутизаторов и каналов, которые соединяют маршрутизаторы.
Areas reduce SPF’s workload because, for a given area, the LSDB lists only routers and links inside that area, as shown on the left side of Figure 19-14.|Области уменьшают рабочую нагрузку SPF, поскольку для данной области LSDB перечисляет только маршрутизаторы и ссылки внутри этой области, как показано в левой части рисунка 19-14.
|
Figure 19-14 Smaller Area 1 LSDB Concept While the LSDB has less topology information, it still has to have information about all subnets in all areas, so that each router can create IPv4 routes for all subnets.|Рис. 19-14. Меньшая область 1. Концепция LSDB. Хотя LSDB имеет меньше информации о топологии, она все же должна иметь информацию обо всех подсетях во всех областях, чтобы каждый маршрутизатор мог создавать маршруты IPv4 для всех подсетей.
So, with an area design, OSPFv2 uses very brief summary information about the subnets in other areas.|Итак, с дизайном области OSPFv2 использует очень краткую сводную информацию о подсетях в других областях.
|
These summary LSAs do not include topology information about the other areas; however, each summary LSA does list a subnet ID and mask of a subnet in some other area.|Эти сводные LSA не включают информацию о топологии других областей; однако в каждом сводном LSA перечислены идентификатор подсети и маска подсети в какой-либо другой области.
Summary LSAs do not require much SPF processing at all.|Резюме LSA вообще не требует большой обработки SPF.
Instead, these subnets all appear like subnets connected to the ABR (in Figure 19-14, ABR D1).|Вместо этого все эти подсети выглядят как подсети, подключенные к ABR (на рис. 19-14, ABR D1).
|
Using multiple areas improves OSPF operations in many ways for larger networks.|Использование нескольких областей улучшает работу OSPF во многих отношениях для больших сетей.
The following list summarizes some of the key points arguing for the use of multiple areas in larger OSPF networks:|В следующем списке приведены некоторые из ключевых аргументов в пользу использования нескольких областей в более крупных сетях OSPF:
###### Routers require fewer CPU cycles to process the smaller per-area LSDB with the SPF
Маршрутизаторам требуется меньше циклов ЦП для обработки LSDB меньшей площади с помощью SPF.   
__|__
--|--
|
algorithm, reducing CPU overhead and improving convergence time.|алгоритм, уменьшающий нагрузку на ЦП и улучшающий время сходимости.
###### The smaller per-area LSDB requires less memory.
LSDB меньшего размера требует меньше памяти.   
###### Changes in the network (for example, links failing and recovering) require SPF calculations
Изменения в сети (например, сбой и восстановление ссылок) требуют расчета SPF.   
__|__
--|--
|
only on routers in the area where the link changed state, reducing the number of routers that must rerun SPF.|только на маршрутизаторах в области, где изменилось состояние канала, уменьшая количество маршрутизаторов, которые должны повторно запустить SPF.
###### Less information must be advertised between areas, reducing the bandwidth required to
Меньше информации необходимо рекламировать между областями, что снижает пропускную способность, необходимую для   
__|__
--|--
|
send LSAs.|отправить LSA.
#### \(OSPFv2\) Link-State Advertisements
\ (OSPFv2 \) Объявления о состоянии канала   
__|__
--|--
|
Many people tend to get a little intimidated by OSPF LSAs when first learning about them.|Многие люди, как правило, немного пугаются LSA OSPF, когда впервые узнают о них.
|
Commands that list a summary of the LSDB’s contents, like the show ip ospf database command, actually list a lot of information.|Команды, которые перечисляют сводку содержимого LSDB, такие как команда show ip ospf database, на самом деле перечисляют большой объем информации.
Commands that list the details of the LSDB can list overwhelming amounts of information, and those details appear to be in some kind of code, using lots of numbers.|Команды, которые перечисляют детали LSDB, могут перечислять огромное количество информации, и эти детали кажутся в некотором виде кода с использованием большого количества чисел.
It can seem like a bit of a mess.|Это может показаться немного беспорядочным.
|
However, if you examine LSAs while thinking about OSPF areas and area design, some of the most common LSA types will make a lot more sense.|Однако, если вы исследуете LSA, размышляя об областях OSPF и дизайне областей, некоторые из наиболее распространенных типов LSA будут иметь гораздо больший смысл.
For instance, think about the LSDB in one area.|Например, подумайте о LSDB в одной области.
The topology in one area includes routers and the links between the routers.|Топология в одной области включает маршрутизаторы и связи между маршрутизаторами.
|
As it turns out, OSPF defines the first two types of LSAs to define those exact details, as follows:|Как оказалось, OSPF определяет первые два типа LSA для определения этих точных деталей следующим образом:
###### One router LSA for each router in the area
Один маршрутизатор LSA для каждого маршрутизатора в зоне   
###### One network LSA for each network that has a DR plus one neighbor of the DR
Один сетевой LSA для каждой сети, имеющей DR, плюс один сосед DR   
__|__
--|--
|
Next, think about the subnets in the other areas.|Затем подумайте о подсетях в других областях.
The ABR creates summary information about each subnet in one area to advertise into other areas—basically just the subnet IDs and masks—as a third type of LSA:|ABR создает сводную информацию о каждой подсети в одной области для рекламы в других областях - в основном только идентификаторы и маски подсети - в качестве третьего типа LSA:
###### One summary LSA for each subnet ID that exists in a different area
Один сводный LSA для каждого идентификатора подсети, который существует в другой области   
__|__
--|--
|
The next few pages discuss these three LSA types in a little more detail; Table 19-8 lists some information about all three for easier reference and study.|На следующих нескольких страницах эти три типа LSA рассматриваются более подробно; В Таблице 19-8 приведена некоторая информация обо всех трех для более удобного использования и изучения.
|
Table 19-8 The Three OSPFv2 LSA Types Seen with a Multiarea OSPF Design Table end.|Таблица 19-8 Три типа LSA OSPFv2, рассматриваемые в конце таблицы проектирования OSPF для нескольких областей.
##### Router LSAs Build Most of the Intra-Area Topology
Маршрутизаторы LSA создают большую часть внутризональной топологии   
__|__
--|--
|
OSPF needs very detailed topology information inside each area.|OSPF требуется очень подробная информация о топологии внутри каждой области.
The routers inside area X need to know all the details about the topology inside area X.|Маршрутизаторы внутри области X должны знать все подробности о топологии внутри области X.
And the mechanism to give routers all these details is for the routers to create and flood router (Type 1) and network (Type 2) LSAs about the routers and links in the area.|И механизм предоставления маршрутизаторам всех этих деталей заключается в том, чтобы маршрутизаторы создавали и лавинно рассылали LSA маршрутизатора (Тип 1) и сети (Тип 2) о маршрутизаторах и каналах в области.
|
Router LSAs, also known as Type 1 LSAs, describe the router in detail.|LSA маршрутизатора, также известные как LSA типа 1, подробно описывают маршрутизатор.
Each lists a router’s RID, its interfaces, its IPv4 addresses and masks, its interface state, and notes about what neighbors the router knows about via each of its interfaces.|В каждом из них указан RID маршрутизатора, его интерфейсы, его IPv4-адреса и маски, состояние его интерфейса и примечания о том, о каких соседях маршрутизатор знает через каждый из его интерфейсов.
|
To see a specific instance, first review Figure 19-15.|Чтобы увидеть конкретный экземпляр, сначала просмотрите рис. 19-15.
It lists internetwork topology, with subnets listed.|Он перечисляет топологию межсетевого взаимодействия с перечисленными подсетями.
Because it’s a small internetwork, the engineer chose a single-area design, with all interfaces in backbone area 0.|Поскольку это небольшая объединенная сеть, инженер выбрал дизайн с одной областью, со всеми интерфейсами в области 0 магистрали.
|
With the single-area design planned for this small internetwork, the LSDB will contain four router LSAs. Each router creates a router LSA for itself, with its own RID as the LSA identifier.|Поскольку для этой небольшой объединенной сети запланирована конструкция с одной областью, LSDB будет содержать четыре маршрутизатора LSA. Каждый маршрутизатор создает для себя LSA маршрутизатора со своим собственным RID в качестве идентификатора LSA.
|
The LSA lists that router’s own interfaces, IP address/mask, with pointers to neighbors.|В LSA перечислены собственные интерфейсы этого маршрутизатора, IP-адрес / маска с указателями на соседей.
|
Figure 19-15 Enterprise Network with Seven IPv4 Subnets Once all four routers have copies of all four router LSAs, SPF can mathematically analyze the LSAs to create a model.|Рис. 19-15. Корпоративная сеть с семью подсетями IPv4 После того, как все четыре маршрутизатора будут иметь копии всех четырех LSA маршрутизатора, SPF может математически проанализировать LSA для создания модели.
The model looks a lot like the concept drawing in Figure 19-16.|Модель очень похожа на концептуальный рисунок на рис. 19-16.
|
Note that the drawing shows each router with an obvious RID value.|Обратите внимание, что на рисунке показан каждый маршрутизатор с очевидным значением RID.
Each router has pointers that represent each of its interfaces, and because the LSAs identify neighbors, SPF can figure out which interfaces connect to which other routers.|У каждого маршрутизатора есть указатели, представляющие каждый из его интерфейсов, и поскольку LSA идентифицируют соседей, SPF может определить, какие интерфейсы подключаются к каким другим маршрутизаторам.
|
Figure 19-16 Type 1 LSAs, Assuming a Single-Area Design|Рисунок 19-16 LSA типа 1 в предположении однозонной конструкции
##### Network LSAs Complete the Intra-Area Topology
Сетевые LSA завершают внутризональную топологию   
__|__
--|--
|
Whereas router LSAs define most of the intra-area topology, network LSAs define the rest.|В то время как LSA маршрутизатора определяют большую часть внутренней топологии, сетевые LSA определяют все остальное.
|
As it turns out, when OSPF elects a DR on some subnet and that DR has at least one neighbor, OSPF treats that subnet as another node in its mathematical model of the network.|Оказывается, когда OSPF выбирает DR в некоторой подсети и у этого DR есть хотя бы один сосед, OSPF рассматривает эту подсеть как другой узел в своей математической модели сети.
To represent that network, the DR creates and floods a network (Type 2) LSA for that network (subnet).|Чтобы представить эту сеть, DR создает и лавинно рассылает LSA сети (Тип 2) для этой сети (подсети).
|
For instance, back in Figure 19-15, one Ethernet LAN and two Ethernet WANs exist.|Например, на рис. 19-15, существуют одна локальная сеть Ethernet и две глобальные сети Ethernet.
The Ethernet LAN between R2 and R3 will elect a DR, and the two routers will become neighbors;|Локальная сеть Ethernet между R2 и R3 выберет DR, и два маршрутизатора станут соседями;
|
so, whichever router is the DR will create a network LSA. Similarly, R1 and R2 connect with an Ethernet WAN, so the DR on that link will create a network LSA. Likewise, the DR on the Ethernet WAN link between R1 and R3 will also create a network LSA.|Итак, какой бы маршрутизатор ни был DR, создаст сетевой LSA. Точно так же R1 и R2 подключаются к сети Ethernet WAN, поэтому DR на этом канале создает сетевой LSA. Аналогично, DR на канале Ethernet WAN между R1 и R3 также создаст сетевой LSA.
|
Figure 19-17 shows the completed version of the intra-area LSAs in area 0 with this design.|На рис. 19-17 показана завершенная версия внутризональных LSA в области 0 с этой схемой.
|
Note that the router LSAs actually point to the network LSAs when they exist, which lets the SPF processes connect the pieces together.|Обратите внимание, что LSA маршрутизатора фактически указывают на сетевые LSA, когда они существуют, что позволяет процессам SPF соединять части вместе.
|
Figure 19-17 Type 1 and Type 2 LSAs in Area 0, Assuming a Single-Area Design Finally, note that in this single-area design example no summary (Type 3) LSAs exist at all.|Рис. 19-17. LSA типа 1 и типа 2 в области 0, в предположении, что это проект с одной областью. Наконец, обратите внимание, что в этом примере проекта с одной областью нет сводных LSA (тип 3) вообще.
|
These LSAs represent subnets in other areas, and there are no other areas.|Эти LSA представляют подсети в других областях, других областей нет.
Given that the CCNA 200-301 exam topics refer specifically to single-area OSPF designs, this section stops at showing the details of the intra-area LSAs (Types 1 and 2).|Учитывая, что темы экзамена CCNA 200-301 относятся конкретно к проектам OSPF с одной областью, в этом разделе останавливается внимание на деталях внутриобластных LSA (типы 1 и 2).
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 19-9 outlines the key review elements and where you can find them.|В Таблице 19-9 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 19-9 Chapter Review Tracking Table end.|Таблица 19-9 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Key Terms You Should Know convergence, Shortest Path First (SPF) algorithm, distance vector, Interior Gateway Protocol (IGP), link-state, link-state advertisement (LSA), link-state database (LSDB), metric, 2-way state, full state, Area Border Router (ABR), designated router (DR), backup designated router (BDR), fully adjacent, Hello Interval, Dead Interval, link-state update, neighbor, router ID (RID), topology database, internal router, backbone area|Ознакомьтесь со всеми ключевыми темами. Ключевые термины, которые вы должны знать, сходимость, алгоритм кратчайшего пути (SPF), вектор расстояния, протокол внутреннего шлюза (IGP), состояние канала, объявление о состоянии канала (LSA), база данных состояния канала (LSDB), метрика, двустороннее состояние, полное состояние, граничный маршрутизатор (ABR), назначенный маршрутизатор (DR), резервный назначенный маршрутизатор (BDR), полностью смежный, интервал приветствия, интервал бездействия, обновление состояния канала, сосед, идентификатор маршрутизатора (RID ), база данных топологии, внутренний маршрутизатор, магистраль
### Chapter 20 Implementing OSPF
Глава 20 Реализация OSPF   
__|__
--|--
|
This chapter covers the following exam topics:|В этой главе рассматриваются следующие экзаменационные темы:
###### 3.0 IP Connectivity
3.0 IP-подключение   
###### 3.2 Determine how a router makes a forwarding decision by default
3.2 Определите, как маршрутизатор принимает решение о пересылке по умолчанию   
###### 3.2.b Administrative distance
3.2.b Административная дистанция   
###### 3.2.c Routing protocol metric
3.2.c Метрика протокола маршрутизации   
###### 3.4 Configure and verify single area OSPFv2
3.4 Настройка и проверка OSPFv2 для одной области   
###### 3.4.a Neighbor adjacencies
3.4.a Соседние окрестности   
###### 3.4.b Point-to-point
3.4.b Точка-точка   
###### 3.4.c Broadcast (DR/BR selection)
3.4.c Трансляция (выбор DR / BR)   
###### 3.4.d Router ID
3.4.d Идентификатор маршрутизатора   
__|__
--|--
|
OSPFv2 requires only a few configuration commands if you rely on default settings.|OSPFv2 требует всего нескольких команд конфигурации, если вы полагаетесь на настройки по умолчанию.
To use OSPF, all you need to do is enable OSPF on each interface you intend to use in the network, and OSPF uses messages to discover neighbors and learn routes through those neighbors.|Чтобы использовать OSPF, все, что вам нужно сделать, это включить OSPF на каждом интерфейсе, который вы собираетесь использовать в сети, и OSPF использует сообщения для обнаружения соседей и изучения маршрутов через этих соседей.
|
However, the complexity of OSPFv2 results in a large number of show commands, many of which reveal those default settings.|Однако сложность OSPFv2 приводит к большому количеству команд show, многие из которых показывают эти настройки по умолчанию.
So while you can make OSPFv2 work in a lab with all default settings, to become comfortable working with it, you need to know the most common optional features as well.|Таким образом, хотя вы можете заставить OSPFv2 работать в лаборатории со всеми настройками по умолчанию, чтобы вам было комфортно работать с ним, вам также необходимо знать наиболее распространенные дополнительные функции.
This chapter begins that process.|Эта глава начинает этот процесс.
|
The first major section of this chapter focuses on traditional OSPFv2 configuration using the network command, along with the large variety of associated show commands.|Первый основной раздел этой главы посвящен традиционной настройке OSPFv2 с использованием команды network, а также большому разнообразию связанных команд show.
This section teaches you how to make OSPFv2 operate with default settings and convince yourself that it really is working through use of those show commands.|В этом разделе вы узнаете, как заставить OSPFv2 работать с настройками по умолчанию и убедить себя, что он действительно работает, с помощью этих команд show.
|
The second major section shows an alternative configuration option called OSPF interface mode, in contrast with the traditional OSPF configuration shown in the first section of the chapter.|Во втором основном разделе показан альтернативный вариант конфигурации, называемый режимом интерфейса OSPF, в отличие от традиционной конфигурации OSPF, показанной в первом разделе главы.
This mode uses the ip ospf process-id area area-number configuration command instead of the network command.|В этом режиме вместо сетевой команды используется команда настройки ip ospf process-id area area-number.
|
The final section then moves on to discuss a variety of optional but popular configuration topics.|В последнем разделе мы переходим к обсуждению множества необязательных, но популярных тем конфигурации.
The features include topics such as how to use passive interfaces, how to change OSPF costs (which influences the routes OSPF chooses), and how to create a default route advertised by OSPF.|Функции включают в себя такие темы, как использование пассивных интерфейсов, как изменить стоимость OSPF (которая влияет на маршруты, выбираемые OSPF) и как создать маршрут по умолчанию, объявленный OSPF.
|
CHAPTER 20|ГЛАВА 20
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
Table 20-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|Таблица 20-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
#### Implementing Single-Area OSPFv2
Внедрение OSPFv2 с одной областью   
__|__
--|--
|
OSPFv2 Interface Configuration 4 Additional OSPFv2 Features 5, 6 1.|Конфигурация интерфейса OSPFv2 4 Дополнительные функции OSPFv2 5, 6 1.
Which of the following network commands, following the command router ospf 1, tells this router to start using OSPF on interfaces whose IP addresses are 10.1.1.1,|Какая из следующих сетевых команд после команды router ospf 1 указывает этому маршрутизатору начать использование OSPF на интерфейсах с IP-адресами 10.1.1.1,
###### 10.1.100.1, and 10.1.120.1?
10.1.100.1 и 10.1.120.1?   
__|__
--|--
|
a. network 10.0.0.0 255.0.0.0 area 0 b. network 10.0.0.0 0.255.255.255 area 0 c. network 10.0.0.1 0.0.0.255 area 0 d. network 10.0.0.1 0.0.255.255 area 0 2.|а. сеть 10.0.0.0 255.0.0.0 область 0 б. сеть 10.0.0.0 0.255.255.255 область 0 c. сеть 10.0.0.1 0.0.0.255 область 0 d. сеть 10.0.0.1 0.0.255.255 область 0 2.
Which of the following network commands, following the command router ospf 1, tells this router to start using OSPF on interfaces whose IP addresses are 10.1.1.1,|Какая из следующих сетевых команд после команды router ospf 1 указывает этому маршрутизатору начать использование OSPF на интерфейсах с IP-адресами 10.1.1.1,
###### 10.1.100.1, and 10.1.120.1?
10.1.100.1 и 10.1.120.1?   
__|__
--|--
|
a. network 10.1.0.0 0.0.255.255 area 0 b. network 10.0.0.0 0.255.255.0 area 0 c. network 10.1.1.0 0.x.1x.0 area 0 d. network 10.1.1.0 255.0.0.0 area 0 e. network 10.0.0.0 255.0.0.0 area 0 3.|а. сеть 10.1.0.0 0.0.255.255 область 0 б. сеть 10.0.0.0 0.255.255.0 область 0 c. сеть 10.1.1.0 0.x.1x.0 область 0 d. сеть 10.1.1.0 255.0.0.0 область 0 e. сеть 10.0.0.0 255.0.0.0 область 0 3.
Which of the following commands list the OSPF neighbors off interface serial 0/0?|Какая из следующих команд перечисляет соседей OSPF за пределами последовательного интерфейса 0/0?
|
(Choose two answers.)|(Выберите два ответа.)
|
a. show ip ospf neighbor b. show ip ospf interface brief c. show ip neighbor d. show ip interface e. show ip ospf neighbor serial 0/0 4.|а. показать ip ospf соседа b. показать краткое описание интерфейса ip ospf c. показать IP соседа d. показать IP-интерфейс e. показать ip ospf neighbour serial 0/04.
An engineer migrates from a more traditional OSPFv2 configuration that uses network commands in OSPF configuration mode to instead use OSPFv2 interface configuration.|Инженер переходит с более традиционной конфигурации OSPFv2, которая использует сетевые команды в режиме конфигурации OSPF, на конфигурацию интерфейса OSPFv2.
|
Which of the following commands configures the area number assigned to an interface in this new configuration?|Какая из следующих команд настраивает номер области, назначенный интерфейсу в этой новой конфигурации?
|
a. The area command in interface configuration mode b.|а. Команда area в режиме настройки интерфейса b.
The ip ospf command in interface configuration mode c.|Команда ip ospf в режиме настройки интерфейса c.
The router ospf command in interface configuration mode d.|Команда router ospf в режиме настройки интерфейса d.
The network command in interface configuration mode 5.|Сетевая команда в режиме настройки интерфейса 5.
Which of the following configuration settings on a router does not influence which IPv4 route a router chooses to add to its IPv4 routing table when using OSPFv2?|Какой из следующих параметров конфигурации на маршрутизаторе не влияет на то, какой маршрут IPv4 маршрутизатор выбирает для добавления в свою таблицу маршрутизации IPv4 при использовании OSPFv2?
|
a. auto-cost reference-bandwidth b. delay c. bandwidth d. ip ospf cost 6.|а. эталонная пропускная способность авто-стоимости b. задержка c. пропускная способность d. ip ospf стоимость 6.
OSPF interface configuration uses the ip ospf process-id area area-number configuration command.|Для настройки интерфейса OSPF используется команда настройки ip ospf process-id area area number.
In which modes do you configure the following settings when using this command?|В каких режимах вы настраиваете следующие параметры при использовании этой команды?
|
a. The router ID is configured explicitly in router mode.|а. Идентификатор маршрутизатора явно настроен в режиме маршрутизатора.
|
b. The router ID is configured explicitly in interface mode.|б. Идентификатор маршрутизатора явно настроен в режиме интерфейса.
|
c. An interface’s area number is configured in router mode.|c. Номер зоны интерфейса настраивается в режиме маршрутизатора.
|
d. An interface’s area number is configured in interface mode.|d. Номер области интерфейса настраивается в режиме интерфейса.
|
Foundation Topics Implementing Single-Area OSPFv2 After an OSPF design has been chosen—a task that can be complex in larger IP internetworks—|Основные темы Реализация OSPFv2 с одной областью После того, как была выбрана структура OSPF - задача, которая может быть сложной в больших объединенных IP-сетях -
|
the configuration can be as simple as enabling OSPF on each router interface and placing that interface in the correct OSPF area.|конфигурация может быть столь же простой, как включение OSPF на каждом интерфейсе маршрутизатора и размещение этого интерфейса в правильной области OSPF.
This first major section of the chapter focuses on the required configuration using the traditional OSPFv2 network command along with one optional configuration setting: how to set the OSPF router-id.|Этот первый основной раздел главы посвящен требуемой конфигурации с использованием традиционной сетевой команды OSPFv2 вместе с одним дополнительным параметром конфигурации: как установить идентификатор маршрутизатора OSPF.
Additionally, this section works through how to show the various lists and tables that confirm how OSPF is working.|Кроме того, в этом разделе рассказывается, как отображать различные списки и таблицы, подтверждающие работу OSPF.
|
For reference and study, the following list outlines the configuration steps covered in this first major section of the chapter:|Для справки и изучения в следующем списке представлены шаги настройки, описанные в этом первом основном разделе главы:
|
Step 1.|Шаг 1.
Use the router ospf process-id global command to enter OSPF configuration mode for a particular OSPF process.|Используйте глобальную команду router ospf process-id, чтобы войти в режим конфигурации OSPF для определенного процесса OSPF.
|
Step 2. (Optional) Configure the OSPF router ID by doing the following:|Шаг 2. (Необязательно) Настройте идентификатор маршрутизатора OSPF, выполнив следующие действия:
|
A. Use the router-id id-value router subcommand to define the router ID, or B.|A. Используйте подкоманду router-id id-value router для определения идентификатора маршрутизатора, или B.
Use the interface loopback number global command, along with an ip address address mask command, to configure an IP address on a loopback interface (chooses the highest IP address of all working loopbacks), or Config Checklist C.|Используйте глобальную команду interface loopback number вместе с командой маски адреса ip-адреса, чтобы настроить IP-адрес на интерфейсе обратной связи (выбирает самый высокий IP-адрес из всех рабочих петель) или контрольный список конфигурации C.
Rely on an interface IP address (chooses the highest IP address of all working nonloopbacks).|Полагаться на IP-адрес интерфейса (выбирает наивысший IP-адрес из всех работающих без петель).
|
Step 3.|Шаг 3.
Use one or more network ip-address wildcard-mask area area-id router subcommands to enable OSPFv2 on any interfaces matched by the configured address and mask, enabling OSPF on the interface for the listed area.|Используйте одну или несколько подкоманд маршрутизатора области подстановочной маски сетевого IP-адреса и идентификатора области, чтобы включить OSPFv2 на любых интерфейсах, соответствующих настроенному адресу и маске, включив OSPF на интерфейсе для указанной области.
|
Figure 20-1 shows the relationship between the OSPF configuration commands, with the idea that the configuration creates a routing process in one part of the configuration, and then indirectly enables OSPF on each interface.|На рис. 20-1 показана взаимосвязь между командами конфигурации OSPF. Идея состоит в том, что конфигурация создает процесс маршрутизации в одной части конфигурации, а затем косвенно включает OSPF на каждом интерфейсе.
The configuration does not name the interfaces on which OSPF is enabled, instead requiring IOS to apply some logic by comparing the OSPF network command to the interface ip address commands.|Конфигурация не называет интерфейсы, на которых включен OSPF, вместо этого требует, чтобы IOS применила некоторую логику, сравнивая сетевую команду OSPF с командами IP-адреса интерфейса.
The upcoming example discusses more about this logic.|В следующем примере эта логика обсуждается подробнее.
|
Figure 20-1 Organization of OSPFv2 Configuration with the network Command|Рисунок 20-1 Организация конфигурации OSPFv2 с помощью сетевой команды
#### OSPF Single-Area Configuration
Конфигурация OSPF с одной областью   
__|__
--|--
|
Figure 20-2 shows a sample network that will be used for most examples throughout this chapter.|На рисунке 20-2 показан пример сети, которая будет использоваться в большинстве примеров в этой главе.
All links reside in area 0, making the area design a single-area design, with four routers.|Все ссылки находятся в области 0, что делает дизайн области однозонным с четырьмя маршрутизаторами.
|
You can think of Router R1 as a router at a central site, with WAN links to each remote site, and using router-on-a-stick (ROAS) to connect to two LAN subnets on the left.|Вы можете думать о маршрутизаторе R1 как о маршрутизаторе на центральном узле, со связями WAN с каждым удаленным узлом и использованием маршрутизатора на палке (ROAS) для подключения к двум подсетям LAN слева.
Routers R2 and R3 might be at one large remote site that needs two WAN links and two routers for WAN redundancy, with both routers connected to the LAN at that remote site.|Маршрутизаторы R2 и R3 могут находиться на одном большом удаленном сайте, которому требуются два канала WAN и два маршрутизатора для резервирования WAN, причем оба маршрутизатора подключены к локальной сети на этом удаленном сайте.
Router R4 might be a typical smaller remote site with a single router needed for that site.|Маршрутизатор R4 может быть типичным меньшим удаленным узлом с одним маршрутизатором, необходимым для этого узла.
|
NOTE The interface numbering on Router R1, with interfaces G0/0 and G0/0/0, may seem a bit strange.|ПРИМЕЧАНИЕ. Нумерация интерфейсов на маршрутизаторе R1 с интерфейсами G0 / 0 и G0 / 0/0 может показаться немного странной.
However, real routers, like the Cisco 2901 used in the example, use this numbering.|Однако настоящие маршрутизаторы, такие как Cisco 2901, использованные в примере, используют эту нумерацию.
|
That model includes a built-in Gi0/0 and Gi0/1 port.|Эта модель включает встроенный порт Gi0 / 0 и Gi0 / 1.
Additionally, if you add one-port Gigabit WAN Interface Cards (WICs), the router numbers them G0/0/0, G0/1/0, and so on.|Кроме того, если вы добавляете однопортовые интерфейсные карты Gigabit WAN (WIC), маршрутизатор пронумеровывает их G0 / 0/0, G0 / 1/0 и так далее.
|
This is just one example of how router hardware may use two-digit interface numbering, or three-digit, or both.|Это всего лишь один пример того, как оборудование маршрутизатора может использовать двузначную или трехзначную нумерацию интерфейсов, или и то, и другое.
|
Figure 20-2 Sample Network for OSPF Single-Area Configuration Example 20-1 shows the IPv4 addressing configuration on Router R1, before getting into the OSPF detail.|Рис. 20-2. Пример сети для однозональной конфигурации OSPF. В примере 20-1 показана конфигурация адресации IPv4 на маршрутизаторе R1, прежде чем перейти к деталям OSPF.
Note that R1 enables 802.1Q trunking (ROAS) on its G0/0 interface and assigns an IP address to each subinterface.|Обратите внимание, что R1 включает транкинг 802.1Q (ROAS) на своем интерфейсе G0 / 0 и назначает IP-адрес каждому подинтерфейсу.
|
Example 20-1 IPv4 Address Configuration on R1 (Including VLAN Trunking)|Пример 20-1 Конфигурация IPv4-адреса на маршрутизаторе R1 (включая транкинг VLAN)
|
Example end.|Пример конец.
|
The OSPF configuration begins with the router ospf process-id global command, which puts the user in OSPF configuration mode, and sets the OSPF process-id value.|Конфигурация OSPF начинается с глобальной команды router ospf process-id, которая переводит пользователя в режим конфигурации OSPF и устанавливает значение идентификатора процесса OSPF.
The process-id number just needs to be unique on the local router, allowing the router to support multiple OSPF processes in a single router by using different process IDs. (The Answers to the “Do I Know This Already?” quiz:|Просто номер идентификатора процесса должен быть уникальным на локальном маршрутизаторе, что позволяет маршрутизатору поддерживать несколько процессов OSPF в одном маршрутизаторе с использованием разных идентификаторов процессов. (Ответы на викторину «Знаю ли я это уже?»:
|
1 B 2 A 3 A, E 4 B 5 B 6 A, D router command uses the process-id to distinguish between the processes.) The process-id does not have to match on each router, and it can be any integer between 1 and 65,535.|1 B 2 A 3 A, E 4 B 5 B 6 Команда маршрутизатора A, D использует идентификатор процесса, чтобы различать процессы.) Идентификатор процесса не обязательно должен совпадать на каждом маршрутизаторе, и он может быть любым целым числом между 1 и 65 535.
|
Second, the configuration needs one or more network commands in OSPF mode.|Во-вторых, для конфигурации требуется одна или несколько сетевых команд в режиме OSPF.
These commands tell the router to find its local interfaces that match the first two parameters on the network command.|Эти команды говорят маршрутизатору найти его локальные интерфейсы, соответствующие первым двум параметрам сетевой команды.
Then, for each matched interface, the router enables OSPF on those interfaces, discovers neighbors, creates neighbor relationships, and assigns the interface to the area listed in the network command. (Note that the area can be configured as either an integer or a dotted-decimal number, but this book makes a habit of configuring the area number as an integer.|Затем для каждого согласованного интерфейса маршрутизатор включает OSPF на этих интерфейсах, обнаруживает соседей, создает отношения соседей и назначает интерфейс области, указанной в сетевой команде. (Обратите внимание, что площадь может быть сконфигурирована как целое число или десятичное число с точками, но в этой книге есть привычка настраивать номер области как целое число.
The integer area numbers range from 0 through 4,294,967,295.)|Целые числа области находятся в диапазоне от 0 до 4294967295.)
|
Example 20-2 shows an example configuration on router R2 from Figure 20-2.|В примере 20-2 показан пример конфигурации маршрутизатора R2 с рисунка 20-2.
The router ospf 1 command enables OSPF process 1, and the single network command enables OSPF on all interfaces shown in the figure.|Команда router ospf 1 включает процесс OSPF 1, а одиночная сетевая команда включает OSPF на всех интерфейсах, показанных на рисунке.
|
Example 20-2 OSPF Single-Area Configuration on R2 Using One network Command Example end.|Пример 20-2 Конфигурация OSPF с одной областью на R2 с использованием одной сетевой команды Пример end.
|
For the specific network command in Example 20-2, any matched interfaces are assigned to area 0.|Для конкретной сетевой команды в примере 20-2 любые согласованные интерфейсы назначаются области 0.
However, the first two parameters—the ip_address and wildcard_mask parameter values of 10.0.0.0 and 0.255.255.255—need some explaining.|Однако первые два параметра - значения параметров ip_address и wildcard_mask 10.0.0.0 и 0.255.255.255 - нуждаются в пояснении.
In this case, the command matches both interfaces shown for Router R2; the next topic explains why.|В этом случае команда соответствует обоим интерфейсам, показанным для маршрутизатора R2; в следующей теме объясняется, почему.
#### Wildcard Matching with the network Command
Сопоставление подстановочных знаков с сетевой командой   
__|__
--|--
|
The key to understanding the traditional OSPFv2 configuration shown in this first example is to understand the OSPF network command.|Ключом к пониманию традиционной конфигурации OSPFv2, показанной в этом первом примере, является понимание сетевой команды OSPF.
The OSPF network command compares the first parameter in the command to each interface IP address on the local router, trying to find a match.|Сетевая команда OSPF сравнивает первый параметр в команде с IP-адресом каждого интерфейса на локальном маршрутизаторе, пытаясь найти совпадение.
However, rather than comparing the entire number in the network command to the entire IPv4 address on the interface, the router can compare a subset of the octets, based on the wildcard mask, as follows:|Однако вместо того, чтобы сравнивать весь номер в сетевой команде со всем IPv4-адресом на интерфейсе, маршрутизатор может сравнить подмножество октетов на основе маски с подстановочными знаками следующим образом:
|
Wildcard 0.0.0.0: Compare all four octets.|Подстановочный знак 0.0.0.0: сравнить все четыре октета.
In other words, the numbers must exactly match.|Другими словами, числа должны точно совпадать.
|
Wildcard 0.0.0.255: Compare the first three octets only.|Подстановочный знак 0.0.0.255: Сравните только первые три октета.
Ignore the last octet when comparing the numbers.|При сравнении чисел игнорируйте последний октет.
|
Wildcard 0.0.255.255: Compare the first two octets only.|Подстановочный знак 0.0.255.255: Сравните только первые два октета.
Ignore the last two octets when comparing the numbers.|При сравнении чисел игнорируйте два последних октета.
|
Wildcard 0.255.255.255: Compare the first octet only.|Подстановочный знак 0.255.255.255: Сравните только первый октет.
Ignore the last three octets when comparing the numbers.|При сравнении чисел игнорируйте последние три октета.
|
Wildcard 255.255.255.255: Compare nothing; this wildcard mask means that all addresses will match the network command.|Подстановочный знак 255.255.255.255: ничего не сравнивать; эта подстановочная маска означает, что все адреса будут соответствовать сетевой команде.
|
Basically, a wildcard mask value of decimal 0 in an octet tells IOS to compare to see if the numbers match, and a value of 255 tells IOS to ignore that octet when comparing the numbers.|По сути, значение маски подстановочного знака десятичного 0 в октете сообщает IOS о необходимости сравнения, чтобы увидеть, совпадают ли числа, а значение 255 указывает IOS игнорировать этот октет при сравнении чисел.
|
The network command provides many flexible options because of the wildcard mask.|Команда network предоставляет множество гибких опций из-за подстановочной маски.
|
For example, in Router R1, many network commands could be used, with some matching all interfaces, and some matching a subset of interfaces.|Например, в маршрутизаторе R1 можно использовать множество сетевых команд, некоторые из которых соответствуют всем интерфейсам, а некоторые - подмножеству интерфейсов.
Table 20-2 shows a sampling of options, with notes.|В Таблице 20-2 показаны некоторые варианты с примечаниями.
|
Table 20-2 Example OSPF network Commands on R3, with Expected Results Table end.|Таблица 20-2. Пример сетевых команд OSPF на маршрутизаторе R3 с концом таблицы ожидаемых результатов.
|
The wildcard mask gives the local router its rules for matching its own interfaces.|Подстановочная маска дает локальному маршрутизатору правила сопоставления его собственных интерфейсов.
To show examples of the different options, Example 20-3 shows the configuration on routers R2, R3, and R4, each using different wildcard masks.|Чтобы показать примеры различных опций, в примере 20-3 показана конфигурация маршрутизаторов R2, R3 и R4, каждый из которых использует разные маски подстановки.
Note that all three routers (R2, R3, and R4)|Обратите внимание, что все три маршрутизатора (R2, R3 и R4)
|
enable OSPF on all the interfaces shown in Figure 20-2.|включите OSPF на всех интерфейсах, показанных на рисунке 20-2.
|
Example 20-3 OSPF Configuration on Routers R2, R3, and R4 Example end.|Пример 20-3 Конфигурация OSPF на маршрутизаторах R2, R3 и R4 Конец примера.
|
Finally, note that OSPF uses the same wildcard mask logic as defined by Cisco IOS access control lists.|Наконец, обратите внимание, что OSPF использует ту же логику подстановочных масок, которая определена списками управления доступом Cisco IOS.
The section titled “Finding the Right Wildcard Mask to Match a Subnet” section detail about wildcard masks.|В разделе «Поиск правильной маски с подстановочными знаками для соответствия подсети» подробно описаны маски с подстановочными знаками.
|
NOTE IOS will change a network command if it does not follow a particular rule: by convention, if the wildcard mask octet is 255, the matching address octet should be configured as a 0.|ПРИМЕЧАНИЕ IOS изменит сетевую команду, если она не следует определенному правилу: по соглашению, если октет маски подстановки равен 255, соответствующий октет адреса должен быть настроен как 0.
Interestingly, IOS will actually accept a network command that breaks this rule, but then IOS will change that octet of the address to a 0 before putting it into the running configuration file.|Интересно, что IOS фактически примет сетевую команду, которая нарушает это правило, но затем IOS изменит этот октет адреса на 0 перед тем, как поместить его в текущий файл конфигурации.
For example, IOS will change a typed command that begins with network|Например, IOS изменит набранную команду, которая начинается с сети
###### 1.2.3.4 0.0.255.255 to network 1.2.0.0 0.0.255.255.
1.2.3.4 0.0.255.255 в сеть 1.2.0.0 0.0.255.255.   
#### Verifying OSPF Operation
Проверка работы OSPF   
__|__
--|--
|
As mentioned in Chapter 19, “Understanding OSPF Concepts,” OSPF routers use a threestep process to eventually add OSPF-learned routes to the IP routing table.|Как упоминалось в главе 19 «Понимание концепций OSPF», маршрутизаторы OSPF используют трехэтапный процесс, чтобы в конечном итоге добавить маршруты, полученные с помощью OSPF, в таблицу IP-маршрутизации.
First, they create neighbor relationships.|Во-первых, они создают отношения между соседями.
Then they build and flood LSAs between those neighbors so each router in the same area has a copy of the same LSDB. Finally, each router independently computes its own IP routes using the SPF algorithm and adds them to its routing table.|Затем они создают и рассылают LSA между этими соседями, чтобы каждый маршрутизатор в одной и той же области имел копию одного и того же LSDB. Наконец, каждый маршрутизатор независимо вычисляет свои собственные IP-маршруты с помощью алгоритма SPF и добавляет их в свою таблицу маршрутизации.
This next topic works through how to display the results of each of those steps, which lets you confirm whether OSPF has worked correctly or not.|В следующем разделе рассказывается, как отображать результаты каждого из этих шагов, что позволяет подтвердить, правильно ли работал OSPF.
|
The show ip ospf neighbor, show ip ospf database, and show ip route commands display information to match each of these three steps, respectively.|Команды show ip ospf neighbour, show ip ospf database и show ip route отображают информацию, соответствующую каждому из этих трех шагов, соответственно.
Figure 20-3 summarizes the commands you can use (and others) when verifying OSPF.|На рис. 20-3 показаны команды, которые можно использовать (и другие) при проверке OSPF.
|
Many engineers begin OSPF verification by looking at the output of the show ip ospf neighbor command.|Многие инженеры начинают проверку OSPF с вывода команды show ip ospf neighbour.
For instance, Example 20-4 shows a sample from Router R1, which should have one neighbor relationship each with routers R2, R3, and R4. Example 20-4 shows all three.|Например, в примере 20-4 показан образец от маршрутизатора R1, который должен иметь по одной взаимосвязи соседства с маршрутизаторами R2, R3 и R4. В примере 20-4 показаны все три.
|
Figure 20-3 OSPF Verification Commands Example 20-4 OSPF Neighbors on Router R1 from Figure 20-2 Example end.|Рис. 20-3. Пример команд проверки OSPF. 20-4. Соседи OSPF на маршрутизаторе R1 из рисунка 20-2. Конец примера.
|
The detail in the output mentions several important facts, and for most people, working right to left works best in this case.|Подробности в выводе упоминают несколько важных фактов, и для большинства людей в этом случае лучше всего работает справа налево.
For example, look at the headings:|Например, посмотрите заголовки:
|
Interface: This is the local router’s interface connected to the neighbor.|Интерфейс: это интерфейс локального маршрутизатора, подключенный к соседу.
For example, the first neighbor in the list is reachable through R1’s G0/0/0 interface.|Например, первый сосед в списке доступен через интерфейс G0 / 0/0 маршрутизатора R1.
|
Address: This is the neighbor’s IP address on that link.|Адрес: это IP-адрес соседа по этой ссылке.
Again, for this first neighbor, which is R1, uses IP address 10.1.13.1.|Опять же, для этого первого соседа, которым является R1, используется IP-адрес 10.1.13.1.
|
State: While many possible states exist, for the details discussed in this chapter, FULL is the correct and fully working state in this case.|Состояние: Хотя существует много возможных состояний, для деталей, обсуждаемых в этой главе, FULL является правильным и полностью рабочим состоянием в этом случае.
|
Neighbor ID: This is the router ID of the neighbor.|Neighbor ID: это идентификатор соседнего маршрутизатора.
|
Once OSPF convergence has completed, a router should list each neighbor.|По завершении конвергенции OSPF маршрутизатор должен перечислить каждого соседа.
On links that use a designated router (DR), the state will also list the role of the neighboring router after the /|На ссылках, которые используют назначенный маршрутизатор (DR), состояние также будет указывать роль соседнего маршрутизатора после /
|
(DR, BDR, or DROTHER. As a result, the normal working states will be:|(DR, BDR или DROTHER. В результате нормальные рабочие состояния будут следующими:
|
FULL/ -: The neighbor state is full, with the “-“ instead of letters meaning that the link does not use a DR/BDR.|FULL / -: соседнее состояние заполнено, с «-» вместо букв, означающих, что ссылка не использует DR / BDR.
|
FULL/DR: The neighbor state is full, and the neighbor is the DR.|FULL / DR: соседнее состояние заполнено, и соседом является DR.
|
FULL/BDR: The neighbor state is full, and the neighbor is the backup DR (BDR).|FULL / BDR: соседнее состояние заполнено, и соседом является резервный DR (BDR).
|
FULL/DROTHER: The neighbor state is full, and the neighbor is neither the DR nor BDR.|FULL / DROTHER: состояние соседа заполнено, и сосед не является ни DR, ни BDR.
|
(It also implies that the local router is a DR or BDR because the state is FULL.)|(Это также означает, что локальный маршрутизатор является DR или BDR, потому что состояние FULL.)
|
2WAY/DROTHER: The neighbor state is 2-way, and the neighbor is neither the DR nor BDR—that is, a DROther router. (It also implies that the local router is also a DROther router because otherwise the state would reach a full state.)|2WAY / DROTHER: состояние соседа является двусторонним, и сосед не является ни DR, ни BDR, то есть маршрутизатором DROther. (Это также подразумевает, что локальный маршрутизатор также является маршрутизатором DROther, потому что в противном случае состояние достигло бы полного состояния.)
|
Once a router’s OSPF process forms a working neighbor relationship, the routers exchange the contents of their LSDBs, either directly or through the DR on the subnet.|Как только процесс OSPF маршрутизатора формирует отношения рабочего соседа, маршрутизаторы обмениваются содержимым своих LSDB либо напрямую, либо через DR в подсети.
Example 20-5 shows the contents of the LSDB on Router R1. Interestingly, with a single-area design, all the routers will have the same LSDB contents once all neighbors are up and all LSAs have been exchanged.|В примере 20-5 показано содержимое LSDB на маршрутизаторе R1. Интересно отметить, что при проектировании с одной областью все маршрутизаторы будут иметь одинаковое содержимое LSDB после того, как все соседи подключены и все LSA будут обменены.
So, the show ip ospf database command in Example 20-5 should list the same exact information, no matter on which of the four routers it is issued.|Таким образом, команда show ip ospf database в примере 20-5 должна отображать одну и ту же точную информацию, независимо от того, на каком из четырех маршрутизаторов она запущена.
|
Example 20-5 OSPF Database on Router R1 from Figure 20-2 Example end.|Пример 20-5 База данных OSPF на маршрутизаторе R1 из рисунка 20-2 Пример конец.
|
For the purposes of this book, do not be concerned about the specifics in the output of this command.|Для целей этой книги не обращайте внимания на особенности вывода этой команды.
However, for perspective, note that the LSDB should list one “Router Link State”|Однако для перспективы обратите внимание, что LSDB должен указывать одно «Состояние соединения маршрутизатора».
|
(Type 1 Router LSA) for each of the routers in the same area, so with the design based on Figure 20-2, the output lists four Type 1 LSAs. Also, with all default settings in this design, the routers will create a total of four Type 2 Network LSAs as shown, one each for the subnets that have a DR and contain at least two routers in that subnet.|(LSA маршрутизатора типа 1) для каждого из маршрутизаторов в одной и той же области, поэтому при схеме, основанной на рис. 20-2, в выходных данных выводятся четыре LSA типа 1. Кроме того, со всеми настройками по умолчанию в этом проекте маршрутизаторы создадут в общей сложности четыре сетевых LSA типа 2, как показано, по одному для каждой подсети, которая имеет DR и содержит как минимум два маршрутизатора в этой подсети.
|
Next, Example 20-6 shows R4’s IPv4 routing table with the show ip route command.|Далее, в примере 20-6 показана таблица маршрутизации IPv4 маршрутизатора R4 с помощью команды show ip route.
As configured, with all links working, the design in Figure 20-2 includes seven subnets.|В соответствии с конфигурацией, когда все ссылки работают, схема на рис. 20-2 включает семь подсетей.
R4 has connected routes to two of those subnets and should learn OSPF routes to the other five subnets.|R4 подключил маршруты к двум из этих подсетей и должен изучить маршруты OSPF к другим пяти подсетям.
|
Example 20-6 IPv4 Routes Added by OSPF on Router R1 from Figure 20-2 Example end.|Пример 20-6 Маршруты IPv4, добавленные OSPF на маршрутизаторе R1 из рисунка 20-2 Пример конца.
|
Any time you want to check OSPF on a router in a small design like the ones in the book, you can count all the subnets, then count the subnets connected to the local router, and know that OSPF should learn routes to the rest of the subnets.|Каждый раз, когда вы хотите проверить OSPF на маршрутизаторе в небольшом дизайне, подобном приведенным в книге, вы можете подсчитать все подсети, затем подсчитать подсети, подключенные к локальному маршрутизатору, и знать, что OSPF должен изучить маршруты к остальной части подсети.
Then just use the show ip route command and add up how many connected and OSPF routes exist as a quick check of whether all the routes have been learned or not.|Затем просто используйте команду show ip route и сложите количество подключенных маршрутов и маршрутов OSPF, чтобы быстро проверить, все ли маршруты изучены или нет.
|
In this case, router R4 has two connected subnets, but seven subnets exist per the figure, so router R4 should learn five OSPF routes.|В этом случае маршрутизатор R4 имеет две подключенные подсети, но согласно рисунку существует семь подсетей, поэтому маршрутизатор R4 должен изучить пять маршрутов OSPF.
Next look for the code of “O” on the left, which identifies a route as being learned by OSPF. The output lists five such IP routes: two for the LAN subnets off Router R1, one for the LAN subnets connected to both R2 and R3, and one each for the WAN subnets from R1 to R2 and R1 to R3.|Затем найдите слева код «O», который указывает на то, что маршрут был изучен OSPF. В выходных данных перечислено пять таких IP-маршрутов: два для подсетей LAN от маршрутизатора R1, один для подсетей LAN, подключенных как к R2, так и к R3, и по одному для каждой подсети WAN от R1 до R2 и R1 до R3.
|
Next, take a look at the first route (to subnet 10.1.1.0/24).|Затем взгляните на первый маршрут (в подсеть 10.1.1.0/24).
It lists the subnet ID and mask, identifying the subnet.|В нем перечислены идентификатор и маска подсети, идентифицирующая подсеть.
It also lists two numbers in brackets.|В скобках также указаны два числа.
The first, 110, is the administrative distance of the route.|Первое, 110, - это административное расстояние маршрута.
All the OSPF routes in this example use the default of 110 (see Chapter 19’s Table 19-4 for the list of administrative distance values).|Все маршруты OSPF в этом примере используют значение по умолчанию 110 (список значений административного расстояния см. В таблице 19-4 главы 19).
The second number, 2, is the OSPF metric for this route.|Второе число, 2, является метрикой OSPF для этого маршрута.
The route also lists the forwarding instructions: the nexthop IP address (10.1.14.1) and R4’s outgoing interface (G0/0/0).|В маршруте также перечислены инструкции по пересылке: IP-адрес следующего перехода (10.1.14.1) и исходящий интерфейс R4 (G0 / 0/0).
#### Verifying OSPF Configuration
Проверка конфигурации OSPF   
__|__
--|--
|
Once you can configure OSPF with confidence, you will likely verify OSPF focusing on OSPF neighbors and the IP routing table as just discussed.|Как только вы сможете уверенно настроить OSPF, вы, вероятно, убедитесь, что OSPF фокусируется на соседях OSPF и таблице IP-маршрутизации, как только что обсуждалось.
However, if OSPF does not work immediately, you may need to circle back and check the configuration.|Однако, если OSPF не работает сразу, вам может потребоваться вернуться и проверить конфигурацию.
To do so, you can use these steps:|Для этого вы можете использовать следующие шаги:
###### If you have enable mode access, use the show running-config command to examine the
Если у вас есть доступ к режиму включения, используйте команду show running-config, чтобы проверить   
__|__
--|--
|
configuration.|конфигурация.
###### If you have only user mode access, use the show ip protocols command to re-create the
Если у вас есть доступ только в пользовательском режиме, используйте команду show iptocols, чтобы заново создать   
__|__
--|--
|
OSPF configuration.|Конфигурация OSPF.
###### Use the show ip ospf interface [brief] command to determine whether the router enabled
Используйте команду show ip ospf interface [short], чтобы определить, включен ли маршрутизатор.   
__|__
--|--
|
OSPF on the correct interfaces or not based on the configuration.|OSPF на правильных интерфейсах или нет, в зависимости от конфигурации.
|
NOTE The exam’s Sim and Simlet questions can restrict access to enable mode, so knowing how to extract the configuration from show commands other than show running-config can be particularly helpful for any configuration topic.|ПРИМЕЧАНИЕ Вопросы экзамена Sim и Simlet могут ограничить доступ к режиму включения, поэтому знание того, как извлечь конфигурацию из команд show, отличных от show running-config, может быть особенно полезно для любой темы конфигурации.
|
The best way to verify the configuration begins with the show running-config command, of course.|Лучший способ проверить конфигурацию, конечно же, начинается с команды show running-config.
However, the show ip protocols command repeats the details of the OSPFv2 configuration and does not require enable mode access.|Однако команда show iptocols повторяет детали конфигурации OSPFv2 и не требует доступа в режиме включения.
To see how, consider Example 20-7, which lists the output of the show ip protocols command on router R3.|Чтобы увидеть, как это сделать, рассмотрим пример 20-7, в котором перечислены выходные данные команды show iptocols на маршрутизаторе R3.
|
Example 20-7 Router R3 Configuration and the show ip protocols Command Example end.|Пример 20-7. Конфигурация маршрутизатора R3 и пример команды show iptocols end.
|
The highlighted output emphasizes some of the configuration.|Выделенный вывод подчеркивает некоторую конфигурацию.
The first highlighted line repeats the parameters on the router ospf 1 global configuration command. (The second highlighted item points out each router’s router ID, which will be discussed in the next section.)|Первая выделенная строка повторяет параметры команды глобальной конфигурации router ospf 1. (Второй выделенный элемент указывает на идентификатор каждого маршрутизатора, который будет обсуждаться в следующем разделе.)
|
The third set of highlighted lines begins with a heading of “Routing for Networks:”|Третий набор выделенных строк начинается с заголовка «Маршрутизация для сетей»:
|
followed by two lines that closely resemble the parameters on the configured network commands.|за которыми следуют две строки, которые очень похожи на параметры настроенных сетевых команд.
|
In fact, closely compare those last two highlighted lines with the network configuration commands at the top of the example, and you will see that they mirror each other, but the show command just leaves out the word network.|Фактически, внимательно сравните эти две последние выделенные строки с командами конфигурации сети в верхней части примера, и вы увидите, что они отражают друг друга, но в команде show просто отсутствует слово network.
For instance:|Например:
|
Configuration: network 10.1.13.3 0.0.0.0 area 0 Show Command: 10.1.13.3 0.0.0.0 area 0 IOS interprets the network commands to choose interfaces on which to run OSPF, so it could be that IOS chooses a different set of interfaces than you predicted.|Конфигурация: сеть 10.1.13.3 0.0.0.0 область 0 Показать команду: 10.1.13.3 0.0.0.0 область 0 IOS интерпретирует сетевые команды для выбора интерфейсов, на которых запускается OSPF, поэтому возможно, что IOS выберет другой набор интерфейсов, чем вы предсказано.
To check the list of interfaces chosen by IOS, use the show ip ospf interface brief command, which lists all interfaces that have been enabled for OSPF processing.|Чтобы проверить список интерфейсов, выбранных IOS, используйте команду show ip ospf interfacerief, в которой перечислены все интерфейсы, которые были включены для обработки OSPF.
Verifying the interfaces can be a useful step if you have issues with OSPF neighbors because OSPF must first be enabled on an interface before a router will attempt to discover neighbors on that interface.|Проверка интерфейсов может быть полезным шагом, если у вас есть проблемы с соседями OSPF, потому что OSPF сначала должен быть включен на интерфейсе, прежде чем маршрутизатор попытается обнаружить соседей на этом интерфейсе.
Example 20-8 shows a sample from Router R1.|В примере 20-8 показан образец маршрутизатора R1.
|
Example 20-8 Router R1 show ip ospf interface brief Command Example end.|Пример 20-8 Маршрутизатор R1 show ip ospf interface short Пример команды end.
|
First, consider the show ip ospf interface brief command shown here.|Сначала рассмотрим показанную здесь краткую команду show ip ospf interface.
It lists one line per interface, with the list showing all the interfaces on which OSPF has been enabled.|Он перечисляет по одной строке для каждого интерфейса со списком, показывающим все интерфейсы, на которых включен OSPF.
Each item in the list identifies the OSPF process ID (per the router ospf process-id command), the area, the interface IP address, and the number of neighbors found via each interface.|Каждый элемент в списке определяет идентификатор процесса OSPF (для команды router ospf process-id), область, IP-адрес интерфейса и количество соседей, найденных через каждый интерфейс.
|
More generally, note that the show ip ospf interface command with the brief keyword at the end lists a single line of output per interface, but the show ip ospf interface command (without the brief keyword) displays about 20 lines of output per interface, with much more information about various OSPF per-interface settings.|В более общем плане обратите внимание, что команда show ip ospf interface с ключевым словом short в конце перечисляет одну строку вывода для каждого интерфейса, но команда show ip ospf interface (без ключевого слова short) отображает около 20 строк вывода на интерфейс с гораздо больше информации о различных настройках OSPF для каждого интерфейса.
#### Configuring the OSPF Router ID
Настройка идентификатора маршрутизатора OSPF   
__|__
--|--
|
While OSPF has many other optional features, most enterprise networks that use OSPF choose to configure each router’s OSPF router ID. OSPF-speaking routers must have a router ID (RID) for proper operation.|Хотя OSPF имеет множество других дополнительных функций, большинство корпоративных сетей, использующих OSPF, выбирают для каждого маршрутизатора идентификатор маршрутизатора OSPF. Маршрутизаторы с поддержкой OSPF должны иметь идентификатор маршрутизатора (RID) для правильной работы.
By default, routers will choose an interface IP address to use as the RID. However, many network engineers prefer to choose each router’s router ID, so command output from commands like show ip ospf neighbor lists more recognizable router IDs.|По умолчанию маршрутизаторы выбирают IP-адрес интерфейса для использования в качестве RID. Однако многие сетевые инженеры предпочитают выбирать идентификатор маршрутизатора каждого маршрутизатора, поэтому в выводе команд, таких как show ip ospf neighbour, перечислены более узнаваемые идентификаторы маршрутизатора.
|
To choose its RID, a Cisco router uses the following process when the router reloads and brings up the OSPF process.|Чтобы выбрать свой RID, маршрутизатор Cisco использует следующий процесс, когда маршрутизатор перезагружается и запускает процесс OSPF.
Note that the router stops looking for a router ID to use once one of the steps identifies a value to use.|Обратите внимание, что маршрутизатор прекращает поиск идентификатора маршрутизатора для использования, как только один из шагов определяет значение для использования.
|
1. If the router-id rid OSPF subcommand is configured, this value is used as the RID.|1. Если настроена подкоманда OSPF router-id rid, это значение используется как RID.
|
2. If any loopback interfaces have an IP address configured, and the interface has an interface status of up, the router picks the highest numeric IP address among these loopback interfaces.|2. Если для каких-либо интерфейсов обратной связи настроен IP-адрес, и интерфейс имеет статус интерфейса «Вкл.», Маршрутизатор выбирает самый высокий числовой IP-адрес среди этих интерфейсов обратной связи.
|
3. The router picks the highest numeric IP address from all other interfaces whose interface status code (first status code) is up. (In other words, an interface in up/down state will be included by OSPF when choosing its router ID.)|3. Маршрутизатор выбирает самый высокий числовой IP-адрес из всех других интерфейсов, чей код состояния интерфейса (первый код состояния) установлен. (Другими словами, интерфейс в активном / неактивном состоянии будет включен OSPF при выборе его идентификатора маршрутизатора.)
|
The first and third criteria should make some sense right away: the RID is either configured or is taken from a working interface’s IP address.|Первый и третий критерии сразу должны иметь смысл: RID либо настроен, либо берется с IP-адреса рабочего интерфейса.
However, this book has not yet explained the concept of a loopback interface, as mentioned in Step 2.|Однако в этой книге еще не объясняется концепция петлевого интерфейса, упомянутая в шаге 2.
|
A loopback interface is a virtual interface that can be configured with the interface loopback interface-number command, where interface-number is an integer.|Интерфейс обратной связи - это виртуальный интерфейс, который можно настроить с помощью команды interface loopback interface-number, где interface-number является целым числом.
Loopback interfaces are always in an “up and up” state unless administratively placed in a shutdown state.|Интерфейсы обратной петли всегда находятся в состоянии «работает и работает», если административно не переведено в состояние отключения.
For example, a simple configuration of the command interface loopback 0, followed by ip address 2.2.2.2 255.255.255.0, would create a loopback interface and assign it an IP address.|Например, простая конфигурация loopback 0 командного интерфейса с последующим IP-адресом 2.2.2.2 255.255.255.0 создаст интерфейс loopback и назначит ему IP-адрес.
Because loopback interfaces do not rely on any hardware, these interfaces can be up/up whenever IOS is running, making them good interfaces on which to base an OSPF RID.|Поскольку интерфейсы обратной связи не зависят от какого-либо оборудования, эти интерфейсы могут быть включены / активированы всякий раз, когда работает IOS, что делает их хорошими интерфейсами для создания OSPF RID.
|
Example 20-9 shows the configuration that existed in Routers R1 and R2 before the creation of the show command output earlier in this chapter.|В примере 20-9 показана конфигурация, которая существовала в маршрутизаторах R1 и R2 до создания выходных данных команды show ранее в этой главе.
R1 set its router ID using the direct method, while R2 used a loopback IP address.|R1 установил свой идентификатор маршрутизатора, используя прямой метод, в то время как R2 использовал петлевой IP-адрес.
|
Example 20-9 OSPF Router ID Configuration Examples Example end.|Пример 20-9 Примеры настройки идентификатора маршрутизатора OSPF Пример конец.
|
Each router chooses its OSPF RID when OSPF is initialized, which happens when the router boots or when a CLI user stops and restarts the OSPF process (with the clear ip ospf process command).|Каждый маршрутизатор выбирает свой OSPF RID при инициализации OSPF, что происходит при загрузке маршрутизатора или когда пользователь CLI останавливает и перезапускает процесс OSPF (с помощью команды clear ip ospf process).
So, if OSPF comes up, and later the configuration changes in a way that would impact the OSPF RID, OSPF does not change the RID immediately.|Таким образом, если OSPF появится, а затем конфигурация изменится таким образом, что это повлияет на RID OSPF, OSPF не изменит RID немедленно.
Instead, IOS waits until the next time the OSPF process is restarted.|Вместо этого IOS ждет, пока в следующий раз не будет перезапущен процесс OSPF.
|
Example 20-10 shows the output of the show ip ospf command on R1, which identifies the OSPF RID used by R1.|В примере 20-10 показаны выходные данные команды show ip ospf на маршрутизаторе R1, которая определяет идентификатор RID OSPF, используемый маршрутизатором R1.
|
Example 20-10 Confirming the Current OSPF Router ID Example end.|Пример 20-10 Подтверждение текущего идентификатора маршрутизатора OSPF. Пример конец.
#### Implementing Multiarea OSPF
Реализация Multiarea OSPF   
__|__
--|--
|
Even though the current CCNA 200-301 exam blueprint mentions single-area OSPF and does not mention multiarea OSPF, you only need to learn one more idea to know how to configure multiarea OSPF. So, this chapter takes a brief page to show how.|Несмотря на то, что текущий план экзамена CCNA 200-301 упоминает OSPF для одной области и не упоминает OSPF для нескольких областей, вам нужно только изучить еще одну идею, чтобы узнать, как настроить OSPF для нескольких областей. Итак, эта глава занимает небольшую страницу, чтобы показать, как это сделать.
|
For example, consider a multiarea OSPF design as shown in Figure 20-4.|Например, рассмотрим проект OSPF с несколькими областями, как показано на рисунке 20-4.
It uses the same routers and IP addresses as shown earlier in Figure 20-2, on which all the examples in this chapter have been based so far.|Он использует те же маршрутизаторы и IP-адреса, как показано на рисунке 20-2, на котором до сих пор основывались все примеры в этой главе.
However, the design shows three areas instead of the singlearea design shown in Figure 20-2.|Однако на схеме показаны три области вместо схемы с одной областью, показанной на рисунке 20-2.
|
Figure 20-4 Area Design for an Example Multiarea OSPF Configuration Configuring the routers in a multiarea design is almost like configuring OSPFv2 for a single area.|Рис. 20-4. Проектирование области для примера конфигурации OSPF с несколькими областями. Конфигурирование маршрутизаторов в конфигурации с несколькими областями почти аналогично настройке OSPFv2 для одной области.
To configure multiarea OSPF, all you need is a valid OSPF area design (for instance, like Figure 20-4) and a configuration that places each router interface into the correct area per that design.|Для настройки OSPF с несколькими областями все, что вам нужно, - это действующая схема области OSPF (например, как на рис. 20-4) и конфигурация, которая помещает каждый интерфейс маршрутизатора в правильную область для этой схемы.
For example, both of R4’s interfaces connect to links in area 4, making R4 an internal router, so any network commands on router R4 will list area 4.|Например, оба интерфейса R4 подключаются к каналам в области 4, что делает R4 внутренним маршрутизатором, поэтому любые сетевые команды на маршрутизаторе R4 будут отображать область 4.
|
Example 20-11 shows a sample configuration for Router R1. To make the configuration clear, it uses network commands with a wildcard mask of 0.0.0.0, meaning each network command matches a single interface.|В примере 20-11 показан пример конфигурации маршрутизатора R1. Чтобы сделать конфигурацию понятной, используются сетевые команды с подстановочной маской 0.0.0.0, что означает, что каждая сетевая команда соответствует одному интерфейсу.
Each interface will be placed into either area 0, 23, or 4 to match the figure.|Каждый интерфейс будет помещен в область 0, 23 или 4, чтобы соответствовать рисунку.
|
Example 20-11 OSPF Configuration on R1, Placing Interfaces into Different Areas Example end.|Пример 20-11 Конфигурация OSPF на маршрутизаторе R1, размещение интерфейсов в разных областях Пример конец.
### Using OSPFv2 Interface Subcommands
Использование подкоманд интерфейса OSPFv2   
__|__
--|--
|
From the earliest days of OSPFv2 support in Cisco routers, the configuration used the OSPF network command as discussed in this chapter.|С самых первых дней поддержки OSPFv2 в маршрутизаторах Cisco в конфигурации использовалась сетевая команда OSPF, как описано в этой главе.
However, that configuration style can be confusing, and it does require some interpretation of the network commands and interface IP addresses to decide on which interfaces IOS will enable OSPF. As a result, Cisco added another option for OSPFv2 configuration called OSPF interface configuration.|Однако этот стиль конфигурации может сбивать с толку, и он требует некоторой интерпретации сетевых команд и IP-адресов интерфейсов, чтобы решить, какие интерфейсы IOS будет включать OSPF. В результате Cisco добавила еще один вариант конфигурации OSPFv2, называемый конфигурацией интерфейса OSPF.
|
The newer interface-style OSPF configuration still enables OSPF on interfaces, but it does so directly with the ip ospf interface subcommand instead of using the network command in router configuration mode.|Более новая конфигурация OSPF в стиле интерфейса по-прежнему включает OSPF на интерфейсах, но делает это напрямую с помощью подкоманды ip ospf interface вместо использования сетевой команды в режиме конфигурации маршрутизатора.
Basically, instead of matching interfaces with indirect logic using network commands, you directly enable OSPFv2 on interfaces by configuring an interface subcommand on each interface.|По сути, вместо сопоставления интерфейсов с косвенной логикой с помощью сетевых команд вы напрямую включаете OSPFv2 на интерфейсах, настраивая подкоманду интерфейса для каждого интерфейса.
#### OSPF Interface Configuration Example
Пример конфигурации интерфейса OSPF   
__|__
--|--
|
To show how OSPF interface configuration works, this example basically repeats the example shown earlier in the book using the traditional OSPFv2 configuration with network commands.|Чтобы показать, как работает конфигурация интерфейса OSPF, этот пример в основном повторяет пример, показанный ранее в книге, с использованием традиционной конфигурации OSPFv2 с сетевыми командами.
So, before looking at the OSPFv2 interface configuration, take a moment to look back to review traditional OSPFv2 configuration with Figure 20-2 and Examples 20-2 and 20-3.|Итак, прежде чем рассматривать конфигурацию интерфейса OSPFv2, найдите время, чтобы вернуться к традиционной конфигурации OSPFv2 с рис. 20-2 и примерами 20-2 и 20-3.
|
After reviewing the traditional configuration, consider this checklist, which details how to convert from the old-style configuration in Examples 20-2 and 20-3 to use interface configuration:|Изучив традиционную конфигурацию, рассмотрите этот контрольный список, в котором подробно описано, как преобразовать конфигурацию старого стиля в примерах 20-2 и 20-3 для использования конфигурации интерфейса:
|
Step 1.|Шаг 1.
Use the no network network-id area area-id subcommands in OSPF configuration mode to remove the network commands.|Используйте подкоманды no network network-id area area-id в режиме конфигурации OSPF, чтобы удалить сетевые команды.
|
Step 2.|Шаг 2.
Add one ip ospf process-id area area-id command in interface configuration mode under each interface on which OSPF should operate, with the correct OSPF process (process-id) and the correct OSPF area number.|Добавьте одну команду ip ospf process-id area area-id в режиме настройки интерфейса для каждого интерфейса, на котором должен работать OSPF, с правильным процессом OSPF (process-id) и правильным номером области OSPF.
|
Figure 20-5 repeats the design for both the original examples in this chapter and for this upcoming interface configuration example.|Рисунок 20-5 повторяет дизайн как для исходных примеров в этой главе, так и для этого будущего примера конфигурации интерфейса.
|
Figure 20-5 Area Design Used in the Upcoming OSPF Interface Config Example Example 20-2 shows a single network command: network 10.0.0.0 0.255.255.255 area 0.|Рис. 20-5. Структура области, используемая в следующем примере конфигурации интерфейса OSPF. В примере 20-2 показана одна сетевая команда: network 10.0.0.0 0.255.255.255 area 0.
|
Example 20-12 follows the steps in the migration checklist, beginning with the removal of the previous configuration using the no network 10.0.0.0 0.255.255.255 area 0 command.|В примере 20-12 приведены шаги из контрольного списка миграции, начиная с удаления предыдущей конфигурации с помощью команды no network 10.0.0.0 0.255.255.255 area 0.
|
The example then shows the addition of the ip ospf 1 area 0 command on each of the five interfaces on Router R1, enabling OSPF process 1 on the interface and placing each interface into area 0.|Затем в примере показано добавление команды ip ospf 1 area 0 на каждый из пяти интерфейсов маршрутизатора R1, включение процесса OSPF 1 на интерфейсе и размещение каждого интерфейса в области 0.
|
Example 20-12 OSPF Single-Area Configuration on R1 Using One network Command Example end.|Пример 20-12 Конфигурация OSPF с одной областью на маршрутизаторе R1 с использованием одной сетевой команды Пример end.
|
When reading the example, read from top to bottom, and also consider the details about the failed and recovered neighbor relationships shown in the log messages.|При чтении примера читайте сверху вниз, а также учитывайте подробности о неисправных и восстановленных взаимосвязях соседей, показанные в сообщениях журнала.
Removing the network command disabled OSPF on all interfaces on Router R1, causing all three neighbor relationships to fail.|Удаление сетевой команды отключило OSPF на всех интерфейсах маршрутизатора R1, что привело к отказу всех трех взаимосвязей между соседями.
The example then shows the addition of the ip ospf 1 area 0 command on the two LAN subinterfaces, which enables OSPF. Then the example shows the same command added to each of the WAN links in succession, and in each case, the OSPF neighbor available over that WAN link comes up (as noted in the log messages.)|Затем в примере показано добавление команды ip ospf 1 area 0 на два подинтерфейса LAN, которая включает OSPF. Затем в примере показана одна и та же команда, последовательно добавляемая к каждому из каналов WAN, и в каждом случае появляется сосед OSPF, доступный по этому каналу WAN (как указано в сообщениях журнала).
##### Verifying OSPF Interface Configuration
Проверка конфигурации интерфейса OSPF   
__|__
--|--
|
OSPF operates the same way whether you use the new style or old style of configuration.|OSPF работает одинаково, независимо от того, используете ли вы новый или старый стиль конфигурации.
|
The OSPF area design works the same, neighbor relationships form the same way, routers negotiate to become the DR and BDR the same way, and so on.|Структура области OSPF работает одинаково, взаимосвязи между соседями формируются одинаково, маршрутизаторы согласовываются, чтобы стать DR и BDR одинаково, и так далее.
However, you can see a few small differences in show command output when using the newer OSPFv2 configuration if you look closely.|Однако вы можете увидеть несколько небольших отличий в выводе команды show при использовании более новой конфигурации OSPFv2, если присмотреться.
|
The show ip protocols command relists most of the routing protocol configuration, so it does list some different details if you use interface configuration versus the network command.|Команда show iptocols возвращает большую часть конфигурации протокола маршрутизации, поэтому в ней перечислены некоторые другие детали, если вы используете конфигурацию интерфейса по сравнению с сетевой командой.
|
With the newer-style configuration, the output lists the phrase “Interfaces Configured Explicitly,” with the list of interfaces configured with the new ip ospf process-id area area-id commands, as highlighted in Example 20-13.|В более новой конфигурации в выходных данных содержится фраза «Интерфейсы, настроенные явно» со списком интерфейсов, настроенных с помощью новых команд ip ospf process-id area area-id, как показано в Примере 20-13.
The example first shows the relevant parts of the show ip protocols command when using interface configuration on Router R1, and then lists the same portions of the command from when R1 used network commands.|В примере сначала показаны соответствующие части команды show iptocols при использовании конфигурации интерфейса на маршрутизаторе R1, а затем перечислены те же части команды, когда R1 использовал сетевые команды.
|
Example 20-13 Differences in show ip protocols Output: Old- and New-Style OSPFv2 Example end.|Пример 20-13. Различия в протоколах show ip. Вывод: OSPFv2 в старом и новом стиле. Конец примера.
|
Another small piece of different output exists in the show ip ospf interface [interface] command.|Еще один небольшой фрагмент другого вывода существует в команде show ip ospf interface [interface].
|
The command lists details about OSPF settings for the interface(s) on which OSPF is enabled.|Команда выводит подробную информацию о настройках OSPF для интерфейсов, на которых включен OSPF.
The output also makes a subtle reference to whether that interface was enabled for OSPF with the old or new configuration style.|В выходных данных также содержится тонкая ссылка на то, был ли этот интерфейс включен для OSPF со старым или новым стилем конфигурации.
Example 20-14 also begins with output based on interface configuration on Router R1, followed by the output that would exist if R1 still used the old-style network command.|Пример 20-14 также начинается с вывода, основанного на конфигурации интерфейса на маршрутизаторе R1, за которым следует вывод, который существовал бы, если бы R1 все еще использовал сетевую команду старого стиля.
|
Example 20-14 Differences in show ip ospf interface Output with OSPFv2 Interface Example end.|Пример 20-14. Различия в выводе интерфейса show ip ospf с интерфейсом OSPFv2. Пример конец.
|
Other than these small differences in a few show commands, the rest of the commands show nothing different depending on the style of configuration.|За исключением этих небольших различий в нескольких командах show, остальные команды не показывают никаких различий в зависимости от стиля конфигурации.
For instance, the show ip ospf interface brief command does not change depending on the configuration style, nor do the show ip ospf database, show ip ospf neighbor, or show ip route commands.|Например, команда show ip ospf interfacerief не изменяется в зависимости от стиля конфигурации, как и команды show ip ospf database, show ip ospf neighbour или show ip route.
### Additional OSPFv2 Features
Дополнительные функции OSPFv2   
__|__
--|--
|
This final major section of the chapter discusses some very popular but optional OSPFv2 configuration features, as listed here in their order of appearance:|В этом последнем основном разделе главы обсуждаются некоторые очень популярные, но необязательные функции конфигурации OSPFv2, которые перечислены здесь в порядке их появления:
###### Passive interfaces
Пассивные интерфейсы   
###### Default routes
Маршруты по умолчанию   
###### Metrics
Метрики   
###### Load balancing
Балансировки нагрузки   
#### OSPF Passive Interfaces
Пассивные интерфейсы OSPF   
__|__
--|--
|
Once OSPF has been enabled on an interface, the router tries to discover neighboring OSPF routers and form a neighbor relationship.|После включения OSPF на интерфейсе маршрутизатор пытается обнаружить соседние маршрутизаторы OSPF и сформировать отношения соседства.
To do so, the router sends OSPF Hello messages on a regular time interval (called the Hello Interval).|Для этого маршрутизатор отправляет сообщения приветствия OSPF через регулярный интервал времени (называемый интервалом приветствия).
The router also listens for incoming Hello messages from potential neighbors.|Маршрутизатор также прослушивает входящие сообщения Hello от потенциальных соседей.
|
Sometimes, a router does not need to form neighbor relationships with neighbors on an interface.|Иногда маршрутизатору не нужно формировать отношения между соседями по интерфейсу.
Often, no other routers exist on a particular link, so the router has no need to keep sending those repetitive OSPF Hello messages.|Часто на конкретном канале нет других маршрутизаторов, поэтому маршрутизатору не нужно продолжать отправлять эти повторяющиеся сообщения приветствия OSPF.
In such cases, an engineer can make the interface passive, which means|В таких случаях инженер может сделать интерфейс пассивным, что означает
###### OSPF continues to advertise about the subnet that is connected to the interface.
OSPF продолжает сообщать о подсети, подключенной к интерфейсу.   
###### OSPF no longer sends OSPF Hellos on the interface.
OSPF больше не отправляет OSPF hellos на интерфейс.   
###### OSPF no longer processes any received Hellos on the interface.
OSPF больше не обрабатывает полученные сообщения Hellos на интерфейсе.   
__|__
--|--
|
The result of enabling OSPF on an interface but then making it passive is that OSPF still advertises about the connected subnet, but OSPF also does not form neighbor relationships over the interface.|В результате включения OSPF на интерфейсе, но затем его пассивного действия, OSPF по-прежнему сообщает о подключенной подсети, но OSPF также не формирует отношения соседей через интерфейс.
|
To configure an interface as passive, two options exist.|Есть два варианта настройки интерфейса как пассивного.
First, you can add the following command to the configuration of the OSPF process, in router configuration mode:|Во-первых, вы можете добавить следующую команду в конфигурацию процесса OSPF в режиме конфигурации маршрутизатора:
|
passive-interface type number Alternately, the configuration can change the default setting so that all interfaces are passive by default and then add a no passive-interface command for all interfaces that need to not be passive:|номер типа пассивного интерфейса. В качестве альтернативы, конфигурация может изменить настройку по умолчанию, чтобы все интерфейсы были пассивными по умолчанию, а затем добавить команду no passive-interface для всех интерфейсов, которые не должны быть пассивными:
|
passive-interface default no passive-interface type number For example, in the sample internetwork in Figure 20-2 (and in Figure 20-5), Router R1, on the left side of the figure, has a LAN interface configured for VLAN trunking.|passive-interface default no passive-interface type number Например, в примере межсетевого взаимодействия на Рисунке 20-2 (и на Рисунке 20-5) маршрутизатор R1 в левой части рисунка имеет интерфейс LAN, настроенный для транкинга VLAN .
The only router connected to both VLANs is Router R1, so R1 will never discover an OSPF neighbor on these subnets.|Единственный маршрутизатор, подключенный к обеим сетям VLAN, - это маршрутизатор R1, поэтому R1 никогда не обнаружит соседа OSPF в этих подсетях.
Example 20-15 shows two alternative configurations to make the two LAN subinterfaces passive to OSPF.|В примере 20-15 показаны две альтернативные конфигурации, чтобы сделать два подинтерфейса LAN пассивными для OSPF.
|
Example 20-15 Configuring Passive Interfaces on R1 from Figure 20-5 Example end.|Пример 20-15. Настройка пассивных интерфейсов на маршрутизаторе R1 из рисунка 20-5. Конец примера.
|
In real internetworks, the choice of configuration style reduces to which option requires the least number of commands.|В реальных объединенных сетях выбор стиля конфигурации сводится к тому, какой вариант требует наименьшего количества команд.
For example, a router with 20 interfaces, 18 of which are passive to OSPF, has far fewer configuration commands when using the passive-interface default command to change the default to passive.|Например, маршрутизатор с 20 интерфейсами, 18 из которых являются пассивными для OSPF, имеет гораздо меньше команд конфигурации при использовании команды passive-interface default для изменения значения по умолчанию на пассивное.
If only two of those 20 interfaces need to be passive, use the default setting, in which all interfaces are not passive, to keep the configuration shorter.|Если только два из этих 20 интерфейсов должны быть пассивными, используйте настройку по умолчанию, в которой все интерфейсы не пассивны, чтобы конфигурация была короче.
|
Interestingly, OSPF makes it a bit of a challenge to use show commands to find whether or not an interface is passive.|Интересно, что OSPF усложняет использование команд show, чтобы определить, является ли интерфейс пассивным.
The show running-config command lists the configuration directly, but if you cannot get into enable mode to use this command, note these two facts:|Команда show running-config отображает конфигурацию напрямую, но если вы не можете войти в режим включения для использования этой команды, обратите внимание на эти два факта:
|
The show ip ospf interface brief command lists all interfaces on which OSPF is enabled, including passive interfaces.|Команда show ip ospf interface short выводит список всех интерфейсов, на которых включен OSPF, включая пассивные интерфейсы.
|
The show ip ospf interface command lists a single line that mentions that the interface is passive.|Команда show ip ospf interface перечисляет единственную строку, в которой упоминается, что интерфейс пассивен.
|
Example 20-16 shows these two commands on Router R1, based on the configuration shown in the top of Example 20-15.|В примере 20-16 показаны эти две команды на маршрутизаторе R1 на основе конфигурации, показанной в верхней части примера 20-15.
Note that subinterfaces G0/0.1 and G0/0.2 both show up in the output of show ip ospf interface brief.|Обратите внимание, что оба подинтерфейса G0 / 0.1 и G0 / 0.2 отображаются в выводе команды show ip ospf interfacerief.
|
Example 20-16 Displaying Passive Interfaces Example end.|Пример 20-16 Отображение пассивных интерфейсов Пример конец.
#### OSPF Default Routes
Маршруты OSPF по умолчанию   
__|__
--|--
|
Chapter 16, “Configuring IPv4 Addressing and Static Routes,” showed some of the uses and benefits of default routes, with examples of static default routes.|В главе 16 «Настройка IPv4-адресации и статических маршрутов» показаны некоторые применения и преимущества маршрутов по умолчанию с примерами статических маршрутов по умолчанию.
For those exact same reasons, networks can use OSPF to advertise default routes.|По тем же причинам сети могут использовать OSPF для объявления маршрутов по умолчанию.
|
The most classic case for using a routing protocol to advertise a default route has to do with an enterprise’s connection to the Internet.|Самый классический случай использования протокола маршрутизации для объявления маршрута по умолчанию связан с подключением предприятия к Интернету.
As a strategy, the enterprise engineer uses these design goals:|В качестве стратегии инженер предприятия использует следующие цели проектирования:
###### All routers learn specific (nondefault) routes for subnets inside the company; a default
Все маршрутизаторы изучают определенные (не по умолчанию) маршруты для подсетей внутри компании; по умолчанию   
__|__
--|--
|
route is not needed when forwarding packets to these destinations.|route не требуется при пересылке пакетов в эти места назначения.
###### One router connects to the Internet, and it has a default route that points toward the
Один маршрутизатор подключается к Интернету, и у него есть маршрут по умолчанию, который указывает на   
__|__
--|--
|
Internet.|Интернет.
###### All routers should dynamically learn a default route, used for all traffic going to the
Все маршрутизаторы должны динамически изучать маршрут по умолчанию, используемый для всего трафика, идущего к   
__|__
--|--
|
Internet, so that all packets destined to locations in the Internet go to the one router connected to the Internet.|Интернет, так что все пакеты, предназначенные для местоположений в Интернете, отправляются на один маршрутизатор, подключенный к Интернету.
|
Figure 20-6 shows the idea of how OSPF advertises the default route, with the specific OSPF configuration.|На рисунке 20-6 показано, как OSPF объявляет маршрут по умолчанию с конкретной конфигурацией OSPF.
In this case, a company connects to an ISP with its Router R1. That router has a static default route (destination 0.0.0.0, mask 0.0.0.0) with a next-hop address of the ISP router.|В этом случае компания подключается к Интернет-провайдеру с помощью своего маршрутизатора R1. Этот маршрутизатор имеет статический маршрут по умолчанию (пункт назначения 0.0.0.0, маска 0.0.0.0) с адресом следующего перехода маршрутизатора Интернет-провайдера.
Then the use of the OSPF default-information originate command (Step 2)|Затем использование команды OSPF default-information originate (Шаг 2)
|
makes the router advertise a default route using OSPF to the remote routers (B1 and B2).|заставляет маршрутизатор объявлять маршрут по умолчанию с помощью OSPF удаленным маршрутизаторам (B1 и B2).
|
Figure 20-6 Using OSPF to Create and Flood a Default Route Figure 20-7 shows the default routes that result from OSPF’s advertisements in Figure 20-6.|Рис. 20-6. Использование OSPF для создания и лавинной рассылки маршрута по умолчанию. На рис. 20-7 показаны маршруты по умолчанию, полученные в результате рекламы OSPF на рис. 20-6.
|
On the far left, the branch routers all have OSPF-learned default routes, pointing to R1.|В крайнем левом углу все маршрутизаторы ответвлений имеют маршруты по умолчанию, полученные с помощью OSPF, указывающие на R1.
|
R1 itself also needs a default route, pointing to the ISP router, so that R1 can forward all Internet-bound traffic to the ISP.|Самому R1 также нужен маршрут по умолчанию, указывающий на маршрутизатор ISP, чтобы R1 мог пересылать весь интернет-трафик к ISP.
|
Finally, this feature gives the engineer control over when the router originates this default route.|Наконец, эта функция позволяет инженеру контролировать, когда маршрутизатор создает этот маршрут по умолчанию.
First, R1 needs a default route, either defined as a static default route, learned from the ISP with DHCP or learned from the ISP with a routing protocol like eBGP. The OSPF subcommand default-information originate then tells OSPF on R1 to advertise a default route when its own default route is working and to advertise the default route as down when its own default route fails.|Во-первых, маршрутизатору R1 нужен маршрут по умолчанию, который может быть определен как статический маршрут по умолчанию, полученный от провайдера с помощью DHCP или полученный от провайдера с помощью протокола маршрутизации, такого как eBGP. Затем подкоманда OSPF default-information originate сообщает OSPF на маршрутизаторе R1 о необходимости объявлять маршрут по умолчанию, когда его собственный маршрут по умолчанию работает, и объявлять маршрут по умолчанию как неработающий, когда его собственный маршрут по умолчанию не работает.
|
Figure 20-7 Default Routes Resulting from the default-information originate Command NOTE Interestingly, the default-information originate always router subcommand tells the router to always advertise the default route, no matter whether the router’s default route is working or not.|Рис. 20-7 Маршруты по умолчанию, полученные из команды originate default-information ПРИМЕЧАНИЕ Интересно, что подкоманда маршрутизатора default-information originate always указывает маршрутизатору всегда объявлять маршрут по умолчанию, независимо от того, работает ли маршрут по умолчанию маршрутизатора или нет.
|
Example 20-17 shows details of the default route on both R1 and branch router B1 from Figure 20-7.|В примере 20-17 показаны подробности маршрута по умолчанию как на маршрутизаторе R1, так и на маршрутизаторе ответвления B1 из рисунка 20-7.
R1 then creates a static default route with the ISP router’s IP address of 192.0.2.1 as the next-hop address, as highlighted in the output of the show ip route static command output.|Затем R1 создает статический маршрут по умолчанию с IP-адресом маршрутизатора ISP 192.0.2.1 в качестве адреса следующего перехода, как выделено в выходных данных выходных данных статической команды show ip route.
|
Example 20-17 Default Routes on Routers R1 and B1 Example end.|Пример 20-17 Маршруты по умолчанию на маршрутизаторах R1 и B1 Пример конец.
|
Keeping the focus on the command on Router R1, note that R1 indeed has a default route—|Удерживая фокус на команде на маршрутизаторе R1, обратите внимание, что R1 действительно имеет маршрут по умолчанию -
|
that is, a route to 0.0.0.0/0.|то есть путь к 0.0.0.0/0.
The “Gateway of last resort,” which refers to the default route currently used by the router, points to next-hop IP address 192.0.2.1, which is the ISP router’s IP address. (Refer to Figure 20-7 for the particulars.)|«Шлюз последней инстанции», который относится к маршруту по умолчанию, который в настоящее время используется маршрутизатором, указывает на IP-адрес следующего перехода 192.0.2.1, который является IP-адресом маршрутизатора ISP. (Подробности см. На Рисунке 20-7.)
|
Next look to the bottom half of the example and router B1’s OSPF-learned default route.|Затем посмотрите на нижнюю половину примера и маршрут по умолчанию, полученный от OSPF маршрутизатора B1.
B1 lists a route for 0.0.0.0/0 as well.|B1 также содержит маршрут для 0.0.0.0/0.
The next-hop router in this case is 10.1.12.1, which is Router R1’s IP address on the WAN link.|Маршрутизатор следующего перехода в данном случае - 10.1.12.1, который является IP-адресом маршрутизатора R1 в канале WAN.
The code on the far left is O1E2, meaning an OSPF-learned route, which is a default route, and is specifically an external OSPF route.|Крайний слева код - O1E2, что означает маршрут, полученный с помощью OSPF, который является маршрутом по умолчанию и, в частности, является внешним маршрутом OSPF.
Finally, B1’s gateway of last resort setting uses that one OSPF-learned default route, with next-hop router|Наконец, настройка шлюза последней инстанции B1 использует тот один маршрут по умолчанию, полученный с помощью OSPF, с маршрутизатором следующего перехода.
###### 10.1.12.1.
10.1.12.1.   
#### OSPF Metrics Cost
Стоимость метрик OSPF   
__|__
--|--
|
The section “Calculating the Best Routes with SPF” in Chapter 19 discussed how SPF calculates the metric for each route, choosing the route with the best metric for each destination subnet.|В разделе «Расчет лучших маршрутов с помощью SPF» в главе 19 обсуждается, как SPF вычисляет метрику для каждого маршрута, выбирая маршрут с наилучшей метрикой для каждой подсети назначения.
OSPF routers can influence that choice by changing the OSPF interface cost on any and all interfaces.|Маршрутизаторы OSPF могут влиять на этот выбор, изменяя стоимость интерфейса OSPF на всех без исключения интерфейсах.
|
Cisco routers allow three different ways to change the OSPF interface cost:|Маршрутизаторы Cisco позволяют изменять стоимость интерфейса OSPF тремя разными способами:
###### Directly, using the interface subcommand ip ospf cost x.
Напрямую с помощью интерфейсной подкоманды ip ospf cost x.   
###### Using the default calculation per interface, and changing the interface bandwidth setting,
Используя расчет по умолчанию для каждого интерфейса и изменив настройку пропускной способности интерфейса,   
__|__
--|--
|
which changes the calculated value.|который изменяет вычисленное значение.
###### Using the default calculation per interface, and changing the OSPF reference bandwidth
Использование расчета по умолчанию для каждого интерфейса и изменение эталонной полосы пропускания OSPF   
__|__
--|--
|
setting, which changes the calculated value.|настройка, изменяющая рассчитанное значение.
##### Setting the Cost Directly
Непосредственная установка стоимости   
__|__
--|--
|
Setting the cost directly requires a simple configuration command, as shown in Example 20-18.|Для прямого задания стоимости требуется простая команда настройки, как показано в Примере 20-18.
The example sets the cost of two interfaces on Router R1. (This example uses the Figure 20-2 design, as configured in Examples 20-2 and 20-3.) The show ip ospf interface brief command that follows details the cost of each interface.|В этом примере устанавливается стоимость двух интерфейсов на маршрутизаторе R1. (В этом примере используется конструкция, показанная на рис. 20-2, которая настроена в примерах 20-2 и 20-3.) Следующая команда show ip ospf interfacerief подробно описывает стоимость каждого интерфейса.
Note that the show command confirms the cost settings.|Обратите внимание, что команда show подтверждает настройки стоимости.
|
Example 20-18 Confirming OSPF Interface Costs Example end.|Пример 20-18. Подтверждение стоимости интерфейса OSPF. Пример конец.
|
The output also shows a cost value of 1 for the other Gigabit interfaces, which is the default OSPF cost for any interface faster than 100 Mbps.|В выходных данных также отображается значение стоимости 1 для других гигабитных интерфейсов, которое является стоимостью OSPF по умолчанию для любого интерфейса со скоростью более 100 Мбит / с.
The next topic discusses how IOS determines the default cost values.|В следующем разделе обсуждается, как IOS определяет значения стоимости по умолчанию.
##### Setting the Cost Based on Interface and Reference Bandwidth
Установка стоимости на основе интерфейса и эталонной пропускной способности   
__|__
--|--
|
Routers use a per-interface bandwidth setting to describe the speed of the interface.|Маршрутизаторы используют настройку полосы пропускания для каждого интерфейса, чтобы описать скорость интерфейса.
Note that the interface bandwidth setting does not influence the actual transmission speed.|Обратите внимание, что настройка полосы пропускания интерфейса не влияет на фактическую скорость передачи.
|
Instead, the interface bandwidth acts as a configurable setting to represent the speed of the interface, with the option to configure the bandwidth to match the actual transmission speed…or not.|Вместо этого полоса пропускания интерфейса действует как конфигурируемый параметр, представляющий скорость интерфейса, с возможностью настройки пропускной способности в соответствии с фактической скоростью передачи… или нет.
To support this logic, IOS sets a default interface bandwidth value that matches the physical transmission speed when possible, but also allows the configuration of the interface bandwidth using bandwidth speed interface subcommand.|Для поддержки этой логики IOS устанавливает значение полосы пропускания интерфейса по умолчанию, которое соответствует физической скорости передачи, когда это возможно, но также позволяет конфигурировать полосу пропускания интерфейса с помощью подкоманды интерфейса скорости полосы пропускания.
|
OSPF (as well as other IOS features) uses the interface bandwidth to make decisions, with OSPF using the interface bandwidth in its calculation of the default OSPF cost for each interface.|OSPF (как и другие функции IOS) использует полосу пропускания интерфейса для принятия решений, при этом OSPF использует полосу пропускания интерфейса при расчете стоимости OSPF по умолчанию для каждого интерфейса.
IOS uses the following formula to choose an interface’s OSPF cost if the cost for cases in which the ip ospf cost command is not configured on the interface.|IOS использует следующую формулу для выбора стоимости OSPF интерфейса, если стоимость для случаев, когда команда ip ospf cost не настроена на интерфейсе.
IOS puts the interface’s bandwidth in the denominator and an OSPF setting called the reference bandwidth in the numerator:|IOS помещает пропускную способность интерфейса в знаменатель, а параметр OSPF, называемый эталонной пропускной способностью, в числитель:
|
Reference_bandwidth / Interface_bandwidth Note that while you can change both the interface bandwidth and reference bandwidth via configuration, because several IOS features make use of the bandwidth setting, you should avoid changing the interface bandwidth as a means to influence the default OSPF cost.|Reference_bandwidth / Interface_bandwidth Обратите внимание, что, хотя вы можете изменить как полосу пропускания интерфейса, так и контрольную полосу пропускания через конфигурацию, поскольку некоторые функции IOS используют настройку полосы пропускания, вам следует избегать изменения полосы пропускания интерфейса как средства влияния на стоимость OSPF по умолчанию.
|
That being said, many enterprises do use default cost settings while influencing the default by changing the OSPF reference bandwidth while leaving the interface bandwidth as an accurate representation of link speed.|При этом многие предприятия используют настройки стоимости по умолчанию, влияя на настройки по умолчанию, изменяя эталонную полосу пропускания OSPF, оставляя полосу пропускания интерфейса как точное представление скорости соединения.
Cisco chose the IOS default reference bandwidth setting decades ago in an era with much slower links.|Cisco выбрала настройку эталонной пропускной способности IOS по умолчанию несколько десятилетий назад в эпоху гораздо более медленных каналов связи.
As a result, any interface with an interface bandwidth of 100 Mbps or faster ties with a calculated OSPF cost of 1 when using the default reference bandwidth.|В результате любой интерфейс с полосой пропускания интерфейса 100 Мбит / с или быстрее связывается с расчетной стоимостью OSPF, равной 1, при использовании эталонной полосы пропускания по умолчанию.
So, when relying on the default OSPF cost calculation, it helps to configure the reference bandwidth to another value.|Таким образом, если полагаться на расчет стоимости OSPF по умолчанию, это помогает настроить эталонную полосу пропускания на другое значение.
|
To see the issue, consider Table 20-3, which lists several types of interfaces, the default interface bandwidth on those interfaces, and the OSPF cost calculated with the default OSPF reference bandwidth of 100 MBps (that is, 100,000 Kbps). (OSPF rounds up for these calculations, resulting in a lowest possible OSPF interface cost of 1.)|Чтобы увидеть проблему, обратитесь к таблице 20-3, в которой перечислены несколько типов интерфейсов, пропускная способность интерфейса по умолчанию для этих интерфейсов и стоимость OSPF, рассчитанная с эталонной полосой пропускания OSPF по умолчанию, равной 100 Мбит / с (то есть 100 000 Кбит / с). (OSPF округляет эти вычисления в большую сторону, что дает минимально возможную стоимость интерфейса OSPF, равную 1.)
|
Table 20-3 Faster Interfaces with Equal OSPF Costs Table end.|Таблица 20-3. Более быстрые интерфейсы с равной стоимостью OSPF. Конец таблицы.
|
As you can see from the table, with a default reference bandwidth, all interfaces from Fast Ethernet’s 100 Mbps and faster tie with their default OSPF cost.|Как видно из таблицы, при эталонной полосе пропускания по умолчанию все интерфейсы от Fast Ethernet со скоростью 100 Мбит / с и выше связаны с их стоимостью OSPF по умолчанию.
As a result, OSPF would treat a 100-Mbps link as having the same cost as a 10- or 100-Gbps link, which is probably not the right basis for choosing routes.|В результате OSPF будет рассматривать канал со скоростью 100 Мбит / с как имеющий ту же стоимость, что и канал со скоростью 10 или 100 Гбит / с, что, вероятно, не является правильным основанием для выбора маршрутов.
|
You can still use OSPF’s default cost calculation (and many do) just by changing the reference bandwidth with the auto-cost reference-bandwidth speed OSPF mode subcommand.|Вы по-прежнему можете использовать расчет стоимости OSPF по умолчанию (и многие так и делают), просто изменив эталонную полосу пропускания с помощью подкоманды режима OSPF auto-cost reference-bandwidth speed.
|
This command sets a value in a unit of megabits per second (Mbps).|Эта команда устанавливает значение в мегабитах в секунду (Мбит / с).
Set the reference bandwidth value to a value at least as much as the fastest link speed in the network, but preferably higher, in anticipation of adding even faster links in the future.|Задайте для эталонной пропускной способности значение, по крайней мере, такое же, как самая быстрая скорость канала в сети, но предпочтительно выше, чтобы в будущем добавить еще более быстрые ссылки.
|
For instance, in an enterprise whose fastest links are 10 Gbps (10,000 Mbps), you could set all routers to use auto-cost reference-bandwidth 10000, meaning 10,000 Mbps or 10 Gbps.|Например, на предприятии, у которого самые быстрые каналы составляют 10 Гбит / с (10 000 Мбит / с), вы можете настроить все маршрутизаторы на использование эталонной полосы пропускания с автоматической оплатой 10000, что означает 10 000 Мбит / с или 10 Гбит / с.
|
In that case, by default, a 10-Gbps link would have an OSPF cost of 1, while a 1-Gbps link would have a cost of 10, and a 100-MBps link a cost of 100.|В этом случае по умолчанию канал 10 Гбит / с будет иметь стоимость OSPF равную 1, канал 1 Гбит / с будет иметь стоимость 10, а канал 100 Мбит / с - 100.
|
Better still, in that same enterprise, use a reference bandwidth of a faster speed than the fastest interface in the network, to allow room for higher speeds.|Еще лучше на том же предприятии использовать эталонную полосу пропускания с большей скоростью, чем самый быстрый интерфейс в сети, чтобы оставить место для более высоких скоростей.
For instance, in that same enterprise, whose fastest link is 10 Gbps, set the reference bandwidth to 40 Gbps or even 100 Gbps to be ready for future upgrades to use 40-Gbps links, or even 100-Gbps links.|Например, на том же предприятии, у которого самая быстрая связь составляет 10 Гбит / с, установите эталонную полосу пропускания на 40 Гбит / с или даже 100 Гбит / с, чтобы быть готовыми к будущим обновлениям для использования каналов 40 Гбит / с или даже каналов 100 Гбит / с.
|
(For example, use the auto-cost reference-bandwidth 100000 command, meaning 100,000 Mbps or 100 Gbps.) That causes 100-Gbps links to have an OSPF cost of 1, 40-Gbps links to have a cost of 4, 10-Gbps links to have a cost of 10, and 1-Gbps links to have a cost of 100.|(Например, используйте команду auto-cost reference-bandwidth 100000, что означает 100000 Мбит / с или 100 Гбит / с.) Это приводит к тому, что для каналов 100 Гбит / с стоимость OSPF составляет 1, а для каналов 40 Гбит / с - 4,10. Ссылки на Гбит / с имеют стоимость 10, а ссылки на 1 Гбит / с - 100.
|
NOTE Cisco recommends making the OSPF reference bandwidth setting the same on all OSPF routers in an enterprise network.|ПРИМЕЧАНИЕ Cisco рекомендует сделать настройку эталонной полосы пропускания OSPF одинаковой для всех маршрутизаторов OSPF в корпоративной сети.
|
For convenient study, the following list summarizes the rules for how a router sets its OSPF interface costs:|Для удобства изучения в следующем списке приведены правила того, как маршрутизатор устанавливает стоимость интерфейса OSPF:
|
1. Set the cost explicitly, using the ip ospf cost x interface subcommand, to a value between 1 and 65,535, inclusive.|1. Установите стоимость явно с помощью подкоманды интерфейса ip ospf cost x в значение от 1 до 65 535 включительно.
|
2. Although it should be avoided, change the interface bandwidth with the bandwidth speed command, with speed being a number in kilobits per second (Kbps).|2. Хотя этого следует избегать, измените полосу пропускания интерфейса с помощью команды bandwidth speed, указав скорость в килобитах в секунду (Кбит / с).
|
3. Change the reference bandwidth, using router OSPF subcommand auto-cost reference-bandwidth ref-bw, with a unit of megabits per second (Mbps).|3. Измените эталонную полосу пропускания с помощью подкоманды OSPF маршрутизатора auto-cost reference-bandwidth ref-bw с единицей измерения мегабит в секунду (Мбит / с).
#### OSPF Load Balancing
Балансировка нагрузки OSPF   
__|__
--|--
|
When a router uses SPF to calculate the metric for each of several routes to reach one subnet, one route may have the lowest metric, so OSPF puts that route in the routing table.|Когда маршрутизатор использует SPF для вычисления метрики для каждого из нескольких маршрутов для достижения одной подсети, один маршрут может иметь самую низкую метрику, поэтому OSPF помещает этот маршрут в таблицу маршрутизации.
|
However, when the metrics tie for multiple routes to the same subnet, the router can put multiple equal-cost routes in the routing table (the default is four different routes) based on the setting of the maximum-paths number router subcommand.|Однако, когда метрики связаны для нескольких маршрутов с одной и той же подсетью, маршрутизатор может поместить несколько маршрутов с одинаковой стоимостью в таблицу маршрутизации (по умолчанию четыре разных маршрута) на основе настройки подкоманды маршрутизатора максимального числа путей.
For example, if an internetwork has six possible paths between some parts of the network, and the engineer wants all routes to be used, the routers can be configured with the maximum-paths 6 subcommand under router ospf.|Например, если в объединенной сети есть шесть возможных путей между некоторыми частями сети, и инженер хочет, чтобы все маршруты использовались, маршрутизаторы можно настроить с помощью подкоманды maximum-paths 6 в router ospf.
|
The more challenging concept relates to how the routers use those multiple routes.|Более сложная концепция связана с тем, как маршрутизаторы используют эти несколько маршрутов.
A router could load balance the packets on a per-packet basis.|Маршрутизатор может балансировать нагрузку пакетов для каждого пакета.
For example, if the router has three equal-cost OSPF routes for the same subnet in the routing table, the router could send the one packet over the first route, the next packet over the second route, the next packet over the third route, and then start over with the first route for the next packet.|Например, если у маршрутизатора есть три маршрута OSPF с одинаковой стоимостью для одной и той же подсети в таблице маршрутизации, маршрутизатор может отправить один пакет по первому маршруту, следующий пакет по второму маршруту, следующий пакет по третьему маршруту, а затем начать заново с первого маршрута для следующего пакета.
Note that perpacket load balancing is generally a poor choice because it causes the most overhead work on the router.|Обратите внимание, что балансировка нагрузки на уровне пакетов, как правило, является плохим выбором, поскольку она вызывает больше всего накладных расходов на маршрутизатор.
Alternatively, using the default (and better) method, the load balancing could be on a per-destination IP address basis.|В качестве альтернативы, используя метод по умолчанию (и лучший), балансировка нагрузки может быть на основе IP-адреса назначения.
|
Note that the default setting of maximum-paths varies by router platform.|Обратите внимание, что настройка максимальных путей по умолчанию зависит от платформы маршрутизатора.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 20-4 outlines the key review elements and where you can find them.|В Таблице 20-4 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 20-4 Chapter Review Tracking Table end.|Таблица 20-4 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Table 20-5 Key Topics for Chapter 20 Table end.|Просмотрите все ключевые темы Таблица 20-5 Ключевые темы в конце таблицы 20 главы.
|
Table 20-6 Chapter 20 Configuration Command Reference Table end.|Таблица 20-6 Глава 20 Справочник команд конфигурации Конец таблицы.
|
Table 20-7 Chapter 20 EXEC Command Reference Table end.|Таблица 20-7 Глава 20 Справочник команд EXEC Конец таблицы.
|
Command Description show ip ospf neighbor [type number]|Описание команды show ip ospf neighbour [номер типа]
|
Lists brief output about neighbors, identified by neighbor router ID, including current state, with one line per neighbor;|Выводит краткий вывод о соседях, идентифицированных идентификатором соседнего маршрутизатора, включая текущее состояние, с одной строкой на соседа;
|
optionally, limits the output to neighbors on the listed interface.|опционально, ограничивает вывод соседями по указанному интерфейсу.
|
show ip ospf neighbor neighbor-ID Lists the same output as the show ip ospf neighbor detail command, but only for the listed neighbor (by neighbor RID).|show ip ospf neighbour-ID Перечисляет те же выходные данные, что и команда show ip ospf neighbour detail, но только для указанного соседа (по RID соседа).
|
show ip ospf database Lists a summary of the LSAs in the database, with one line of output per LSA. It is organized by LSA type (first type 1, then type 2, and so on).|show ip ospf database Перечисляет сводку LSA в базе данных с одной строкой вывода для каждого LSA. Он организован по типу LSA (сначала тип 1, затем тип 2 и так далее).
|
show ip route Lists all IPv4 routes.|show ip route Выводит список всех маршрутов IPv4.
|
show ip route ospf Lists routes in the routing table learned by OSPF.|show ip route ospf Выводит список маршрутов в таблице маршрутизации, полученной OSPF.
|
show ip route ip-address mask Shows a detailed description of the route for the listed subnet/mask.|show ip route ip-address mask Отображает подробное описание маршрута для указанной подсети / маски.
|
clear ip ospf process Resets the OSPF process, resetting all neighbor relationships and also causing the process to make a choice of OSPF RID.|clear ip ospf process Сбрасывает процесс OSPF, сбрасывая все отношения соседей, а также заставляет процесс выбирать RID OSPF.
## Chapter 21 OSPF Network Types and Neighbors
Глава 21 Типы сетей OSPF и их соседи   
__|__
--|--
|
Neighbors This chapter covers the following exam topics:|Соседи В этой главе рассматриваются следующие экзаменационные темы:
###### 3.0 IP Connectivity
3.0 IP-подключение   
###### 3.4 Configure and verify single area OSPFv2
3.4 Настройка и проверка OSPFv2 для одной области   
###### 3.4.a Neighbor adjacencies
3.4.a Соседние окрестности   
###### 3.4.b Point-to-point
3.4.b Точка-точка   
###### 3.4.c Broadcast (DR/BDR selection)
3.4.c Трансляция (выбор DR / BDR)   
###### 3.4.d Router ID
3.4.d Идентификатор маршрутизатора   
__|__
--|--
|
Chapter 20, “Implementing OSPF,” discussed the required and most common optional OSPF configuration settings, along with the many verification commands to show how OSPF works with those settings.|В главе 20 «Реализация OSPF» обсуждаются обязательные и наиболее распространенные дополнительные параметры конфигурации OSPF, а также множество команд проверки, чтобы показать, как OSPF работает с этими параметрами.
This chapter continues with more OSPF implementation topics, both to round out the discussion of OSPF and to focus even more on the specific CCNA 200-301 exam topics.|В этой главе рассказывается о других темах реализации OSPF, чтобы завершить обсуждение OSPF и сосредоточить внимание на конкретных темах экзамена CCNA 200-301.
|
The first of two major sections of this chapter focuses on OSPF network types, specifically types point-to-point and broadcast.|Первый из двух основных разделов этой главы посвящен типам сетей OSPF, в частности типам точка-точка и широковещательной передаче.
The CCNA 200-301 exam topics mention those by name.|Темы экзамена CCNA 200-301 упоминают их поименно.
Chapter 20 showed how OSPF operates on Ethernet interfaces when using their default network type (broadcast).|В главе 20 показано, как OSPF работает с интерфейсами Ethernet при использовании их типа сети по умолчанию (широковещательная рассылка).
This first section of the chapter discusses the meaning of OSPF network types, default settings, how to configure to use other settings, and how OSPF works differently with different settings.|В этом первом разделе главы обсуждается значение типов сети OSPF, настроек по умолчанию, как настроить использование других настроек и как OSPF по-разному работает с разными настройками.
|
The second major section then focuses on neighbors and neighbor adjacencies as mentioned in yet another of the OSPF exam topics.|Затем второй основной раздел посвящен соседям и соседству, упомянутым в еще одной теме экзамена OSPF.
OSPF routers cannot exchange LSAs with another router unless they first become neighbors.|Маршрутизаторы OSPF не могут обмениваться LSA с другим маршрутизатором, если они сначала не станут соседями.
This second section discusses the various OSPF features that can prevent OSPF routers from becoming neighbors and how you can go about discovering if those bad conditions exist—even if you do not have access to the running configuration.|Во втором разделе обсуждаются различные функции OSPF, которые могут препятствовать тому, чтобы маршрутизаторы OSPF становились соседями, и как вы можете определить, существуют ли эти плохие условия, даже если у вас нет доступа к текущей конфигурации.
### “Do I Know This Already?” Quiz
«Знаю ли я это уже?» Викторина   
__|__
--|--
|
Take the quiz (either here or use the PTP software) if you want to use the score to help you decide how much time to spend on this chapter.|Пройдите тест (здесь или воспользуйтесь программой PTP), если вы хотите использовать оценку, чтобы решить, сколько времени потратить на эту главу.
The letter answers are listed at the bottom of the page following the quiz.|Ответы на письма перечислены внизу страницы после викторины.
Appendix C, found both at the end of the book as well as on the companion website, includes both the answers and explanations.|Приложение C, которое можно найти как в конце книги, так и на сопутствующем веб-сайте, включает как ответы, так и пояснения.
You can also find both answers and explanations in the PTP testing software.|Вы также можете найти ответы и пояснения в программе тестирования PTP.
|
CHAPTER 21 Table 21-1 “Do I Know This Already?” Foundation Topics Section-to-Question Mapping|ГЛАВА 21 Таблица 21-1 «Знаю ли я это уже?» Сопоставление разделов с вопросами по основным темам
### Foundation Topics
Основные темы   
### OSPF Network Types
Типы сетей OSPF   
__|__
--|--
|
OSPF Neighbor Relationships 4–6 1.|OSPF Neighbor Relations 4–6 1.
Routers R1 and R2, with router IDs 1.1.1.1 and 2.2.2.2, connect over an Ethernet WAN link.|Маршрутизаторы R1 и R2 с идентификаторами маршрутизатора 1.1.1.1 и 2.2.2.2 подключаются по каналу Ethernet WAN.
If using all default OSPF settings, if the WAN link initializes for both routers at the same time, which of the following answers are true? (Choose two answers.)|При использовании всех параметров OSPF по умолчанию, если канал WAN инициализируется для обоих маршрутизаторов одновременно, какой из следующих ответов верен? (Выберите два ответа.)
|
a. Router R1 will become the DR.|а. Маршрутизатор R1 станет DR.
|
b. Router R1 will dynamically discover the existence of router R2.|б. Маршрутизатор R1 динамически обнаруживает наличие маршрутизатора R2.
|
c. Router R2 will be neither the DR nor the BDR.|c. Маршрутизатор R2 не будет ни DR, ни BDR.
|
d. Router R1’s show ip ospf neighbor command will list R2 with a state of “FULL/DR.”|d. Команда маршрутизатора R1 show ip ospf neighbour перечислит маршрутизатор R2 с состоянием «FULL / DR».
|
2. Routers R1 and R2, with router IDs 1.1.1.1 and 2.2.2.2, connect over an Ethernet WAN link.|2. Маршрутизаторы R1 и R2 с идентификаторами маршрутизатора 1.1.1.1 и 2.2.2.2 подключаются по каналу Ethernet WAN.
The configuration uses all defaults, except giving R1 an interface priority of 11 and changing both routers to use OSPF network type point-to-point.|В конфигурации используются все значения по умолчанию, за исключением присвоения R1 приоритета интерфейса 11 и изменения обоих маршрутизаторов на использование двухточечной сети типа OSPF.
If the WAN link initializes for both routers at the same time, which of the following answers are true?|Если канал WAN инициализируется для обоих маршрутизаторов одновременно, какой из следующих ответов верен?
|
(Choose two answers.)|(Выберите два ответа.)
|
a. Router R1 will become the DR.|а. Маршрутизатор R1 станет DR.
|
b. Router R1 will dynamically discover the existence of router R2.|б. Маршрутизатор R1 динамически обнаруживает наличие маршрутизатора R2.
|
c. Router R2 will be neither the DR nor the BDR.|c. Маршрутизатор R2 не будет ни DR, ни BDR.
|
d. Router R2’s show ip ospf neighbor command will list R1 with a state of “FULL/DR.”|d. Команда маршрутизатора R2 show ip ospf neighbour отобразит список R1 с состоянием «FULL / DR».
|
3. Per the command output, with how many routers is router R9 full adjacent over its Gi0/0 interface?|3. Согласно выходным данным команды, с каким количеством маршрутизаторов маршрутизатор R9 полностью примыкает к своему интерфейсу Gi0 / 0?
|
R9# show ip ospf interface brief Interface PID Area IP Address/Mask Cost State Nbrs F/C Gi0/0 1 0 10.1.1.1/24 1 DROTH 2/5 a. 7 b. 0 c. 5 d. 2 4.|R9 # show ip ospf interfacerief Интерфейсная область PID IP-адрес / состояние маски Стоимость Nbrs F / C Gi0 / 0 1 0 10.1.1.1/24 1 DROTH 2/5 a. 7 б. 0 с. 5 дн. 2 4.
An engineer connects routers R11 and R12 to the same Ethernet LAN and configures them to use OSPFv2.|Инженер подключает маршрутизаторы R11 и R12 к одной локальной сети Ethernet и настраивает их для использования OSPFv2.
Which answers describe a combination of settings that would prevent the two routers from becoming OSPF neighbors? (Choose two answers.)|Какие ответы описывают комбинацию настроек, которые не позволят двум маршрутизаторам стать соседями OSPF? (Выберите два ответа.)
|
a. R11’s interface uses area 11 while R12’s interface uses area 12.|а. Интерфейс R11 использует область 11, а интерфейс R12 использует область 12.
|
b. R11’s OSPF process uses process ID 11 while R12 uses process ID 12.|б. Процесс OSPF R11 использует идентификатор процесса 11, а R12 использует идентификатор процесса 12.
|
c. R11’s interface uses OSPF priority 11 while R12’s uses OSPF priority 12.|c. Интерфейс R11 использует приоритет 11 OSPF, тогда как R12 использует приоритет 12 OSPF.
|
d. R11’s interface uses an OSPF Hello timer value of 11 while R12’s uses 12.|d. Интерфейс R11 использует значение таймера приветствия OSPF 11, в то время как R12 использует 12.
|
5. An engineer connects routers R13 and R14 to the same Ethernet LAN and configures them to use OSPFv2.|5. Инженер подключает маршрутизаторы R13 и R14 к одной локальной сети Ethernet и настраивает их для использования OSPFv2.
Which answers describe a combination of settings that would prevent the two routers from becoming OSPF neighbors?|Какие ответы описывают комбинацию настроек, которые не позволят двум маршрутизаторам стать соседями OSPF?
|
a. Both routers’ interface IP addresses reside in the same subnet.|а. IP-адреса интерфейсов обоих маршрутизаторов находятся в одной подсети.
|
b. Both routers’ OSPF process uses process ID 13.|б. Процесс OSPF обоих маршрутизаторов использует идентификатор процесса 13.
|
c. Both routers’ OSPF process uses router ID 13.13.13.13.|c. Процесс OSPF обоих маршрутизаторов использует идентификатор маршрутизатора 13.13.13.13.
|
d. Both routers’ interfaces use an OSPF Dead interval of 40.|d. Интерфейсы обоих маршрутизаторов используют мертвый интервал OSPF, равный 40.
|
6. Router R15 has been a working part of a network that uses OSPFv2.|6. Маршрутизатор R15 был рабочей частью сети, использующей OSPFv2.
An engineer then issues the shutdown command in OSPF configuration mode on R15.|Затем инженер выдает команду выключения в режиме конфигурации OSPF на R15.
Which of the following occurs?|Что из следующего происходит?
|
a. R15 empties its IP routing table of all OSPF routes but keeps its LSDB intact.|а. R15 очищает свою таблицу IP-маршрутизации от всех маршрутов OSPF, но сохраняет свой LSDB нетронутым.
|
b. R15 empties its LSDB but keeps OSPF neighbor relationships active.|б. R15 очищает свой LSDB, но сохраняет отношения соседей OSPF активными.
|
c. R15 keeps OSPF neighbors open but does not accept new OSPF neighbors.|c. R15 оставляет соседей OSPF открытыми, но не принимает новых соседей OSPF.
|
d. R15 keeps all OSPF configuration but ceases all OSPF activities (routes, LSDB, neighbors).|d. R15 сохраняет всю конфигурацию OSPF, но прекращает все действия OSPF (маршруты, LSDB, соседи).
|
Foundation Topics OSPF Network Types Two CCNA 200-301 exam topics might be completely misunderstood without taking a closer look at yet more default OSPF settings.|Основные темы Типы сетей OSPF Две темы экзамена CCNA 200-301 могут быть полностью неправильно поняты без более внимательного изучения дополнительных настроек OSPF по умолчанию.
In particular, the following exam topics refer to a specific per-interface OSPF setting called the network type—even listing the keywords used to configure the setting in the exam topics:|В частности, следующие темы экзаменов относятся к конкретному параметру OSPF для каждого интерфейса, называемому типом сети, - даже перечисляются ключевые слова, используемые для настройки параметра в темах экзамена:
###### 3.4.b: point-to-point
3.4.b: точка-точка   
###### 3.4.c: broadcast (DR/BDR selection)
3.4.c: трансляция (выбор DR / BDR)   
__|__
--|--
|
OSPF includes a small number of network types as a setting on each OSPF-enabled interface.|OSPF включает небольшое количество типов сетей в качестве настройки для каждого интерфейса с поддержкой OSPF.
|
The setting tells the router whether or not to dynamically discover OSPF neighbors (versus requiring the static configuration of the neighboring router’s IP address) and whether or not the router should attempt to use a designated router (DR) and backup DR (BDR) in the subnet.|Этот параметр сообщает маршрутизатору, следует ли динамически обнаруживать соседей OSPF (вместо того, чтобы требовать статической конфигурации IP-адреса соседнего маршрутизатора), и должен ли маршрутизатор пытаться использовать назначенный маршрутизатор (DR) и резервное DR (BDR) в подсеть.
Of the two OSPF network types included in the CCNA exam topics, both cause routers to dynamically discover neighbors, but one calls for the use of a DR while the other does not.|Из двух типов сетей OSPF, включенных в темы экзамена CCNA, оба заставляют маршрутизаторы динамически обнаруживать соседей, но один требует использования DR, а другой - нет.
Table 21-2 summarizes the features of the two OSPF network types mentioned in the exam topics.|В Таблице 21-2 приведены характеристики двух типов сети OSPF, упомянутых в темах экзамена.
|
Table 21-2 Two OSPF Network Types and Key Behaviors Table end.|Таблица 21-2. Два типа сети OSPF и поведение ключей. Конец таблицы.
|
The rest of this first major section of the chapter explores each type.|Остальная часть этого первого основного раздела главы исследует каждый тип.
#### The OSPF Broadcast Network Type
Тип широковещательной сети OSPF   
__|__
--|--
|
OSPF defaults to use a broadcast network type on all types of Ethernet interfaces.|OSPF по умолчанию использует тип широковещательной сети на всех типах интерфейсов Ethernet.
Note that all the Ethernet interfaces in examples in Chapter 20 relied on that default setting.|Обратите внимание, что все интерфейсы Ethernet в примерах в главе 20 используют эту настройку по умолчанию.
|
To see all the details of how the OSPF broadcast network type works, this chapter begins with a different design than the examples in Chapter 20, instead using a single area design that connects four routers to the same subnet, as shown in Figure 21-1.|Чтобы увидеть все подробности того, как работает тип широковещательной сети OSPF, эта глава начинается с дизайна, отличного от примеров в главе 20, вместо этого используется конструкция с одной зоной, которая подключает четыре маршрутизатора к одной подсети, как показано на рисунке 21-1. .
All links reside in area 0, making the design a single area design.|Все ссылки находятся в области 0, что делает дизайн единой областью.
|
Figure 21-1 The Single Area Design Used in This Chapter To get a sense for how OSPF operates with the broadcast network type, imagine that all four routers use a straightforward OSPF interface configuration like the router R1 configuration shown in Example 21-1.|Рисунок 21-1. Схема с одной зоной, используемая в этой главе. Чтобы понять, как OSPF работает с типом широковещательной сети, представьте, что все четыре маршрутизатора используют простую конфигурацию интерфейса OSPF, такую ​​как конфигурация маршрутизатора R1, показанная в примере 21-1.
Both GigabitEthernet interfaces on all four routers default to use network type broadcast.|Оба интерфейса GigabitEthernet на всех четырех маршрутизаторах по умолчанию используют широковещательную рассылку сетевого типа.
Note that the configuration on routers R2, R3, and R4 mirrors R1’s configuration except that they use router IDs 2.2.2.2, 3.3.3.3, and 4.4.4.4, respectively, and they use the IP addresses shown in the figure.|Обратите внимание, что конфигурация маршрутизаторов R2, R3 и R4 отражает конфигурацию R1, за исключением того, что они используют идентификаторы маршрутизаторов 2.2.2.2, 3.3.3.3 и 4.4.4.4 соответственно, и используют IP-адреса, показанные на рисунке.
|
Example 21-1 R1 OSPF Configuration to Match Figure 21-1 Example end.|Пример 21-1 Конфигурация OSPF маршрутизатора R1 для соответствия Рис. 21-1 Конец примера.
|
This simple design gives us a great backdrop from which to observe the results of the broadcast network type on each router.|Этот простой дизайн дает нам отличный фон, на котором можно наблюдать результаты типа широковещательной сети на каждом маршрутизаторе.
Both interfaces (G0/0 and G0/1) on each router use the broadcast network type and perform the following actions:|Оба интерфейса (G0 / 0 и G0 / 1) на каждом маршрутизаторе используют тип широковещательной сети и выполняют следующие действия:
###### Attempt to discover neighbors by sending OSPF Hellos to the 224.0.0.5 multicast address
Попытка обнаружить соседей, отправив OSPF Hellos на многоадресный адрес 224.0.0.5   
__|__
--|--
|
(an address reserved for sending packets to all OSPF routers in the subnet)|(адрес, зарезервированный для отправки пакетов на все маршрутизаторы OSPF в подсети)
###### Attempt to elect a DR and BDR on each subnet
Попытка выбрать DR и BDR в каждой подсети   
###### On the interface with no other routers on the subnet (G0/1), become the DR
На интерфейсе без других маршрутизаторов в подсети (G0 / 1) стать DR   
###### On the interface with three other routers on the subnet (G0/0), be either DR, BDR, or a
На интерфейсе с тремя другими маршрутизаторами в подсети (G0 / 0) может быть DR, BDR или   
__|__
--|--
|
DROther router|DROther роутер
###### When sending OSPF messages to the DR or BDR, send the messages to the all-OSPF-DRs
При отправке сообщений OSPF на DR или BDR отправляйте сообщения на все-OSPF-DR   
__|__
--|--
|
multicast address 224.0.0.6 Example 21-2 shows some of the results using the show ip ospf neighbor command.|адрес многоадресной рассылки 224.0.0.6 В примере 21-2 показаны некоторые результаты использования команды show ip ospf neighbour.
Note that R1 lists R2, R3, and R4 as neighbors (based on their 2.2.2.2, 3.3.3.3, and 4.4.4.4 router IDs), confirming that R1 dynamically discovered the other routers.|Обратите внимание, что R1 перечисляет R2, R3 и R4 в качестве соседей (на основе их идентификаторов маршрутизаторов 2.2.2.2, 3.3.3.3 и 4.4.4.4), подтверждая, что R1 динамически обнаружил другие маршрутизаторы.
Also, note that the output lists 4.4.4.4 as the DR and 3.3.3.3 as the BDR.|Также обратите внимание, что в выходных данных 4.4.4.4 указано как DR и 3.3.3.3 как BDR.
|
Example 21-2 R1’s List of Neighbors Example end.|Пример 21-2. Конец примера списка соседей маршрутизатора R1.
##### Verifying Operations with Network Type Broadcast
Проверка операций с широковещательной рассылкой типа сети   
__|__
--|--
|
As discussed in the section “Using Designated Routers on Ethernet Links” in Chapter 19, “Understanding OSPF Concepts,” all discovered routers on the link should become neighbors and at least reach the 2-way state.|Как обсуждалось в разделе «Использование назначенных маршрутизаторов на каналах Ethernet» в главе 19 «Понимание концепций OSPF», все обнаруженные маршрутизаторы на канале должны стать соседями и по крайней мере перейти в двухстороннее состояние.
For all neighbor relationships that include the DR and/or BDR, the neighbor relationship should further reach the full state.|Для всех отношений соседства, которые включают DR и / или BDR, отношения соседства должны в дальнейшем достичь полного состояния.
That section defined the term fully adjacent as a special term that refers to neighbors that reach this full state.|В этом разделе термин полностью смежный определяется как специальный термин, который относится к соседям, которые достигают этого полного состояния.
|
The design in Figure 21-1, with four routers on the same LAN, provides just enough routers so that one neighbor relationship will remain in a 2-way state and not reach the full state, as a perfectly normal way for OSPF to operate.|Схема на рис. 21-1 с четырьмя маршрутизаторами в одной локальной сети обеспечивает ровно столько маршрутизаторов, чтобы одно соседнее отношение оставалось в двухстороннем состоянии и не достигало полного состояния, что является совершенно нормальным способом работы OSPF.
Figure 21-2 shows the current conditions when the show commands in this chapter were gathered, with R4 as the DR, R3 as the BDR, and with R1 and R2 as DROther routers.|На рис. 21-2 показаны текущие условия, когда были собраны команды show, описанные в этой главе, с R4 в качестве DR, R3 в качестве BDR и с R1 и R2 в качестве маршрутизаторов DROther.
|
Now consider router R1’s neighbors as listed in Example 21-2.|Теперь рассмотрим соседей маршрутизатора R1, перечисленных в примере 21-2.
R1 has three neighbors, all reachable out its G0/0 interface.|R1 имеет трех соседей, все достижимые через его интерфейс G0 / 0.
However, R1’s show ip ospf neighbor command refers to the state of R1’s relationship with the neighbor: 2-way with router 2.2.2.2.|Однако команда R1 show ip ospf neighbour относится к состоянию отношений R1 с соседом: двусторонние с маршрутизатором 2.2.2.2.
Because both R1 and R2 currently serve as DROther routers—that is, they wait ready to become the BDR if either the DR or BDR fails—their neighbor relationship remains in a 2-way state.|Поскольку и R1, и R2 в настоящее время служат в качестве маршрутизаторов DROther, то есть ожидают готовности стать BDR в случае отказа DR или BDR, их отношения между соседями остаются в двустороннем состоянии.
|
Figure 21-2 OSPF DR/BDR/DROther Roles in the Network Examining Example 21-2 one last time, R1, as a DROther router itself, has two neighbor relationships that reach a full state: R1’s neighbor adjacency with DR R4 and R1’s neighbor adjacency with BDR R3. But R1 has a total of three neighbors, all reachable off R1’s G0/0 interface.|Рисунок 21-2 OSPF DR / BDR / DROther Роли в примере 21-2 исследования сети В последний раз R1, как сам маршрутизатор DROther, имеет два соседних отношения, которые достигают полного состояния: соседство R1 с DR R4 и соседом R1 смежность с BDR R3. Но у R1 всего три соседа, и все они доступны через интерфейс G0 / 0 маршрутизатора R1.
|
The idea that R1 has three neighbors off its G0/0 interface, with two being fully adjacent, is reflected on the far right of the output of the show ip ospf interface brief command output in Example 21-3.|Идея о том, что R1 имеет трех соседей за пределами своего интерфейса G0 / 0, причем два из них являются полностью смежными, отражена в дальнем правом углу выходных данных команды show ip ospf interface Short в примере 21-3.
It shows “2/3,” meaning two neighbors in the full state off port G0/0, with three total neighbors on that interface.|Он показывает «2/3», что означает два соседа в полном состоянии вне порта G0 / 0, с тремя полными соседями на этом интерфейсе.
Also, note that this command’s “State” column differs from the show ip ospf neighbor commands, in that the show ip ospf interface brief command lists the local router’s role on the interface (as shown in Figure 21-2), with R1’s G0/1 acting as DR and R1’s G0/0 acting as a DROther router.|Также обратите внимание, что столбец «Состояние» этой команды отличается от команд show ip ospf neighbour тем, что в команде show ip ospf interface short указывается роль локального маршрутизатора на интерфейсе (как показано на рисунке 21-2) с G0 / маршрутизатора R1. 1, действующий как DR, и G0 / 0 маршрутизатора R1, действующий как маршрутизатор DROther.
|
Example 21-3 Router R1 OSPF Interfaces: Local Role and Neighbor Counts Example end.|Пример 21-3 Маршрутизатор R1 Интерфейсы OSPF: локальная роль и счетчики соседей Конец примера.
|
So far, this topic has described the effect of the OSPF broadcast network type by taking advantage of the default setting on Ethernet interfaces.|До сих пор в этом разделе описывалось влияние типа широковещательной сети OSPF за счет использования настроек по умолчанию на интерфейсах Ethernet.
To see the setting, use the show ip ospf interface command, as shown in Example 21-4.|Чтобы увидеть настройку, используйте команду show ip ospf interface, как показано в Примере 21-4.
The first highlighted item identifies the network type.|Первый выделенный элемент определяет тип сети.
However, this command’s output restates many of the facts seen in both the show ip ospf neighbor and show ip ospf interface brief commands in Examples 21-2 and 21-3, so take the time to browse through all of Example 21-4 and focus on the additional highlights to see those familiar items.|Тем не менее, выходные данные этой команды повторяют многие факты, наблюдаемые в командах show ip ospf neighbour и show ip ospf interface Short в примерах 21-2 и 21-3, поэтому найдите время, чтобы просмотреть весь пример 21-4 и сфокусироваться. на дополнительных выделениях, чтобы увидеть знакомые предметы.
|
Example 21-4 Displaying OSPF Network Type Broadcast Example end.|Пример 21-4 Отображение широковещательной рассылки типа сети OSPF Конец примера.
|
Although you would not need to configure an Ethernet interface to use the broadcast network type, some older types of interfaces over the years have used different defaults and with the option to use the broadcast network type.|Хотя вам не нужно настраивать интерфейс Ethernet для использования типа широковещательной сети, некоторые старые типы интерфейсов на протяжении многих лет использовали другие значения по умолчанию и с возможностью использования типа широковещательной сети.
In those cases, the ip ospf network broadcast interface subcommand would configure the setting.|В этих случаях подкоманда сетевого широковещательного интерфейса ip ospf настраивает параметр.
##### Configuring to Influence the DR/BDR Election
Настройка влияния на выборы DR / BDR   
__|__
--|--
|
In some cases, you may want to influence the OSPF DR election.|В некоторых случаях вы можете захотеть повлиять на выбор OSPF DR.
However, before deciding that makes sense in every case, note that OSPF DR/BDR election rules will not result in a specific router always being the DR, and another always being the BDR, assuming that each is up and working.|Однако, прежде чем решить, что это имеет смысл в каждом случае, обратите внимание, что правила выбора OSPF DR / BDR не приведут к тому, что конкретный маршрутизатор всегда будет DR, а другой всегда будет BDR, при условии, что каждый из них работает и работает.
In short, here are the rules once a DR and BDR have been elected:|Короче говоря, вот правила после избрания DR и BDR:
###### If the DR fails, the BDR becomes the DR, and a new BDR is elected.
Если DR выходит из строя, BDR становится DR, и выбирается новый BDR.   
###### When a better router enters the subnet, no preemption of the existing DR or BDR occurs.
Когда лучший маршрутизатор входит в подсеть, не происходит вытеснения существующего DR или BDR.   
__|__
--|--
|
As a result of these rules, while you can configure a router to be the best (highest priority)|В результате этих правил, хотя вы можете настроить маршрутизатор как лучший (наивысший приоритет)
|
router to become the DR in an election, doing so only increases that router’s statistical chances of being the DR at a given point in time.|маршрутизатор, чтобы стать DR на выборах, это только увеличивает статистические шансы этого маршрутизатора стать DR в данный момент времени.
If the router fails, other routers will become DR and BDR, and the best router will not be DR again until the current DR and BDR fail.|Если маршрутизатор откажет, другие маршрутизаторы станут DR и BDR, и лучший маршрутизатор не будет снова DR, пока не откажутся текущие DR и BDR.
|
NOTE If you have begun to think about STP elections, note that the rules are similar, but with two key differences.|ПРИМЕЧАНИЕ. Если вы начали думать о выборах STP, обратите внимание, что правила аналогичны, но с двумя ключевыми отличиями.
STP uses a lowest-is-best approach and allows new switches to preempt the existing root switch to become the root.|STP использует подход «наименьшее из лучших» и позволяет новым коммутаторам вытеснять существующий корневой коммутатор, чтобы он стал корневым.
OSPF uses a highest-is-best approach and does not preempt the DR as just noted.|OSPF использует подход «наивысшее из лучших» и не вытесняет DR, как только что отмечалось.
|
In some cases, you may want to influence the DR/BDR election with two configurable settings, listed here in order of precedence:|В некоторых случаях вы можете захотеть повлиять на выбор DR / BDR с помощью двух настраиваемых параметров, перечисленных здесь в порядке приоритета:
###### The highest OSPF interface priority: The highest value wins during an election, with values
Наивысший приоритет интерфейса OSPF: во время выборов побеждает наивысшее значение со значениями   
__|__
--|--
|
ranging from 0 to 255.|от 0 до 255.
###### The highest OSPF Router ID: If the priority ties, the election chooses the router with the
Наивысший идентификатор маршрутизатора OSPF: если приоритет совпадает, выборы выбирают маршрутизатор с   
__|__
--|--
|
highest OSPF RID.|самый высокий OSPF RID.
|
For example, imagine all four routers in the design shown in Figure 21-1 trying to elect the DR and BDR at the same time—for instance, after a power hit in which all four routers power off and back on again.|Например, представьте, что все четыре маршрутизатора в схеме, показанной на рис. 21-1, пытаются выбрать DR и BDR одновременно - например, после сбоя питания, при котором все четыре маршрутизатора отключаются и снова включаются.
They all participate in the election.|Все они участвуют в выборах.
They all tie with default priority values of 1 (see Example 21-4 for R1’s priority in the show ip ospf interface command output.)|Все они связаны со значениями приоритета по умолчанию, равными 1 (см. Пример 21-4 для приоритета R1 в выходных данных команды show ip ospf interface.)
|
In this case, R4, with the numerically highest RID of 4.4.4.4, wins the election, and R3, with the next highest RID of 3.3.3.3, becomes the BDR.|В этом случае R4 с наибольшим числовым значением RID 4.4.4.4 побеждает на выборах, а R3 со следующим наивысшим RID 3.3.3.3 становится BDR.
|
To influence the election, you could set the various RIDs with your preferred router with the highest RID value.|Чтобы повлиять на выборы, вы можете установить различные RID с вашим предпочтительным маршрутизатором с наивысшим значением RID.
However, many networks choose OSPF router IDs to help identify the router easily.|Однако многие сети выбирают идентификаторы маршрутизатора OSPF, чтобы облегчить идентификацию маршрутизатора.
Instead, using the OSPF priority setting makes better sense.|Вместо этого имеет смысл использовать настройку приоритета OSPF.
For instance, if an engineer preferred that R1 be the DR, the engineer could add the configuration in Example 21-5 to set R1’s interface priority to 99.|Например, если инженер предпочел, чтобы R1 был DR, он мог бы добавить конфигурацию из примера 21-5, чтобы установить приоритет интерфейса R1 на 99.
|
Example 21-5 Influencing DR/BDR Election Using OSPF Priority Example end.|Пример 21-5. Влияние на выбор DR / BDR с помощью приоритета OSPF. Пример конец.
|
The configuration shows R1’s interface priority value now as 99, and the show ip ospf interface G0/0 command that follows confirms the setting.|Конфигурация показывает значение приоритета интерфейса R1 как 99, а следующая команда show ip ospf interface G0 / 0 подтверждает настройку.
However, the last two commands in the example seem to show that the DR and BDR have not changed at all—and that output is indeed correct.|Однако последние две команды в примере, кажется, показывают, что DR и BDR вообще не изменились - и этот вывод действительно правильный.
In the example, note that the show ip ospf neighbor command still lists R4’s state as DR, meaning R4 still acts as the DR, while the show ip ospf interface brief command lists R1’s State (role) as DROTH.|В примере обратите внимание, что команда show ip ospf neighbour по-прежнему перечисляет состояние R4 как DR, то есть R4 по-прежнему действует как DR, в то время как команда show ip ospf interface short перечисляет состояние (роль) R1 как DROTH.
|
Just to complete the process, Example 21-6 shows the results after forcing a free election (by failing the LAN switch that sits between the four routers).|Чтобы завершить процесс, в примере 21-6 показаны результаты после принудительного свободного выбора (при отказе коммутатора LAN, который находится между четырьмя маршрутизаторами).
As expected, R1 wins and becomes DR due to its higher priority, with the other three routers tying based on priority.|Как и ожидалось, R1 выигрывает и становится DR из-за своего более высокого приоритета, а остальные три маршрутизатора связываются на основе приоритета.
|
R4 wins between R2, R3, and R4 due to its higher RID to become the BDR.|R4 выигрывает между R2, R3 и R4 из-за его более высокого RID, чтобы стать BDR.
|
Example 21-6 Results of a Completely New DR/BDR Election Example end.|Пример 21-6. Результаты полностью нового выбора DR / BDR. Пример окончен.
#### The OSPF Point-to-Point Network Type
Тип сети OSPF точка-точка   
__|__
--|--
|
The other OSPF network type mentioned in the CCNA 200-301 exam topics, point-to-point, works well for data links that by their nature have just two routers on the link.|Другой тип сети OSPF, упомянутый в темах экзамена CCNA 200-301, точка-точка, хорошо работает для каналов передачи данных, которые по своей природе имеют только два маршрутизатора.
For example, consider the topology in Figure 21-3, which shows router R1 with three WAN links—two Ethernet WAN links and one serial link.|Например, рассмотрим топологию на рис. 21-3, на котором показан маршрутизатор R1 с тремя каналами WAN - двумя каналами WAN Ethernet и одним последовательным каналом.
|
Figure 21-3 Sample OSPF Design with Serial and Ethernet WAN First, focus on the serial link itself.|Рисунок 21-3. Пример проекта OSPF с последовательным интерфейсом и глобальной сетью Ethernet Во-первых, сконцентрируемся на самом последовательном канале.
To review, the jagged line represents a physical link that can at most have two devices using the link, specifically R1 and R4 in this case.|Для обзора: зубчатая линия представляет собой физическое соединение, которое может использовать максимум два устройства, в данном случае R1 и R4.
The link does not support the ability to add a third router to the link.|Ссылка не поддерживает возможность добавления в ссылку третьего маршрутизатора.
As you might guess, the datalink protocols to control a link with at most two devices can work differently than Ethernet.|Как вы могли догадаться, протоколы передачи данных для управления каналом максимум с двумя устройствами могут работать иначе, чем Ethernet.
|
For instance, the data-link protocols most often used on the link (HDLC and PPP) do not support data-link broadcasts.|Например, протоколы передачи данных, наиболее часто используемые в канале (HDLC и PPP), не поддерживают широковещательные передачи каналов данных.
|
Next, consider the OSPF point-to-point network type: it exists for serial links and other links that use a point-to-point topology.|Затем рассмотрим тип сети «точка-точка» OSPF: он существует для последовательных каналов и других каналов, использующих топологию «точка-точка».
These links often do not support data-link broadcasts.|Эти ссылки часто не поддерживают передачи по каналам передачи данных.
|
Additionally, with only two devices on the link, using a DR/BDR is not a help, and it actually adds a little extra convergence time.|Кроме того, при наличии только двух устройств на линии связи использование DR / BDR не помогает и фактически добавляет немного дополнительного времени сходимости.
Using a network type of point-to-point tells the router to not use a DR/BDR on the link.|Использование сетевого типа точка-точка указывает маршрутизатору не использовать DR / BDR на канале.
|
While you may see some serial links in networks today, the CCNA and CCNP Enterprise exams make no specific mention of serial technology at this point.|Несмотря на то, что сегодня вы можете увидеть в сетях несколько последовательных каналов, на экзаменах CCNA и CCNP Enterprise на данный момент нет особого упоминания технологии последовательного интерфейса.
However, you will see other point-to-point links—like some Ethernet WAN links.|Однако вы увидите и другие соединения «точка-точка», например, некоторые каналы Ethernet WAN.
|
To connect the thoughts, note that all the Ethernet WAN links used in this book happen to use a point-to-point Ethernet WAN service called an Ethernet Private Wire Service or simply an Ethernet Line (E-Line).|Чтобы объединить эти мысли, обратите внимание, что все каналы Ethernet WAN, используемые в этой книге, используют двухточечную службу Ethernet WAN, называемую Ethernet Private Wire Service или просто Ethernet Line (E-Line).
For that service, the service provider will send Ethernet frames between two devices (routers) connected to the service, but only those two devices.|Для этой услуги поставщик услуг будет отправлять кадры Ethernet между двумя устройствами (маршрутизаторами), подключенными к услуге, но только этими двумя устройствами.
In other words, an E-line is a point-to-point service in concept.|Другими словами, E-line по сути является услугой «точка-точка».
So while the Ethernet data-link protocol supports broadcast frames, only two devices can exist on the link, and there is no advantage to using a DR/BDR. As a result, many engineers prefer to instead use an OSPF point-topoint network type on Ethernet WAN links that in effect act as a point-to-point link.|Таким образом, хотя протокол канала передачи данных Ethernet поддерживает широковещательные кадры, на канале могут существовать только два устройства, и использование DR / BDR не дает никаких преимуществ. В результате многие инженеры предпочитают вместо этого использовать тип сети OSPF точка-точка на каналах Ethernet WAN, которые фактически действуют как двухточечный канал.
|
Example 21-7 shows the configuration of router R1’s G0/0/0 interface in Figure 21-3 to use OSPF network type point-to-point.|В примере 21-7 показана конфигурация интерфейса G0 / 0/0 маршрутизатора R1 на рисунке 21-3 для использования двухточечной сети типа OSPF.
R2, on the other end of the WAN link, would need the same configuration command on its matching interface.|R2, находящийся на другом конце канала WAN, потребует ту же команду настройки на соответствующем интерфейсе.
|
Example 21-7 OSPF Network Type Point-to-Point on an Ethernet WAN Interface on R1 Example end.|Пример 21-7. Тип сети OSPF - точка-точка на интерфейсе Ethernet WAN на R1. Пример.
|
Note the highlighted portions of the show command in Example 21-6.|Обратите внимание на выделенные части команды show в Примере 21-6.
The first two highlights note the network type.|Первые два момента указывают на тип сети.
The final highlight with two lines notes that R1 has one neighbor on the interface, a neighbor with which it has become fully adjacent per the output.|Заключительное выделение с двумя линиями отмечает, что R1 имеет одного соседа на интерфейсе, соседа, с которым он стал полностью смежным на выходе.
|
Example 21-8 closes this section with a confirmation of some of those facts with two more commands.|Пример 21-8 закрывает этот раздел, подтверждая некоторые из этих фактов еще двумя командами.
Note that the show ip ospf neighbor command on R1 lists router R2 (RID 2.2.2.2)|Обратите внимание, что команда show ip ospf neighbour на R1 перечисляет маршрутизатор R2 (RID 2.2.2.2)
|
with a full state, but with no DR nor BDR designation, instead listing a -.|с полным состоянием, но без обозначения DR или BDR, вместо этого перечисляя -.
The - acts as a reminder that the link does not use a DR/BDR. The second command, show ip ospf interface brief, shows the state (the local router’s role) as P2P, which is short for point-to-point, with a counter of 1 for the number of fully adjacent neighbors and total number of neighbors.|- действует как напоминание о том, что ссылка не использует DR / BDR. Вторая команда, show ip ospf interfacerief, показывает состояние (роль локального маршрутизатора) как P2P, что является сокращением от точка-точка, со счетчиком 1 для числа полностью соседних соседей и общего количества соседей.
|
Example 21-8 OSPF Network Type Point-to-Point on an Ethernet WAN Interface on R1 Example end.|Пример 21-8 OSPF Тип сети "точка-точка" на интерфейсе Ethernet WAN на конце R1 Пример.
|
When using Ethernet WAN links that behave as a point-to-point link, consider using OSPF network type point-to-point rather than using the default broadcast type.|При использовании каналов Ethernet WAN, которые работают как канал «точка-точка», рассмотрите возможность использования типа сети OSPF «точка-точка» вместо использования типа широковещательной передачи по умолчанию.
### OSPF Neighbor Relationships
OSPF Neighbor Relationship   
__|__
--|--
|
A router’s OSPF configuration enables OSPF on a set of interfaces.|Конфигурация OSPF маршрутизатора включает OSPF на наборе интерфейсов.
IOS then attempts to discover other neighbors on those interfaces by sending and listening for OSPF Hello messages.|Затем IOS пытается обнаружить других соседей на этих интерфейсах, отправляя и прослушивая сообщения приветствия OSPF.
|
However, once discovered, two routers may not become neighbors.|Однако после обнаружения два маршрутизатора могут не стать соседями.
They must have compatible values for several settings as listed in the Hellos exchanged between the two routers.|Они должны иметь совместимые значения для нескольких настроек, перечисленных в сообщениях Hellos, которыми обмениваются два маршрутизатора.
|
This second major section of the chapter examines those reasons.|Во втором основном разделе главы исследуются эти причины.
#### OSPF Neighbor Requirements
Требования к соседнему узлу OSPF   
__|__
--|--
|
After an OSPF router hears a Hello from a new neighbor, the routing protocol examines the information in the Hello and compares that information with the local router’s own settings.|После того, как маршрутизатор OSPF слышит Hello от нового соседа, протокол маршрутизации проверяет информацию в Hello и сравнивает эту информацию с собственными настройками локального маршрутизатора.
|
If the settings match, great.|Если настройки совпадают - отлично.
If not, the routers do not become neighbors.|В противном случае маршрутизаторы не становятся соседями.
Because there is no formal term for all these items that a routing protocol considers, this book just calls them neighbor requirements.|Поскольку не существует формального термина для всех этих элементов, которые учитываются протоколом маршрутизации, в этой книге они просто называются требованиями соседей.
Table 21-3 lists the neighbor requirements for OSPF, with some comments about the various issues following the table.|В Таблице 21-3 перечислены требования к соседям для OSPF с некоторыми комментариями по различным вопросам после таблицы.
|
Table 21-3 Neighbor Requirements for OSPF Table end.|Таблица 21-3 Требования к соседнему узлу для конца таблицы OSPF.
|
First, consider the meaning of the two rightmost columns.|Во-первых, рассмотрим значение двух крайних правых столбцов.
The column labeled “Required for OSPF” means that the item must be working correctly for the neighbor relationship to work correctly.|Столбец с пометкой «Требуется для OSPF» означает, что элемент должен работать правильно, чтобы отношения соседства работали правильно.
Note that all the items in this column list a “yes,” meaning that all must be correct for the neighbor relationship to work correctly.|Обратите внимание, что для всех элементов в этом столбце указано «да», что означает, что все должны быть правильными для правильной работы соседних отношений.
The last column heading states “Neighbor Missing if Incorrect.” For items listing a “yes” in this column, if that item is configured incorrectly, the neighbor will not appear in lists of OSPF neighbors—for instance, with the show ip ospf neighbor command.|В заголовке последнего столбца указано «Сосед отсутствует, если неверно». Для элементов, для которых в этом столбце указано «да», если этот элемент настроен неправильно, сосед не будет отображаться в списках соседей OSPF - например, с помощью команды show ip ospf neighbour.
|
Next, focus on the shaded items at the top of the table.|Затем сосредоточьтесь на затененных предметах в верхней части таблицы.
The symptom that occurs if either of these is a problem is that the show ip ospf neighbor command would not list the other router.|Признак, который возникает, если какая-либо из этих проблем заключается в том, что команда show ip ospf neighbour не выводит список другого маршрутизатора.
For instance, the first item states that the router interfaces must be up and working.|Например, в первом пункте указано, что интерфейсы маршрутизатора должны быть включены и работают.
If the router interface is not working, the router cannot send any OSPF messages and discover any OSPF neighbors on that interface.|Если интерфейс маршрутизатора не работает, маршрутизатор не может отправлять какие-либо сообщения OSPF и обнаруживать соседей OSPF на этом интерфейсе.
|
The middle section of the table (the unshaded rows) focuses on some OSPF settings.|Средняя часть таблицы (незатененные строки) посвящена некоторым настройкам OSPF.
These items must be correct, but if not, they also result in the neighbor not being listed in the output of the show ip ospf neighbor command.|Эти элементы должны быть правильными, но в противном случае они также приведут к тому, что сосед не будет указан в выходных данных команды show ip ospf neighbour.
|
As you can see, using the show ip ospf neighbor command can give you a good starting point to troubleshoot OSPF on the exam and in real life.|Как видите, использование команды show ip ospf neighbour может стать хорошей отправной точкой для устранения неполадок OSPF на экзамене и в реальной жизни.
If you see the neighbor you expect to see, great!|Если вы видите соседа, которого ожидаете увидеть - отлично!
If not, the table gives you a good list to use for items to investigate.|Если нет, то таблица дает вам хороший список предметов для исследования.
|
Finally, the last section (shaded) lists a couple of OSPF settings that give a different symptom when incorrect.|Наконец, в последнем разделе (заштрихованный) перечислены несколько параметров OSPF, которые при неправильном использовании дают другой симптом.
Again, those two items must be correct for OSPF neighbors to work.|Опять же, эти два элемента должны быть правильными для работы соседей OSPF.
|
However, for these two items, when incorrect, a router can list the other router as a neighbor, but the neighbor relationship does not work properly in that the routers do not exchange LSAs as they should.|Однако для этих двух элементов, если они неверны, маршрутизатор может указать другой маршрутизатор как соседний, но взаимосвязь соседства не работает должным образом, поскольку маршрутизаторы не обмениваются LSA должным образом.
|
For reference, Table 21-4 relists some of the requirements from Table 21-3, along with the most useful commands with which to find the answers.|Для справки в Таблице 21-4 перечислены некоторые требования из Таблицы 21-3 вместе с наиболее полезными командами, с помощью которых можно найти ответы.
|
Table 21-4 OSPF Neighbor Requirements and the Best show/debug Commands Table end.|Таблица 21-4 Требования к соседнему узлу OSPF и таблица лучших команд отображения / отладки конец.
|
The rest of this section looks at some of the items from Table 21-3 in a little more detail.|В оставшейся части этого раздела некоторые элементы из Таблицы 21-3 рассматриваются более подробно.
|
NOTE One configuration choice that people sometimes think is an issue, but is not, is the process ID as defined by the router ospf process-id command.|ПРИМЕЧАНИЕ. Один из вариантов конфигурации, который иногда кажется проблемой, но это не так, - это идентификатор процесса, определенный с помощью команды router ospf process-id.
Neighboring routers can use the same process ID values, or different process ID values, with no impact on whether two routers become OSPF neighbors.|Соседние маршрутизаторы могут использовать одни и те же значения идентификатора процесса или разные значения идентификатора процесса, не влияя на то, станут ли два маршрутизатора соседями OSPF.
#### Issues That Prevent Neighbor Adjacencies
Проблемы, предотвращающие соседство   
__|__
--|--
|
The next few pages look at three of the topics from Table 21-3 for which, if a problem exists, the router does not become a neighbor (that is, the unshaded parts of the table.).|На следующих нескольких страницах рассматриваются три темы из Таблицы 21-3, для которых, если проблема существует, маршрутизатор не становится соседом (то есть незатененные части таблицы).
To show the issues, this section uses the same topology shown earlier in Figure 21-1 but now with some incorrect configuration introduced.|Чтобы показать проблемы, в этом разделе используется та же топология, которая показана ранее на рис. 21-1, но теперь с некоторой неверной конфигурацией.
In other words, the configuration matches Example 21-1 that began this chapter, but with the following errors introduced:|Другими словами, конфигурация соответствует Примеру 21-1, с которого начинается эта глава, но со следующими ошибками:
###### R2 has been configured with both LAN interfaces in area 1, whereas the other three routers’
R2 был настроен с обоими интерфейсами LAN в области 1, тогда как остальные три маршрутизатора   
__|__
--|--
|
G0/0 interfaces are assigned to area 0.|Интерфейсы G0 / 0 присвоены области 0.
###### R3 is using the same RID (1.1.1.1) as R1.
R3 использует тот же RID (1.1.1.1), что и R1.   
###### R4 has been configured with a Hello/dead timer of 5/20 on its G0/0 interface, instead of
R4 был настроен с таймером Hello / Dead на 5/20 на интерфейсе G0 / 0 вместо   
__|__
--|--
|
the 10/40 used (by default) on R1, R2, and R3.|10/40 используется (по умолчанию) на R1, R2 и R3.
|
Figure 21-4 shows these same problems for reference.|На рис. 21-4 для справки показаны те же проблемы.
|
Figure 21-4 Summary of Problems That Prevent OSPF Neighbors on the Central LAN|Рисунок 21-4 Сводка проблем, которые предотвращают соседи OSPF в центральной LAN
##### Finding Area Mismatches
Поиск несовпадений областей   
__|__
--|--
|
To create an area mismatch, the configuration on some router must place the interface into the wrong area per the design.|Чтобы создать несоответствие областей, конфигурация на некоторых маршрутизаторах должна размещать интерфейс в неправильной области в соответствии с дизайном.
As shown in Figure 21-4, router R2 was configured incorrectly, placing both its interfaces into area 1 instead of area 0.|Как показано на рисунке 21-4, маршрутизатор R2 был настроен неправильно, оба его интерфейса были помещены в область 1 вместо области 0.
Example 21-9 shows the configuration, which uses the correct syntax (and is therefore accepted by the router) but sets the wrong area number.|В примере 21-9 показана конфигурация, в которой используется правильный синтаксис (и, следовательно, принимается маршрутизатором), но задан неправильный номер области.
|
Example 21-9 Setting Area 1 on R2’s Interfaces, When They Should Be in Area 0 Example end.|Пример 21-9 Установка области 1 на интерфейсах R2, когда они должны находиться в области 0 Пример конец.
|
With an area mismatch error, the show ip ospf neighbor command will not list the neighbor.|При ошибке несоответствия области команда show ip ospf neighbour не выводит список соседей.
|
Because you see nothing in the OSPF neighbor table, to troubleshoot this problem, you need to find the area configuration on each interface on potentially neighboring routers.|Поскольку вы ничего не видите в таблице соседей OSPF, для устранения этой проблемы вам необходимо найти конфигурацию области на каждом интерфейсе на потенциально соседних маршрутизаторах.
To do so:|Для этого:
###### Check the output of show running-config to look for
Проверьте вывод show running-config, чтобы найти   
###### ip ospf process-id area area-number interface subcommands
ip ospf идентификатор процесса область номер области подкоманды интерфейса   
###### network commands in OSPF configuration mode
сетевые команды в режиме конфигурации OSPF   
###### Use the show ip ospf interface [brief] command to list the area number
Используйте команду show ip ospf interface [краткое], чтобы указать номер области.   
##### Finding Duplicate OSPF Router IDs
Поиск повторяющихся идентификаторов маршрутизаторов OSPF   
__|__
--|--
|
Next, Example 21-10 shows R1 and R3 both trying to use RID 1.1.1.1.|Затем в примере 21-10 показаны R1 и R3, которые пытаются использовать RID 1.1.1.1.
Interestingly, both routers automatically generate a log message for the duplicate OSPF RID problem between R1 and R3; the end of Example 21-10 shows one such message.|Интересно, что оба маршрутизатора автоматически создают сообщение журнала для дублирования проблемы RID OSPF между R1 и R3; в конце примера 21-10 показано одно такое сообщение.
For the exams, just use the show ip ospf commands on both R3 and R1 to easily list the RID on each router, noting that they both use the same value.|Для экзаменов просто используйте команды show ip ospf на R3 и R1, чтобы легко перечислить RID на каждом маршрутизаторе, отметив, что они оба используют одно и то же значение.
|
Example 21-10 Comparing OSPF Router IDs on R1 and R3 Example end.|Пример 21-10. Сравнение идентификаторов маршрутизаторов OSPF на R1 и R3. Пример.
|
First, focus on the problem: the duplicate RIDs. The first line of the show ip ospf command on the two routers quickly shows the duplicate use of 1.1.1.1.|Во-первых, сосредоточьтесь на проблеме: повторяющиеся RID. Первая строка команды show ip ospf на двух маршрутизаторах быстро показывает дублированное использование 1.1.1.1.
To solve the problem, assuming R1 should use 1.1.1.1 and R3 should use another RID (maybe 3.3.3.3), change the RID on R3 and restart the OSPF process.|Чтобы решить проблему, если R1 должен использовать 1.1.1.1, а R3 должен использовать другой RID (возможно, 3.3.3.3), измените RID на R3 и перезапустите процесс OSPF.
To do so, use the router-id 3.3.3.3 OSPF subcommand and use the EXEC mode command clear ip ospf process. (OSPF will not begin using a new RID value until the process restarts, either via command or reload.)|Для этого используйте подкоманду router-id 3.3.3.3 OSPF и команду режима EXEC clear ip ospf process. (OSPF не начнет использовать новое значение RID до тех пор, пока процесс не перезапустится с помощью команды или перезагрузки.)
##### Finding OSPF Hello and Dead Timer Mismatches
Поиск несоответствий OSPF Hello и Dead Timer   
__|__
--|--
|
First, as a reminder from chapters past:|Во-первых, как напоминание из прошлых глав:
###### Hello interval/timer: The per-interface timer that tells a router how often to send OSPF
Интервал / таймер приветствия: таймер для каждого интерфейса, который сообщает маршрутизатору, как часто отправлять OSPF   
__|__
--|--
|
Hello messages on an interface.|Приветственные сообщения в интерфейсе.
###### Dead interval/timer: The per-interface timer that tells the router how long to wait without
Интервал бездействия / таймер: таймер для каждого интерфейса, который сообщает маршрутизатору, как долго ждать без   
__|__
--|--
|
having received a Hello from a neighbor before believing that neighbor has failed.|получив сообщение Hello от соседа, прежде чем считать, что сосед потерпел неудачу.
|
(Defaults to four times the Hello timer.)|(По умолчанию в четыре раза больше таймера Hello.)
|
Next, consider the problem created on R4, with the configuration of a different Hello timer and dead timer (5 and 20, respectively) as compared with the default settings on R1, R2, and R3 (10 and 40, respectively).|Затем рассмотрим проблему, созданную на R4, с конфигурацией другого таймера Hello и таймера отключения (5 и 20 соответственно) по сравнению с настройками по умолчанию на R1, R2 и R3 (10 и 40 соответственно).
A Hello or Dead interval mismatch prevents R4 from becoming neighbors with any of the other three OSPF routers.|Несоответствие интервалов Hello или Dead не позволяет R4 стать соседом с любым из трех других маршрутизаторов OSPF.
Routers list their Hello and Dead interval settings in their Hello messages and choose to not become neighbors if the values do not match.|Маршрутизаторы перечисляют свои настройки интервалов Hello и Dead в своих сообщениях Hello и предпочитают не становиться соседями, если значения не совпадают.
As a result, none of the routers become neighbors with router R4 in this case.|В результате ни один из маршрутизаторов в этом случае не станет соседом с маршрутизатором R4.
|
Example 21-11 shows the easiest way to find the mismatch using the show ip ospf interface command on both R1 and R4. This command lists the Hello and dead timers for each interface, as highlighted in the example.|В примере 21.11 показан самый простой способ найти несоответствие с помощью команды show ip ospf interface на обоих R1 и R4. Эта команда перечисляет таймеры Hello и dead для каждого интерфейса, как показано в примере.
Note that R1 uses 10 and 40 (Hello and dead), whereas R4 uses 5 and 20.|Обратите внимание, что R1 использует 10 и 40 (Hello и dead), тогда как R4 использует 5 и 20.
|
Example 21-11 Finding Mismatched Hello/Dead Timers Example end.|Пример 21-11. Поиск несовпадающих таймеров Hello / Dead Пример конец.
##### Shutting Down the OSPF Process
Завершение процесса OSPF   
__|__
--|--
|
Similar to administratively disabling and enabling an interface, IOS also allows the OSPFv2 routing protocol process to be disabled and enabled with the shutdown and no shutdown router mode subcommands, respectively.|Подобно административному отключению и включению интерфейса, IOS также позволяет отключать и включать процесс протокола маршрутизации OSPFv2 с помощью подкоманд режима маршрутизатора shutdown и no shutdown соответственно.
When a routing protocol process is shut down, IOS does the following:|Когда процесс протокола маршрутизации завершается, IOS выполняет следующие действия:
###### Brings down all neighbor relationships and clears the OSPF neighbor table
Сбрасывает все отношения соседей и очищает таблицу соседей OSPF   
###### Clears the LSDB
Очищает LSDB   
###### Clears the IP routing table of any OSPF-learned routes
Очищает таблицу IP-маршрутизации от всех маршрутов, изученных OSPF.   
__|__
--|--
|
At the same time, shutting down OSPF does retain some important details about OSPF, in particular:|В то же время при завершении работы OSPF сохраняются некоторые важные детали OSPF, в частности:
###### IOS retains all OSPF configuration.
IOS сохраняет всю конфигурацию OSPF.   
###### IOS still lists all OSPF-enabled interfaces in the OSPF interface list (show ip ospf
IOS по-прежнему перечисляет все интерфейсы с поддержкой OSPF в списке интерфейсов OSPF (показать ip ospf   
__|__
--|--
|
interface) but in a DOWN state.|интерфейс), но в состоянии DOWN.
|
Basically, shutting down the OSPF routing protocol process gives the network engineer a way to stop using the routing protocol on that router without having to remove all the configuration.|По сути, завершение процесса протокола маршрутизации OSPF дает сетевому инженеру способ прекратить использование протокола маршрутизации на этом маршрутизаторе без необходимости удаления всей конфигурации.
Once shut down, the show ip ospf interface [brief] command should still list some output, as will the show ip ospf command, but the rest of the commands will list nothing.|После завершения работы команда show ip ospf interface [short] по-прежнему должна выводить некоторые выходные данные, как и команда show ip ospf, но остальные команды ничего не выводят.
|
Example 21-12 shows an example on Router R5, as shown in Figure 21-5.|В примере 21-12 показан пример на маршрутизаторе R5, как показано на рисунке 21-5.
R5 is a different router than the one used in earlier examples, but it begins the example with two OSPF neighbors, R2 and R3, with router IDs 2.2.2.2 and 3.3.3.3.|R5 - это другой маршрутизатор, чем тот, который использовался в предыдущих примерах, но он начинает пример с двух соседей OSPF, R2 и R3, с идентификаторами маршрутизатора 2.2.2.2 и 3.3.3.3.
The example shows the OSPF process being shut down, the neighbors failing, and those two key OSPF show commands:|В примере показано завершение процесса OSPF, отказ соседних узлов и эти две ключевые команды отображения OSPF:
|
show ip ospf neighbor and show ip ospf interface brief.|показать ip ospf neighbour и показать краткое описание интерфейса ip ospf.
|
Figure 21-5 Example Network to Demonstrate OSPF Process Shutdown Example 21-12 Shutting Down an OSPF Process, and the Resulting Neighbor States Example end.|Рис. 21-5. Пример сети для демонстрации завершения процесса OSPF. Пример 21-12. Завершение работы процесса OSPF и окончание примера результирующих состояний соседей.
|
First, before the shutdown, the show ip ospf neighbor command lists two neighbors.|Сначала перед завершением работы команда show ip ospf neighbour выводит список двух соседей.
|
After the shutdown, the same command lists no neighbors at all.|После выключения та же команда не выводит никаких соседей.
Second, the show ip ospf interface brief command does list the interfaces on which OSPF is enabled, on the local router’s own IP addresses.|Во-вторых, команда show ip ospf interfacerief действительно перечисляет интерфейсы, на которых включен OSPF, на собственных IP-адресах локального маршрутизатора.
However, it lists a state of DOWN, which is a reference to the local router’s state.|Однако в нем указано состояние DOWN, которое является ссылкой на состояние локального маршрутизатора.
Also, note that the show ip ospf command positively states that the OSPF process is in a shutdown state, while the show ip ospf database command output lists only a heading line, with no LSAs.|Также обратите внимание, что команда show ip ospf положительно указывает, что процесс OSPF находится в состоянии завершения, в то время как выходные данные команды show ip ospf database перечисляют только строку заголовка без LSA.
#### Issues That Allow Adjacencies but Prevent IP Routes
Проблемы, допускающие смежность, но предотвращающие IP-маршруты   
__|__
--|--
|
The last two issues to discuss in this section have a symptom in which the show ip ospf neighbor command does list a neighbor, but some other problem exists that prevents the eventual addition of OSPF routes to the routing table.|У последних двух проблем, обсуждаемых в этом разделе, есть симптом, при котором команда show ip ospf neighbour действительно перечисляет соседа, но существует другая проблема, которая предотвращает возможное добавление маршрутов OSPF в таблицу маршрутизации.
The two issues: a mismatched MTU setting and a mismatched OSPF network type.|Две проблемы: несоответствие настройки MTU и несоответствие типа сети OSPF.
##### Mismatched MTU Settings
Несоответствующие настройки MTU   
__|__
--|--
|
The MTU size defines a per-interface setting used by the router for its Layer 3 forwarding logic, defining the largest network layer packet that the router will forward out each interface.|Размер MTU определяет настройку каждого интерфейса, используемую маршрутизатором для логики пересылки уровня 3, определяя самый большой пакет сетевого уровня, который маршрутизатор будет пересылать на каждый интерфейс.
|
For instance, the IPv4 MTU size of an interface defines the maximum size IPv4 packet that the router can forward out an interface.|Например, размер MTU IPv4 интерфейса определяет максимальный размер пакета IPv4, который маршрутизатор может пересылать через интерфейс.
|
Routers often use a default MTU size of 1500 bytes, with the ability to set the value as well.|Маршрутизаторы часто используют размер MTU по умолчанию, равный 1500 байтам, с возможностью установки этого значения.
|
The ip mtu size interface subcommand defines the IPv4 MTU setting, and the ipv6 mtu size command sets the equivalent for IPv6 packets.|Подкоманда интерфейса ip mtu size определяет настройку IPv4 MTU, а команда ipv6 mtu size устанавливает эквивалент для пакетов IPv6.
|
In an odd twist, two OSPFv2 routers can actually become OSPF neighbors, be listed in the output of the show ip ospf neighbor command, and reach 2-way state, even if they happen to use different IPv4 MTU settings on their interfaces.|Как ни странно, два маршрутизатора OSPFv2 могут фактически стать соседями OSPF, быть перечисленными в выходных данных команды show ip ospf neighbour и достичь двухстороннего состояния, даже если они используют разные настройки MTU IPv4 на своих интерфейсах.
However, they fail to exchange their LSDBs. Eventually, after trying and failing to exchange their LSDBs, the neighbor relationship also fails.|Однако они не могут обменять свои LSDB. В конце концов, после неудачной попытки обмена своими LSDB, отношения между соседями также терпят неудачу.
So also keep a watch for MTU mismatches, although they may be unusual and obscure, by looking at the running-config and by using the show interfaces command (which lists the IP MTU).|Так что также следите за несоответствиями MTU, хотя они могут быть необычными и неясными, просматривая рабочую конфигурацию и используя команду show interfaces (которая отображает IP MTU).
##### Mismatched OSPF Network Types
Несоответствующие типы сетей OSPF   
__|__
--|--
|
Earlier in this chapter you read about the OSPF broadcast network type, which uses a DR/BDR, and the OSPF point-to-point network type, which does not.|Ранее в этой главе вы читали о типе широковещательной сети OSPF, в которой используется DR / BDR, и о типе двухточечной сети OSPF, в котором нет.
Interestingly, if you misconfigure network type settings such that one router uses broadcast, and the other uses point-to-point, the following occurs:|Интересно, что если вы неправильно сконфигурируете настройки типа сети, так что один маршрутизатор использует широковещательную рассылку, а другой - двухточечную, произойдет следующее:
###### The two routers become fully adjacent neighbors (that is, they reach a full state).
Два маршрутизатора становятся полностью смежными соседями (то есть достигают полного состояния).   
###### They exchange their LSDBs.
Они обмениваются своими LSDB.   
###### They do not add IP routes to the IP routing table.
Они не добавляют IP-маршруты в таблицу IP-маршрутизации.   
__|__
--|--
|
The reason for not adding the routes has to do with the details of LSAs and how the use of a DR (or not) changes those LSAs. Basically, the two routers expect different details in the LSAs, and the SPF algorithm notices those differences and cannot trust the LSAs because of those differences.|Причина отказа от добавления маршрутов связана с деталями LSA и тем, как использование DR (или нет) изменяет эти LSA. По сути, два маршрутизатора ожидают разных деталей в LSA, и алгоритм SPF замечает эти различия и не может доверять LSA из-за этих различий.
|
For instance, earlier in Example 21-7, the configuration showed router R1 using network type point-to-point on its G0/0/0 interface, with the expectation that router R2 would also use point-to-point on its matching G0/1/0 interface.|Например, ранее в Примере 21-7 конфигурация показывала, что маршрутизатор R1 использует тип сети «точка-точка» на своем интерфейсе G0 / 0/0, с ожиданием, что маршрутизатор R2 также будет использовать двухточечную связь на соответствующем ему G0. / 1/0 интерфейс.
Example 21-13 shows some of the results if the engineer neglected to configure R2, leaving it with the default setting of broadcast.|В примере 21-13 показаны некоторые результаты, если инженер не сконфигурировал R2, оставив для него настройку широковещательной передачи по умолчанию.
|
Example 21-13 Shutting Down an OSPF Process, and the Resulting Neighbor States Example end.|Пример 21-13. Завершение процесса OSPF и завершение примера результирующих состояний соседей.
|
As you can see, both routers list the other as an OSPF neighbor in the full state.|Как видите, оба маршрутизатора перечисляют друг друга как соседа OSPF в полном состоянии.
However, R1, with network type point-to-point, does not list a DR or BDR role in the output, while R2 does, which is one clue for this type of problem.|Однако R1 с двухточечным типом сети не указывает роль DR или BDR в выходных данных, в то время как R2 делает это, что является одним из ключей к решению этого типа проблемы.
The other comes with noticing that the expected routes are not in the IP routing table.|Другой заключается в том, что ожидаемых маршрутов нет в таблице IP-маршрутизации.
### Chapter Review
Обзор главы   
__|__
--|--
|
One key to doing well on the exams is to perform repetitive spaced review sessions.|Один из ключей к успешной сдаче экзаменов - повторение повторных сессий с интервалом.
Review this chapter’s material using either the tools in the book or interactive tools for the same material found on the book’s companion website.|Просмотрите материал этой главы, используя инструменты из книги или интерактивные инструменты для тех же материалов, которые можно найти на сопутствующем веб-сайте книги.
Refer to the “Your Study Plan” element for more details.|Обратитесь к элементу «Ваш учебный план» для получения более подробной информации.
Table 21-5 outlines the key review elements and where you can find them.|В Таблице 21-5 представлены основные элементы обзора и их местонахождение.
To better track your study progress, record when you completed these activities in the second column.|Чтобы лучше отслеживать свои успехи в учебе, отметьте, когда вы выполнили эти задания, во втором столбце.
|
Table 21-5 Chapter Review Tracking Table end.|Таблица 21-5 Окончание таблицы отслеживания обзора главы.
|
Review All the Key Topics Command References Tables 21-7 and 21-8 list configuration and verification commands used in this chapter.|Просмотрите все ключевые темы Ссылки на команды Таблицы 21-7 и 21-8 содержат список команд конфигурации и проверки, используемых в этой главе.
As an easy review exercise, cover the left column in a table, read the right column, and try to recall the command without looking.|В качестве простого упражнения на повторение закройте левый столбец таблицы, прочтите правый столбец и попытайтесь вспомнить команду, не глядя.
Then repeat the exercise, covering the right column, and try to recall what the command does.|Затем повторите упражнение, охватывая правый столбец, и попытайтесь вспомнить, что делает команда.
|
Table 21-7 Chapter 21 Configuration Command Reference Table end.|Таблица 21-7 Глава 21 Справочник команд конфигурации Конец таблицы.
|
Table 21-8 Chapter 21 show Command Reference Table end.|Таблица 21-8 Глава 21 показывает конец таблицы справочника команд.
|
Keep track of your part review progress with the checklist in Table P6-1.|Следите за ходом проверки детали с помощью контрольного списка в Таблице P6-1.
Details about each task follow the table.|Подробная информация о каждой задаче приведена в таблице.
|
Table P6-1 Part VI Part Review Checklist Activity 1st Date Completed 2nd Date Completed Repeat All DIKTA Questions Answer Part Review Questions Review Key Topics Do Labs Watch Videos Repeat All DIKTA Questions For this task, answer the “Do I Know This Already?” questions again for the chapters in this part of the book using the PTP software.|Таблица P6-1. Контрольный список проверки части VI. Действие 1-я дата завершения 2-я дата завершения Повторить все вопросы DIKTA Ответить на вопросы проверки части Пересмотреть ключевые темы Смотрят ли лаборатории видео Повторить все вопросы DIKTA Для этой задачи ответьте на вопрос «Знаю ли я это уже?» еще раз задайте вопросы к главам этой части книги, используя программное обеспечение PTP.
See the section “How to View Only DIKTA Questions by Chapter or Part” in the Introduction to this book to learn how to make the PTP software show you DIKTA questions for this part only.|См. Раздел «Как просмотреть только вопросы DIKTA по главам или частям» во введении к этой книге, чтобы узнать, как заставить программное обеспечение PTP отображать вам вопросы DIKTA только для этой части.
|
Answer Part Review Questions For this task, answer the Part Review questions for this part of the book using the PTP software.|Ответ на вопросы обзора части Для этой задачи ответьте на вопросы обзора части для этой части книги, используя программное обеспечение PTP.
See the section “How to View Part Review Questions” in the Introduction to this book to learn how to make the PTP software show you Part Review questions for this part only.|См. Раздел «Как просматривать вопросы проверки деталей» во введении к этой книге, чтобы узнать, как заставить программное обеспечение PTP отображать вам вопросы проверки деталей только для этой части.
|
Review Key Topics Review all Key Topics in all chapters in this part, either by browsing the chapters or by using the Key Topics application on the companion website.|Обзор ключевых тем Просмотрите все ключевые темы во всех главах этой части, просматривая главы или используя приложение «Ключевые темы» на сопутствующем веб-сайте.
|
Do Labs Depending on your chosen lab tool, here are some suggestions for what to do in lab:|Выполните лабораторные работы В зависимости от выбранного вами лабораторного инструмента, вот несколько предложений о том, что делать в лаборатории:
|
Pearson Network Simulator: If you use the full Pearson ICND1 or CCNA simulator, focus more on the configuration scenario and troubleshooting scenario labs associated with the topics in this part of the book.|Симулятор сети Pearson: если вы используете полный симулятор Pearson ICND1 или CCNA, уделите больше внимания сценарию конфигурации и лабораторным работам по сценарию устранения неполадок, связанным с темами в этой части книги.
These types of labs include a larger set of topics and work well as Part Review activities. (See the Introduction for some details about how to find which labs are about topics in this part of the book.)|Эти типы лабораторных работ включают более широкий набор тем и хорошо подходят для работы с обзором деталей. (См. Введение, чтобы узнать, как найти лабораторные работы по темам в этой части книги.)
|
Blog: Config Labs: The author’s blog includes a series of configuration-focused labs that you can do on paper, each in 10–15 minutes.|Блог: Config Labs: блог автора включает в себя серию лабораторных работ по настройке, которые вы можете выполнить на бумаге, каждая из которых занимает 10–15 минут.
Review and perform the labs for this part of the book, as found at http://blog.certskills.com.|Просмотрите и выполните лабораторные работы для этой части книги, которые можно найти на http://blog.certskills.com.
Then navigate to the Hands-on Config labs.|Затем перейдите к практическим занятиям по настройке.
## Part VI Review
Часть VI Обзор   
__|__
--|--
|
Other: If using other lab tools, here are a few suggestions: Make sure to experiment heavily with VLAN configuration and VLAN trunking configuration.|Другое: Если вы используете другие лабораторные инструменты, вот несколько предложений: Обязательно поэкспериментируйте с конфигурацией VLAN и конфигурацией транкинга VLAN.
|
Watch Videos Chapter 21 recommends one video from the companion website about troubleshooting OSPF neighbors.|Смотреть видео В главе 21 рекомендуется одно видео с сопутствующего веб-сайта об устранении неполадок соседей OSPF.
Take a few minutes to watch the video if you haven’t done so already.|Потратьте несколько минут на просмотр видео, если вы еще этого не сделали.
|
So far, this book has mostly ignored IP version 6 (IPv6).|До сих пор эта книга в основном игнорировала IP версии 6 (IPv6).
This part reverses the trend, collecting all the specific IPv6 topics into four chapters.|Эта часть меняет тенденцию, собирая все конкретные темы IPv6 в четыре главы.
|
The chapters in Part VII walk you through the same topics discussed throughout this book for IPv4, often using IPv4 as a point of comparison.|В главах части VII вы познакомитесь с теми же темами, которые обсуждались в этой книге для IPv4, часто используя IPv4 в качестве точки сравнения.
Certainly, many details differ when comparing IPv4 and IPv6.|Конечно, многие детали отличаются при сравнении IPv4 и IPv6.
However, many core concepts about IP addressing, subnetting, routing, and routing protocols remain the same.|Однако многие основные концепции IP-адресации, подсетей, маршрутизации и протоколов маршрутизации остаются прежними.
The chapters in this part build on those foundational concepts, adding the specific details about how IPv6 forwards IPv6 packets from one host to another.|Главы этой части основываются на этих основополагающих концепциях, добавляя конкретные детали о том, как IPv6 пересылает пакеты IPv6 от одного хоста к другому.
|